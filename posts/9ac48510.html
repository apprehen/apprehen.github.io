<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><title>React学习 | 月晕</title><meta name="keywords" content="React,前端,前端框架,React学习"><meta name="author" content="月晕"><meta name="copyright" content="月晕"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="React学习"><meta name="application-name" content="React学习"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="React学习"><meta property="og:url" content="https://blog.yueyun.site/posts/9ac48510.html"><meta property="og:site_name" content="月晕"><meta property="og:description" content="React框架学习和使用探索"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://blog-1301952160.cos.ap-shanghai.myqcloud.com/Apprehensive/postCover/1701613946910.png"><meta property="article:author" content="月晕"><meta property="article:tag" content="JS,前端,前端开发,TS,TypeScript,Node,Node.js,Nodejs,Node,后端"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://blog-1301952160.cos.ap-shanghai.myqcloud.com/Apprehensive/postCover/1701613946910.png"><meta name="description" content="React框架学习和使用探索"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="https://blog.yueyun.site/posts/9ac48510"><link rel="preconnect" href="//cdn.cbd.int"><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""><meta name="google-site-verification" content="QmqYgcPLCjEZmEbdJVKduTaxnvd3OFJRyp3BLB2f0VQ"><meta name="baidu-site-verification" content="codeva-XPqAkKFOID"><meta name="msvalidate.01" content="xxx"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.20/dist/fancybox/fancybox.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/swiper/swiper.min.css" media="print" onload='this.media="all"'><script async src="https://www.googletagmanager.com/gtag/js?id=G-W3DLGJMJDY"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-W3DLGJMJDY")</script><script>const GLOBAL_CONFIG = {
  linkPageTop: undefined,
  peoplecanvas: undefined,
  postHeadAiDescription: undefined,
  diytitle: {"enable":true,"leaveTitle":"T^T","backTitle":"Ciallo~"},
  LA51: {"enable":true,"ck":"3GbfdCFGvNdWoQg1","LingQueMonitorID":"3GbfdCFGvNdWoQg1"},
  greetingBox: {"enable":true,"default":"晚上好👋","list":[{"greeting":"晚安😴","startTime":0,"endTime":5},{"greeting":"早上好鸭👋, 祝你一天好心情！","startTime":6,"endTime":9},{"greeting":"上午好👋, 状态很好，鼓励一下～","startTime":10,"endTime":10},{"greeting":"11点多啦, 在坚持一下就吃饭啦～","startTime":11,"endTime":11},{"greeting":"午安👋, 宝贝","startTime":12,"endTime":14},{"greeting":"🌈充实的一天辛苦啦！","startTime":14,"endTime":18},{"greeting":"19点喽, 奖励一顿丰盛的大餐吧🍔。","startTime":19,"endTime":19},{"greeting":"晚上好👋, 在属于自己的时间好好放松😌~","startTime":20,"endTime":24}]},
  twikooEnvId: 'https://chat.yueyun.site',
  commentBarrageConfig:undefined,
  root: '/',
  preloader: {"source":3},
  friends_vue_info: undefined,
  navMusic: true,
  mainTone: undefined,
  authorStatus: {"skills":["🖥️ JavaScript爱好者","🔍 前沿技术追随者","🩵 吃饭睡觉看动漫","🔨 前端后端一把梭","🤓 玉玉郁郁第一名","🧟 间歇性发奋图强","😵 持续性混吃等死","🥰 欢迎找我来聊天"]},
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    simplehomepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"copy":true,"copyrightEbable":false,"limitCount":50,"languages":{"author":"作者: 月晕","link":"链接: ","source":"来源: 月晕","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。","copySuccess":"复制成功，复制和转载请标注本文地址"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#425AEF","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={configTitle:"月晕",title:"React学习",postAI:"",pageFillDescription:"React 脚手架搭建, Create-react-app 基础操作, 划分组件：, 安装 create-react-app, 创建工程化项目, 脚手架的进阶应用, 常见配置修改, 使用 less, 增加 alias @, 修改域名或端口号, 修改浏览器兼容, MVC 模式和 MVVM 模式, JSX 语法, JSX 底层渲染机制, 函数组件的底层渲染机制, 函数组件, 属性 props 的处理, 插槽 slot 处理机制, 静态组件, React 中的事件, React 中的 state, state 的注意, React 中的双向数据绑定, React 中的 portal, React 中的CSS-Module, React.Fragment, React 中的 Context, React 中的 Effect, Effect, React.StrictMode, setState 执行流程, 使用 useEffect, Effect 函数的返回, React 中的 Reducer, React 中的 memo, React 中的 useCallback, React 中的 Hooks, Redux, 状态(State), 容器(Container), 可预测（Predictable）, 使用, 在网页中使用, **RTX(Redux Toolkit)**工具包, RTX 具体使用案例, 拆分 RTX, RTXQ 使用, React 中的 router, 关于 React 中的 hook, React 中自带的钩子函数, useMemo, UseImperativeHandle, UseLayoutEffect, UseDebugValue, UseDeferredValue, UseTransition, UseId脚手架搭建基础操作当下前端开发的主流是组件化和模块化有助于团队协作开发便于组件的复用提高开发效率方便后期维护减少冗余代码划分组件业务组件针对项目需求封装普通业务组件复用性低只是单独拆选出来的一个模块通用业务组件具备复用性功能组件适用于多个项目例如组件库中的组件通用功能组件组件化开发必然会带来工程化即基于等工具实现组件的合并压缩打包等安装我们可以基于自己去搭建一套工程化打包的脚手架但是过程会非常麻烦和繁琐因此可以利用官方提供的脚手架创建项目基于该脚手架创建项目默认就把的打包规则已经处理好了把一些项目需要的基本文件也都创建好了我们可以在其上面做修改全局安装脚手架检查的版本是否安装完成创建工程化项目创建的命令为项目名称项目名称应该仅使用数字小写字母和下划线的组合创建的项目中会默认安装框架的核心视图渲染的核心基于构建页面脚手架为了让项目目录看起来干净一点把打包的规则及相关的插件预处理器等都隐藏到了目录下就是脚手架中自己对打包命令的一种封装基于它打包会调用中的等进行处理初始化项目的性能检测工具打包命令是基于处理的开发环境在本地启动服务器预览打包内容生产环境打包部署打包的内容输出到目录单元测试暴露配置可以修改默认配置对中词法检测的相关配置词法检测词法错误不符合标准规范不符合标准代码本身不报错但不符合的检测规范基于规范设置浏览器的兼容情况会给设置相关的前缀会把编译为使用率超过的浏览器不考虑不考虑欧朋浏览器不兼容低版本和浏览器值得一提的是文件对格式的要求十分严格是不允许注释的上面的注释仅帮助理解在文件中不可使用根目录之下除了子目录还有两个非常重要的子目录分别为所有后续编写的代码几乎都放在该目录下打包的时候一般只对这个目录下的代码进行处理存放页面模版将目录下的大部分文件删除仅留下如果后缀是改为文件其内容改为的严格语法模式它和中的并不相同将目录下的大部分文件删除仅留下项目网站的图标和文件并将的内容改为后期打包时会对这个语法进行编译其表示这个目录脚手架的进阶应用暴露配置前面说到把打包的规则及相关的插件预处理器等都隐藏到了目录下了那么如果我们想要修改的一些默认配置时该怎么办呢这时就需要使用命令了即或者注意一旦暴露配置该操作是永久的就不能还原了这时会发现根目录下会多了和两个文件夹并且中内容会变得非常多把打包需要的所有模块都放在了依赖项中其中下有几个文件值得注意脚手架中默认打包的配置默认的配置打包中用到的路径目录中的是后期执行相关打包命令的入口文件在增加的依赖中有几个模块值得注意它是对语法包的重写目的是让语法包也可以识别的语法实现代码转换脚手架默认配置是使用的预编译语言如果项目中使用的就是则无需处理如果使用的是或则需要自己处理中的也发生了变化为中还增加了配置项对进行额外配置等价于常见配置修改使用前面提到脚手架默认配置是使用的预编译语言如果要使用需要自己进行配置新版本的兼容性不好然后修改暴露出来的中的配置修改前修改后增加中有在暴露配置之后项目中多了文件夹其内部有文件其中导出的代码中有一行为修改前修改后修改域名或端口号默认情况下启动项目使用的是可以在文件中修改可修改端口号可修改或域名如果想基于修改环境变量的方式来改需要先安装如下或修改前修改后修改浏览器兼容如果需要修改浏览器的兼容性则需要修改中项的内容但是修改兼容列表实现浏览器兼容时只能解决两个问题即对生效控制的前缀对生效控制的转换但还存在一个问题就是无法处理内置的兼容为了解决这个问题你可以安装其作用是对常见的内置进行重写然后在入口文件中引入但是在脚手架中通常不需要安装它因为脚手架默认已经安装了它是对的重写仅需要在入口文件中引入对内置的兼容性处理模式和模式主流前端框架主流设计思想不直接操作而是改成数据驱动的思想操作思想操作比较消耗性能不熟悉可能会导致重排重绘等操作起来也相对麻烦一些数据驱动思想操作数据框架会按照相关的数据让页面重新渲染框架底层构建从虚拟到真实的渲染体系有效避免的重排和重绘相比真实虚拟更为轻量级效率更高开发效率高性能高框架采用的是体系采用的是体系控制层单向驱动视图数据需要开发者自行写代码实现需要按照专业的语法去构建视图页面中是基于语法来构建视图的构建数据层但凡在视图中需要动态处理的需要变化的不论是样式还是内容都要有对应的数据模型控制层当在视图中或者根据业务需求进行某些操作时都是去修改相关的数据然后框架会按照最新的数据重新渲染视图以此让用户看到最新的效果数据层视图层数据视图监听层双向驱动数据驱动视图的渲染监听数据的更新让视图重新渲染视图驱动数据的更改监听页面中表单元素的内容改变自动去修改相关的数据自己实现了语法把和标签混合在一起实际上就是一种的增强性语法中将最后编译成为也就是将中一些功能转化成中可以实现的部分比如渲染的就会转换成对象去表示当前元素的信息类似于中的节点语法核心构建的核心获取页面中的容器作为根容器不能将元素作为根容器基于方法渲染编写的视图把渲染后的内容全部插入到元素中每一个构建的视图是能有一个根节点空文档标记标签不会增加层结构既保证了只有一个根节点又不增加一个层级结构可以通过嵌入表达式来渲染常见的表达式有变量值数学运算三目表达式借助于数组迭代方法的循环等有返回值的函数调用语法中嵌入不同的值所呈现出来的特点如下值是什么就渲染出来什么渲染内容是空普通对象不支持渲染数组对象把每一项拿出来分别渲染并不是变为字符串渲染中间没有逗号如果数组中有不支持渲染的元素如普通对象也会报错正则对象时间对象包装类对象不支持渲染函数对象不支持在中渲染但是可以作为函数组件作为组件渲染除数组对象之外其余对象一般都不支持在中渲染但也有特殊情况虚拟对象给元素设置样式要求写成一个对象格式元素设置行内样式行内样式需要基于对象的格式处理直接写成字符串会报错样式属性要基于小驼峰命名法设置样式类名要把替换为需求一基于数据的值来判断元素的显示隐藏控制元素是否显示不论显示还是隐藏元素本身已经渲染出来了显示控制元素是否渲染渲染不渲染需求二从服务器获取了一组列表数据循环动态绑定相关的内容新闻一新闻二新闻三今日新闻扩展需求没有数组就是想单独循环按钮对于函数如果参数仅传入一个数值则该参数表示长度即返回数组长度为的稀疏数组其每一项都是使用数组的迭代方法或它们不会去迭代稀疏数组例如不打印任何输出可以基于数组的方法将稀疏数组进行填充变为密集数组就可以使用数组的迭代方法了输出次底层渲染机制编写的语法编译成虚拟对象对象是一个普通的对象用来描述真实对象的虚拟对象框架内部自构建的一套对象体系对象的相关成员都是内部规定的基于属性构建视图相关特征基于插件把语法编译成语法元素类型字符串或者函数函数就是组件当前元素的属性对象没有就是当前元素的子元素没有就是执行返回一个对象对象中包含了当前元素的描述信息虚拟对象标签名组件把构建的对象渲染成真实的元素第一次渲染是把所有的内容都渲染到页面中第二次及以后的渲染都是把最新的数据和上一次的虚拟进行比对把不同的地方重新渲染这样可以提升渲染的性能基于中的方法之所以有区别是因为在中默认的中引入的是是客户端浏览器使用的包而在中使用的是其根对象中包括了方法封装一个对象的迭代方法基于传统的循环会存在一些弊端性能差公有私有都会迭代只能迭代可枚举非类型的属性解决办法获取对象的所有私有属性获取对象的私有属性不包含类型的属性获取对象的私有类型的属性名获取所有私有属性可以基于中的代替上述操作不能兼容函数组件的底层渲染机制函数组件使用函数去返回试图的组件的写法就是函数组件调用基于规范导入创建的组件可以不用写标签调用组件即可单闭合双闭合调用组件的时候可以给调用的组件设置传递各种各样的属性我是标题如果设置的属性不是字符串格式需要基于进行嵌套调用组件的时候可以把一些数据信息基于属性的方式传递给组件命名组件的名字采用大驼峰命名渲染机制基于把调用的组件转换为格式插件把方法执行创建出一个对象我是标题数组子节点双闭合调用则也包含储存子节点基于把变成真是的值不再是一个字符串而是变成一个函数此时把函数执行把中的作为实参传递给函数接收函数执行的返回结果当前组件的对像最后基于把组件返回的虚拟变成真实的插入到容器中属性的处理调用组件传递进去的属性是只读的原理对象被冻结了获取修改报错关于对象的规则设置冻结冻结对象检测是否被冻结被冻结的对象不能修改成员值不能新增成员不能删除现有成员不能给成员做劫持密封密封对象检测是否被密封被密封的对象可以修改成员的值但也不能删不能新增不能劫持扩展把对象设置成不可扩展检测是否可扩展被设置不可扩展的对象除了不能新增成员其余都可操作作用父组件调用子组件的时候可以基于属性把不同的信息传递给子组件子组件接受相应的属性值呈现出不同的效果让组件的复用性更强虽然对于传递进来的属性我们不能直接修改但是可以做一些规则校验设置默认值函数组件设置其他规则例如数据值格式是否必传依赖官方的插件函数组件传递进来的属性首先会经历规则的校验不管校验成功还是失败最后都会把属性给只不过如果不符合设定的规则控制台会抛出警告错误不影响属性值的获取如果想把传递的属性值进行修改我们可以赋值给其他内容或者修改变量状态值插槽处理机制封装组件具有更强的复用性传递结构确定取消封装组件的时候预留插槽位置内容不用写调用组件的时候基于双闭合调用的方式把插槽信息子节点信息传递给组件组件内部进行渲染即可获取子节点信息传递数据用属性传递结构用插槽在组件中对进行处理对的类型做处理可以基于对象中提供的方法对做处理对做了较好的处理比如下面的一个简单的例子哈哈取字段名进行判断筛选处理我是页脚哈哈我是页眉传递进来的插槽信息都是编译的不是标签静态组件函数组件是静态组件第一次渲染组件把函数执行产生一个私有的上下文把解析出来的包含传递进来被冻结对函数返回的元素进行渲染当我们点击按钮的时候会把函数绑定并且执行修改上级上下文中变量私有变量值发生了改变视图不会更新类组件写法创建类组件创建一个构造函数类要求必须继承这个类习惯于使用中的创建类必须给类设置方法放在原型上面在中返回需要渲染的视图中的事件取消默认行为取消事件的冒泡我是中的在中无法通过取消默认行为事件对象事件中同样会传递事件对象可以在响应函数中定义参数来接收事件对象中的事件对象同样不是原生的事件对象是经过包装后的事件对象由于对象进行过包装所以使用过程中我们无需再去考虑兼容性问题在中事件需要通过元素的属性来设置和原生不同在中事件的属性需要使用驼峰命名法属性值不能直接执行代码而是需要一个回调函数点我一下哈哈超链接点我一下点我一下导出中的函数执行了组件创建完毕在中当组件渲染完毕后再修改组件中的变量不会使组件重新渲染要使得组件可以收到变量的影响必须在变量修改后对组件进行重新渲染这里我们就需要一个特殊变量当这个变量被修改使组件会自动重新渲染相当于一个变量只是这个变量在中进行了注册会监控这个变量的变化当发生变化时会自动触发组件的重新渲染使得我们的修改可以在页面中呈现出来在函数组件中我们需要通过钩子函数获取使用钩子来创建它需要一个值作为参数这个值就是的初始值该函数会返回一个数组数组中第一个元素是初始值初始值只用来显示数据直接修改不会触发组件的重新渲染数组中的第二个元素是一个函数通常会命名为这个函数用来修改调用其修改后会触发组件的重新渲染并且使用函数中的值作为新的值当点击时数字增大点击时数字减少创建一个变量存储数字点击后数字将值修改为点击后数字导出的注意实际就是一个被管理的变量当我们通过修改变量的值时会触发组件的自动重新渲染只有值发生变化时组件才会重新渲染当的值是一个对象时修改时是使用新的对象去替换已有对象当通过去修改一个时并不表示修改当前的它修改的是组件下一次渲染时值会触发组件的重新渲染它是异步的所以当调用需要用旧的值时一定要注意有可能出现计算错误的情况为了避免这种情况可以通过为传递回调函数的形式来修改值孙悟空将值修改为中回调函数的返回值将会成为新的值回调函数执行时会将最新的值作为参数传递猪八戒如果直接修改旧的对象由于对象还是那个对象所以不会生效猪八戒猪八戒猪八戒导出中的双向数据绑定使用去控制表单当表单项发生变化时获取用户输入的内容创建三个变量用来存储表单中的数据将表单数据统一到一个中创建一个响应函数监听日期的变化获取到当前触发事件的对象事件对象中保存了当前事件触发时的所有信息执行的是触发事件的对象对象监听内容的变化获取到当前触发事件的对象事件对象中保存了当前事件触发时的所有信息执行的是触发事件的对象对象监听时长的变化获取到当前触发事件的对象事件对象中保存了当前事件触发时的所有信息执行的是触发事件的对象对象当表单提交时汇总表单中的数据在中通常表单不需要自行提交而是要通过提交取消表单的默认行为获取表单项中的数据日期内容时长将数据拼装为一个对象清空表单项提交表单后如何清空表单中的旧数据现在这种表单在我们称为非受控组件我们可以将表单中的数据存储到中然后将设置为表单项值这样当表单项发生变化会随之变化反之发生变化表单项也会跟着改变这种操作我们就称为双向绑定这样一来表单就成为了一个受控组件日期内容时长添加中的组件默认会作为父组件的后代渲染到页面中存在一些问题比如要写对话框和模态框的时候需要渲染到根目录下通过可以将组件渲染到页面中的指定位置使用方法在添加一个新元素修改组件的渲染方式通过作为返回值创建元素参数修改前的代码目标位置元素获取的根元素中的模块类似于中的中的可以避免被全局污染使用步骤创建一个在组件中引入通过来设置类模块可以动态的设置唯一的值是一个专门用来作为父容器的组件它只会将它里边的子元素直接返回不会创建任何多余的元素当我们希望有一个父容器但同时又不希望父容器在网页中产生多余的结构时就可以使用中的相当于一个公共的存储空间我们可以将多个组件中都需要访问的数据统一存储到一个中这样无需通过逐层传递即可使组件访问到这些数据通过创建月晕使用方式使用方式一不推荐引入使用组件来创建元素的标签体需要一个回调函数会将设置为回调函数的参数通过参数能访问到中存储的数据使用方式二导入使用钩子函数获取到需要一个作为参数它会将中数据获取并作为返回值返回表示数据的生产者可以使用它来指定中的数据通过来指定中存储的数据这样一来在该组件的所有的子组件中都可以通过来访问它所指定数据当我们通过访问数据时他会读取离他最近的中的数据如果没有则读取中的默认数据使用钩子函数获取中的组件有部分逻辑都可以直接编写到组件的函数体中像是对数组调用等方法像是判断某个组件是否显示等但是有一部分逻辑如果直接写在函数体中会影响到组件的渲染这部分会产生副作用的代码是一定不能直接写在函数体中编写组件时我们要极力的避免组件中出现那些会产生副作用的代码同时如果你的使用了严格模式也就是在中使用了标签那么会非常智能的去检查你的组件中是否写有副作用的代码当然这个智能是加了引号的我们来看看官网的文档是如何说明的上文的关键字叫做即重复调用这句话是什么意思呢大概意思就是并不能自动替你发现副作用但是它会想办法让它显现出来从而让你发现它那么它是怎么让你发现副作用的呢的严格模式在处于开发模式下会主动的重复调用一些函数以使副作用显现所以在处于开发模式且开启了严格模式时这些函数会被调用两次类组件的的和方法类组件的静态方法函数组件的函数体参数为函数的参数为函数的重复的调用会使副作用更容易凸显出来你可以尝试着在函数组件的函数体中调用一个你会发现它会执行两次执行流程当我们直接在函数中调用时就会触发上述报错的执行流程函数组件会先判断组件当时处于什么阶段如果是渲染阶段不会检查值是否相同如果不是渲染阶段值不同重新渲染值相同不重新渲染使用是一个钩子函数需要一个函数作为参数这个作为参数的函数将会在组件渲染完毕后执行开发中可以将会产生副作用的代码编写到其中默认情况下中的函数会在组件渲染完成后调用并且是每次渲染完成后都会调用在可以传递一个第二参数第二参数是一个数组在数组中可以指定的依赖项指定后只有当依赖项发生变化时才会被触发通常会将中使用的所有的变量都设置成依赖项执行了是由钩子函数生成的不会发现变化可以不用加到里面如果依赖项设置的是空数组则意味只会在组件初始化时触发一次函数的返回在的回调函数中可以指定一个函数作为返回值这个函数可以称为清理函数他会在下次执行前调用可以在此函数中做一些工作来清除上次执行所带来的影响触发了中的在的函数组件中我们可以通过来创建这种创建的方式会给我们返回两个东西和用来读取数据而用来设置修改数据但是这种方式也存在着一些不足因为所有的修改的方式都必须通过来进行如果遇到一些复杂度比较高的时这种方式似乎就变得不是那么的优雅比如现在有很多数据但是只给我们提供了一个方法就会很麻烦为了解决复杂带来的不便为我们提供了一个新的使用的方式个人认为可以翻译为整合器它的作用就是将那些和同一个相关的所有函数都整合到一起方便在组件中进行调用当然工具都有其使用场景也不例外它只适用于那些比较复杂的对于简单的使用只能是徒增烦恼下面用一个简单的演示一下和相同也是一个钩子函数语法如下参数整合函数对于我们当前的所有操作都应该在该函数中定义该函数的返回值会成为的新值在执行时会收到两个参数当前最新的它需要一个对象在对象中会存储所发送的指令的初始值作用和中的值是一样返回值数组第一个参数用来获取的值第二个参数修改的派发器通过派发器可以发送操作的命令具体的修改行为将会由另外一个函数执行为了避免会重复创建通常会定义到组件的外部执行了可以根据中不同来执行不同的操作之前的写法现在的写法增加的值增加的值减少增加中的是一个高阶组件它接收另一个组件作为参数并且会返回一个包装过的新组件包装过的新组件就会具有缓存功能装过后只有组件的发生变化化才会触发组件的重新的渲染否则总是返回缓存中结果中的是一个钩子函数用来创建中的回调函数创建的回调函数不会总在组件重新渲染时重新创建参数回调函数依赖数组当依赖数组中的变量发生变化时回调函数才会重新创建如果不指定依赖数组回调函数每次都会重新创建一定要将回调函数中使用到的所有变量都设置到依赖数组中除了中的中的钩子函数只能在函数组件或自定义钩子中调用我们需要将中钩子函数提取到一个公共区域时就可以使用自定义钩子自定义钩子其实就是一个普通函数只是它的名字需要使用开头比如下面封装了自定义函数添加一个来记录数据是否正在加载表示没有加载数据表示加载创建一个来记录错误信息判断请求是否加载成功数据加载失败设置返回值是官方对于的描述这句话可以这样翻译一个专为应用设计的可预期的状态容器简单来说是一个可预测的状态容器状态直译过来就是状态不过就是一个变量一个用来记录组件状态的变量组件可以根据不同的状态值切换为不同的显示容器容器当然是用来装东西的状态容器即用来存储状态的容器状态多了自然需要一个东西来存储但是容器的功能却不是仅仅能存储状态它实则是一个状态的管理器除了存储状态外它还可以用来对进行查询修改等所有操作可预测可预测指我们在对进行各种操作时其结果是一定的即以相同的顺序对执行相同的操作会得到相同的结果简单来说中对状态所有的操作都封装到了容器内部外部只能通过调用容器提供的方法来操作而不能直接修改这就意味着外部对的操作都被容器所限制对的操作都在容器的掌控之中也就是可预测总的来说是一个稳定安全的状态管理器使用使用之前你需要先明确一点是应用的状态容器它并不是只能在使用而是可以应用到任意的应用中包括前端和服务器中总之凡是中需要管理的状态的都可以胜任在网页中使用我们先来在网页中使用以下在网页中使用就像使用似的直接在网页中引入的库文件即可的如果不使用的时候上述代码中就是一个状态只是这个状态没有专门的管理器它的所有操作都在事件的响应函数中进行处理这种状态就是不可预测的状态因为在任何的函数中都可以对这个状态进行修改没有任何安全限制的真实使用场景依然是大型应用中的复杂是一个状态容器所以使用必须先创建容器对象它的所有操作都是通过容器对象来进行的创建容器的方式有多种我们先说一种好理解的用来创建一个中的容器对象它需要三个参数是一个函数操作的整合函数每次修改都会触发该函数返回值会变成新的是的初始值可以在这里指定也可以在中指定增强函数用来对的功能进行扩展三个参数中只有是必须的来看一个的示例用来整合关于的所有操作容器修改时会自动调用该函数函数调用时会接收到两个参数和表示当前的可以通过该来计算新的这是在指定的默认值如果不指定第一次调用时的值会是也可以将该值指定为的第二个参数是一个普通对象用来存储操作信息将传递进后我们会得到一个对象对象创建后对的所有操作都需要通过它来进行读取修改用来触发的操作可以将其理解为是想发送任务的工具它需要一个对象作为参数这个对象将会成为的第二个参数需要将操作信息设置到对象中传递给中最重要的属性是用来识别对的不同的操作上例中表示增加操作表示减少的操作除了这些方法外还拥有一个方法这个方法用来订阅变化的信息该方法需要一个回调函数作为参数当中存储的发生变化时回调函数会自动调用我们可以在回调函数中定义发生变化时所要触发的操作中发生变化时触发如此一来刚刚的代码被修改成了这个样子修改后的代码相较于第一个版本要复杂一些同时也解决了之前代码中存在的一些问题前一个版本的代码就是一个变量可以任意被修改不可预测容易被修改为错误的值新代码中使用了中的对的所有操作都封装到了函数中可以限制的修改使可预测有效的避免了错误的值前一个版本的代码每次点击按钮修改就要手动的修改的非常麻烦这样一来我们如果再添加新的功能依然不能忘记对其进行修改新代码中的修改是在的回调函数中进行的每次发生变化其值就会随之变化不需要再手动修改换句话说和元素通过绑定到了一起通过上例也不难看出中最最核心的东西就是这个只要拿到了这个对象就相当于拿到了中存储的数据在加上的核心思想中有一条叫做单一数据源也就是所有的都会存储到一课对象树中并且这个对象树会存储到一个中所以到了中组件只需获取到即可获取到中存储的所有下面给出一个具体的代码示例减少增加加网页中使用的步骤引入核心包创建整合函数通过对象创建对中的进行订阅通过派发的操作指令孙悟空表示当前可以根据这个生成新的是一个对象它里边会保存操作的信息表示操作的类型其他需要传递的参数也可以在中设置打印的值工具包在中使用具体使用使用来构建创建的切片它需要一个配置对象作为参数通过对象的不同的属性来指定它的配置用来自动生成中的孙悟空男花果山的初始值指定的各种操作直接在对象中添加方法可以通过不同的方法来指定对的不同操作两个参数这个的是一个代理对象可以直接修改猪八戒切片对象会自动的帮助我们生成中存储的是自动生成创建器函数调用函数后会自动创建对象对象的结构函数名函数的参数哈哈创建用来创建对象需要一个配置对象作为参数具体使用案例中孙悟空男花果山用来加载中的数据通过来获取派发器对象获取的构建器沙和尚修改修改拆分当有不同的多个数据的时候比如存在学生姓名和学校创建学校的花果山一小花果山大街号创建的切片它需要一个配置对象作为参数通过对象的不同的属性来指定它的配置用来自动生成中的孙悟空男花果山的初始值指定的各种操作直接在对象中添加方法可以通过不同的方法来指定对的不同操作两个参数这个的是一个代理对象可以直接修改切片对象会自动的帮助我们生成中存储的是自动生成创建器函数调用函数后会自动创建对象对象的结构函数名函数的参数使用来构建创建用来创建对象需要一个配置对象作为参数用来加载中的数据引入学校的通过来获取派发器对象获取的构建器沙和尚修改修改高老庄中小修改学校名字高老庄府前街号修改学校地址使用创建对象用来创建中的对象的所有功能都需要通过该对象来进行需要一个对象作为参数的标识不能和其他的或重复指定查询的基础信息发送请求使用的工具是请求的构建器通过来设置请求的相关信息用来指定请求子路径用来指定中的各种功能是一个方法需要一个对象作为返回值对象创建后对象中会根据各种方法自动的生成对应的钩子函数通过这些钩子函数可以来向服务器发送请求钩子函数的命名规则中的使用这些工具所编写的项目通常都是单页应用单页应用中整个应用中只含有一个页面会根据不同的状态在应用中显示出不同的组件但是我们之前所编写应用还存在着一个问题整个应用只存在一个页面一个请求地址这就使得用户只能通过一个地址访问应用当我们点击组件中的不同链接时应用的地址是不会发生变化的这又有什么问题呢由于应用只有一个地址所以我们通过该地址访问应用时总会直接跳转到应用的首页如此一来我们便不敢随意的刷新页面因为一旦刷新页面便直接跳转到首页在对页面进行分享时也只能分享网站的首页而不能分享指定的页面怎么办呢难道我们要将一个页面拆分为多个页面吗很明显不能这么做这么做以后应用的跳转便脱离了的控制增加应用的复杂度提高了项目维护的成本为了解决这个问题我们需要引入一个新的工具为我们提供一种被称为客户端路由的东西通过客户端路由可以将地址和组件进行映射当地址发生变化时它会根据设置自动的切换到指定组件并且这种切换完全不依赖于服务器换句话说在用户看来浏览器的地址栏确实发生了变化但是这一变化并不由服务器处理而是通过客户端路由进行切换懒的写了关于中的关于中的钩子函数我们已经非常熟悉了钩子函数的功能非常的强大而它的使用又十分简单关于钩子函数的使用我们只需记住两点钩子只能在组件和自定义钩子中使用钩子不能在嵌套函数或其他语句等中使用中自带的钩子函数和十分相似用来缓存函数对象用来缓存函数的执行结果在组件中会有一些函数具有十分的复杂的逻辑执行速度比较慢闭了避免这些执行速度慢的函数返回执行可以通过来缓存它们的执行结果像是这样复杂逻辑函数依赖项中的函数会在依赖项发生变化时执行注意是执行这点和不同是创建执行后返回执行结果如果依赖项不发生变化则一直会返回上次的结果不会再执行函数这样一来就避免复杂逻辑的重复执行在中可以通过来指定要暴露给外部组件的自定义按钮上例中组件将的作为组件的向外部暴露其他组件在使用时就可以通过属性访问通过可以手动的指定要暴露的对象比如可以修改组件如下孙悟空自定义按钮的第二个参数是一个函数函数的返回值会自动赋值给属性上例中我们将返回值为孙悟空当然返回孙悟空没有什么意义实际开发中我们可以将一些操作方法定义到对象中这样可以有效的减少组件对对象的直接操作自定义按钮点击的方法签名和一样功能也类似不同点在于的执行时机要早于它会在改变后调用在老版本的中它和的区别比较好演示中的运行方式有所变化所以二者区别不好演示使用场景不多实际开发中在中需要修改元素样式且使用会出现闪烁现象时可以使用进行替换用来给自定义钩子设置标签标签会在开发工具中显示用来调试自定义钩子不常用用来设置一个延迟的比如我们创建一个并使用获取延迟值上边的代码中就是一个常规的就是的延迟值设置延迟值后每次调用后都会触发两次组件的重新渲染第一次时的值是修改前的值第二次才是修改后的值换句话延迟值相较于来说总会慢一步更新延迟值可以用在这样一个场景一个需要在多个组件中使用一个组件的渲染比较快而另一个组件的渲染比较慢这样我们可以为该创建一个延迟值渲染快的组件使用正常的优先显示渲染慢的组件使用延迟值慢一步渲染当然必须结合或才能真正的发挥出它的作用当我们在组件中修改时会遇到复杂一些的当修改这些时甚至会阻塞到整个应用的运行为了降低这种的影响为我们提供了通过可以降低的优先级会返回一个数组数组中有两个元素第一个元素是它是一个变量用来记录是否在执行中第二个元素是它是一个函数可以将在其回调函数中调用这样方法会被标记为并不会立即执行而是在其他优先级更高的方法执行完毕才会执行除了外还直接为为我们提供了一个函数在不需要使用时可以直接使用也可以达到相同的效果生成唯一使用于需要唯一的场景但不适用于列表的",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2024-08-12 09:01:41",postMainColor:""}</script><noscript><style type="text/css">#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-W3DLGJMJDY"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-W3DLGJMJDY")</script><meta name="generator" content="Hexo 7.0.0"></head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="/img/yueyun.jpg"><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"><script async src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><a id="site-name" href="/" accesskey="h"><div class="title">月晕</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size:.9em"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size:.9em"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size:.9em"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>留言</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size:.9em"></i><span> 友人帐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size:.9em"></i><span> 留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size:.9em"></i><span> 音乐馆</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size:.9em"></i><span> 相册集</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size:.9em"></i><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/resume/"><i class="anzhiyufont anzhiyu-icon-book faa-tada" style="font-size:.9em"></i><span> 简历</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size:.9em"></i><span> 随便逛逛</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><div class="nav-button" id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" title="搜索🔍" accesskey="s"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span> 搜索</span></a></div><div class="nav-change" id="nav-darkmode"><a class="darkmode_switchbutton" title="显示模式切换" onclick="darkmo" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><input id="center-console" type="checkbox"><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%89%8D%E7%AB%AF/" itemprop="url">前端</a></span><span class="article-meta tags"><a class="article-meta__tags" href="/tags/JavaScript/" tabindex="-1" itemprop="url"> <span><i class="anzhiyufont anzhiyu-icon-hashtag"></i>JavaScript</span></a><a class="article-meta__tags" href="/tags/React/" tabindex="-1" itemprop="url"> <span><i class="anzhiyufont anzhiyu-icon-hashtag"></i>React</span></a><a class="article-meta__tags" href="/tags/%E5%89%8D%E7%AB%AF/" tabindex="-1" itemprop="url"> <span><i class="anzhiyufont anzhiyu-icon-hashtag"></i>前端</span></a><a class="article-meta__tags" href="/tags/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6/" tabindex="-1" itemprop="url"> <span><i class="anzhiyufont anzhiyu-icon-hashtag"></i>前端框架</span></a></span></div></div><h1 class="post-title" itemprop="name headline">React学习</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="post-meta-icon anzhiyufont anzhiyu-icon-calendar-days"></i><span class="post-meta-label">发表于</span><time itemprop="dateCreated datePublished" datetime="2023-12-12T23:51:54.000Z" title="发表于 2023-12-12 23:51:54">2023-12-12</time></span></div><div class="meta-secondline"><span class="post-meta-separator"></span><span class="post-meta-wordcount"><i class="anzhiyufont anzhiyu-icon-file-word post-meta-icon" title="文章字数"></i><span class="post-meta-label" title="文章字数">字数总计:</span><span class="word-count" title="文章字数">16.6k</span><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-clock post-meta-icon" title="阅读时长"></i><span class="post-meta-label" title="阅读时长">阅读时长:</span><span>65分钟</span></span><span class="post-meta-separator"> </span><span class="post-meta-position" title="作者IP属地为杭州"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>杭州</span><span class="post-meta-separator"></span><span class="post-meta-commentcount"><i class="anzhiyufont anzhiyu-icon-comments post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/posts/9ac48510.html#post-comment" tabindex="-1"><span id="twikoo-count"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></a></span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src="https://blog-1301952160.cos.ap-shanghai.myqcloud.com/Apprehensive/postCover/1701613946910.png"></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container" itemscope itemtype="https://blog.yueyun.site/posts/9ac48510.html"><header><a class="post-meta-categories" href="/categories/%E5%89%8D%E7%AB%AF/" itemprop="url">前端</a><a href="/tags/JavaScript/" tabindex="-1" itemprop="url">JavaScript</a><a href="/tags/React/" tabindex="-1" itemprop="url">React</a><a href="/tags/%E5%89%8D%E7%AB%AF/" tabindex="-1" itemprop="url">前端</a><a href="/tags/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6/" tabindex="-1" itemprop="url">前端框架</a><h1 id="CrawlerTitle" itemprop="name headline">React学习</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">月晕</span><time itemprop="dateCreated datePublished" datetime="2023-12-12T23:51:54.000Z" title="undefined 2023-12-12 23:51:54">2023-12-12</time></header><h1 id="React-脚手架搭建"><a href="#React-脚手架搭建" class="headerlink" title="React 脚手架搭建"></a>React 脚手架搭建</h1><h2 id="Create-react-app-基础操作"><a href="#Create-react-app-基础操作" class="headerlink" title="Create-react-app 基础操作"></a>Create-react-app 基础操作</h2><p>当下前端开发的主流是<strong>组件化</strong>和<strong>模块化</strong></p><ul><li>有助于团队协作开发</li><li>便于组件的复用：提高开发效率、方便后期维护、减少冗余代码</li></ul><h3 id="划分组件："><a href="#划分组件：" class="headerlink" title="划分组件："></a>划分组件：</h3><ul><li>业务组件：针对项目需求封装<ul><li>普通业务组件：复用性低，只是单独拆选出来的一个模块</li><li>通用业务组件：具备复用性</li></ul></li><li>功能组件：适用于多个项目「例如：UI 组件库中的组件」<ul><li>通用功能组件</li></ul></li></ul><p>组件化开发必然会带来工程化，即基于 Webpack &#x2F; Vite &#x2F; Rollup &#x2F; Turbopack 等工具实现组件的合并、压缩、打包等。</p><h3 id="安装-create-react-app"><a href="#安装-create-react-app" class="headerlink" title="安装 create-react-app"></a>安装 create-react-app</h3><p>我们可以基于 webpack 自己去搭建一套工程化打包的脚手架，但是过程会非常麻烦和繁琐，因此可以利用官方提供的脚手架<code>create-react-app</code>创建 React 项目，基于该脚手架创建项目，默认就把 Webpack 的打包规则已经处理好了，把一些项目需要的基本文件也都创建好了。我们可以在其上面做修改</p><p>全局安装 create-react-app 脚手架：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i create<span class="literal">-react-app</span> <span class="literal">-g</span></span><br></pre></td></tr></table></figure><p>检查 create-react-app 的版本（是否安装完成·）：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create<span class="literal">-react-app</span> <span class="literal">--version</span></span><br></pre></td></tr></table></figure><h3 id="创建工程化项目"><a href="#创建工程化项目" class="headerlink" title="创建工程化项目"></a>创建工程化项目</h3><p>创建的命令为：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create<span class="literal">-react-app</span> [项目名称]</span><br></pre></td></tr></table></figure><blockquote><p>项目名称应该仅使用数字、小写字母和下划线 <code>_</code> 的组合。</p></blockquote><p>创建的项目中会默认安装：</p><ul><li><strong>react</strong> : React 框架的核心</li><li><strong>react-dom</strong> : React 视图渲染的核心 [基于 React 构建 WebApp（HTML 页面）]</li><li><strong>react-script</strong>: 脚手架为了让项目目录看起来干净一点，把 Webpack 打包的规则及相关的插件、预处理器等都隐藏到了 node_modules 目录下，react-scripts 就是脚手架中自己对打包命令的一种封装，基于它打包，会调用 node_modules 中的 Webpack 等进行处理</li></ul><p>初始化项目的<code>package.json</code></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;demo&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0.1.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;private&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;dependencies&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;@testing-library/jest-dom&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^5.16.5&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;@testing-library/react&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^13.4.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;@testing-library/user-event&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^13.5.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;react&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^18.2.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;react-dom&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^18.2.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;react-scripts&quot;</span><span class="punctuation">:</span> <span class="string">&quot;5.0.1&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;web-vitals&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^2.1.4&quot;</span> <span class="comment">// 性能检测工具</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="comment">// 打包命令是基于 react-scripts 处理的</span></span><br><span class="line">  <span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="string">&quot;react-scripts start&quot;</span><span class="punctuation">,</span> <span class="comment">// 开发环境：在本地启动 Web 服务器，预览打包内容</span></span><br><span class="line">    <span class="attr">&quot;build&quot;</span><span class="punctuation">:</span> <span class="string">&quot;react-scripts build&quot;</span><span class="punctuation">,</span> <span class="comment">// 生产环境：打包部署，打包的内容输出到 dist 目录</span></span><br><span class="line">    <span class="attr">&quot;test&quot;</span><span class="punctuation">:</span> <span class="string">&quot;react-scripts test&quot;</span><span class="punctuation">,</span> <span class="comment">// 单元测试</span></span><br><span class="line">    <span class="attr">&quot;eject&quot;</span><span class="punctuation">:</span> <span class="string">&quot;react-scripts eject&quot;</span> <span class="comment">// 暴露 Webpack 配置，可以修改默认配置</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="comment">// 对 Webpack 中 ESLint 词法检测的相关配置</span></span><br><span class="line">  <span class="comment">// 词法检测</span></span><br><span class="line">  <span class="comment">// - 词法错误（不符合标准规范）</span></span><br><span class="line">  <span class="comment">// - 不符合标准（代码本身不报错，但不符合 ESLint 的检测规范）</span></span><br><span class="line">  <span class="attr">&quot;eslintConfig&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;extends&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;react-app&quot;</span><span class="punctuation">,</span> <span class="string">&quot;react-app/jest&quot;</span><span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="comment">// 基于 browserlist 规范设置浏览器的兼容情况</span></span><br><span class="line">  <span class="comment">// - postcss-loader + autoprefixer 会给 CSS3 设置相关的前缀</span></span><br><span class="line">  <span class="comment">// babel-loader 会把 ES6 编译为 ES5</span></span><br><span class="line">  <span class="attr">&quot;browserslist&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;production&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="string">&quot;&gt;0.2%&quot;</span><span class="punctuation">,</span> <span class="comment">// 使用率超过 0.2% 的浏览器</span></span><br><span class="line">      <span class="string">&quot;not dead&quot;</span><span class="punctuation">,</span> <span class="comment">// 不考虑 IE</span></span><br><span class="line">      <span class="string">&quot;not op_mini all&quot;</span> <span class="comment">// 不考虑欧朋浏览器</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;development&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="comment">// 不兼容低版本和 IE 浏览器</span></span><br><span class="line">      <span class="string">&quot;last 1 chrome version&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;last 1 firefox version&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;last 1 safari version&quot;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><blockquote><p>值得一提的是，JSON 文件对格式的要求十分严格，是不允许注释的，上面的注释仅帮助理解，在文件中不可使用。</p></blockquote><p>根目录之下，除了 node_modules 子目录，还有两个非常重要的子目录分别为：</p><ul><li><strong>src</strong>: 所有后续编写的代码，几乎都放在该目录下「打包的时候，一般只对这个目录下的代码进行处理」</li><li><strong>public</strong>：存放页面模版</li></ul><p>将 src 目录下的大部分文件删除，仅留下 index.jsx（如果后缀是 .js，改为 .jsx）文件，其内容改为：</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line">root.<span class="title function_">render</span>(</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">React.StrictMode</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    &#123;&#x27; &#x27;&#125;</span></span><br><span class="line"><span class="language-xml">    &#123;/* React 的严格语法模式，它和 JS 中的 &quot;use strict&quot; 并不相同 */&#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>Explosion!!<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">React.StrictMode</span>&gt;</span></span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>将 public 目录下的大部分文件删除，仅留下 favicon.ico（项目网站的 logo 图标）和 index.html 文件，并将 index.html 的内容改为：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 后期 Webpack 打包时，会对这个语法进行编译，其表示 public 这个目录 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;icon&quot;</span> <span class="attr">href</span>=<span class="string">&quot;%PUBLIC_URL%/favicon.ico&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>React!!<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;root&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="脚手架的进阶应用"><a href="#脚手架的进阶应用" class="headerlink" title="脚手架的进阶应用"></a>脚手架的进阶应用</h3><p>暴露 webpack 配置</p><p>前面说到，react-scripts 把 Webpack 打包的规则及相关的插件、预处理器等都隐藏到了 node_modules 目录下了。那么，如果我们想要修改 Webpack 的一些默认配置时，该怎么办呢？</p><p>这时就需要使用 <code>eject</code> 命令了，即：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run eject <span class="comment"># 或者 yarn eject</span></span><br></pre></td></tr></table></figure><blockquote><p>注意：一旦暴露 Webpack 配置，该操作是永久的，就不能还原了。</p></blockquote><p>这时，会发现根目录下会多了 config 和 scripts 两个文件夹，并且 package.json 中内容会变得非常多（把 Webpack 打包需要的所有模块都放在了依赖项中）。</p><p>其中，&#x2F;config&#x2F;webpack 下有几个文件值得注意：</p><ul><li>webpack.config.js：脚手架中默认 Webpack 打包的配置</li><li>webpackDevServer.config.js：默认 web pack-dev-server 的配置</li><li>paths.js：打包中用到的路径</li></ul><p>scripts 目录中的 build.js 是后期执行相关打包命令的入口文件。</p><p>在 package.json 增加的依赖中，有几个模块值得注意：</p><ul><li><p>babel-preset-react-app：它是对 <a target="_blank" rel="noopener" href="https://github.com/babel">@babel</a>&#x2F;preset-env 语法包的重写，目的是让语法包也可以识别 React 的 jsx 语法，实现代码转换</p><blockquote><p>create-react- app 脚手架默认配置是使用的 sass 预编译语言，如果项目中使用的就是 sass，则无需处理；如果使用的是 less 或 stylus，则需要自己处理。</p></blockquote></li><li><p>package.json 中的 scripts 也发生了变化，为：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="string">&quot;node scripts/start.js&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;build&quot;</span><span class="punctuation">:</span> <span class="string">&quot;node scripts/build.js&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;test&quot;</span><span class="punctuation">:</span> <span class="string">&quot;node scripts/test.js&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br></pre></td></tr></table></figure></li><li><p>package.json 中还增加了 babel 配置项：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// 对 babel<span class="literal">-loader</span> 进行额外配置，等价于 babel.config.js</span><br><span class="line"><span class="string">&quot;babel&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;presets&quot;</span>: [</span><br><span class="line">        <span class="string">&quot;react-app&quot;</span></span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h3 id="常见配置修改"><a href="#常见配置修改" class="headerlink" title="常见配置修改"></a>常见配置修改</h3><h4 id="使用-less"><a href="#使用-less" class="headerlink" title="使用 less"></a>使用 less</h4><p>前面提到，脚手架默认配置是使用的 sass 预编译语言，如果要使用 less，需要自己进行配置：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install less less<span class="literal">-loader</span>@<span class="number">8</span> <span class="comment"># 新版本的 less-loader 兼容性不好</span></span><br><span class="line">npm uninstall sass<span class="literal">-loader</span></span><br></pre></td></tr></table></figure><p>然后修改暴露出来的 webpack.config.js 中的配置：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line">// 修改前</span><br><span class="line">...</span><br><span class="line">const sassRegex = /\.(scss|sass)<span class="variable">$</span>/;</span><br><span class="line">const sassModuleRegex = /\.module\.(scss|sass)<span class="variable">$</span>/;</span><br><span class="line">...</span><br><span class="line">&#123;</span><br><span class="line">    test: sassRegex,</span><br><span class="line">    exclude: sassModuleRegex,</span><br><span class="line">    use: getStyleLoaders(</span><br><span class="line">        &#123;</span><br><span class="line">            importLoaders: <span class="number">3</span>,</span><br><span class="line">            sourceMap: isEnvProduction</span><br><span class="line">            ? shouldUseSourceMap</span><br><span class="line">            : isEnvDevelopment,</span><br><span class="line">            modules: &#123;</span><br><span class="line">                mode: <span class="string">&#x27;icss&#x27;</span>,</span><br><span class="line">            &#125;,</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">&#x27;sass-loader&#x27;</span></span><br><span class="line">    ),</span><br><span class="line">    sideEffects: true,</span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">    test: sassModuleRegex,</span><br><span class="line">    use: getStyleLoaders(</span><br><span class="line">        &#123;</span><br><span class="line">            importLoaders: <span class="number">3</span>,</span><br><span class="line">            sourceMap: isEnvProduction</span><br><span class="line">            ? shouldUseSourceMap</span><br><span class="line">            : isEnvDevelopment,</span><br><span class="line">            modules: &#123;</span><br><span class="line">                mode: <span class="string">&#x27;local&#x27;</span>,</span><br><span class="line">                getLocalIdent: getCSSModuleLocalIdent,</span><br><span class="line">            &#125;,</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">&#x27;sass-loader&#x27;</span></span><br><span class="line">    ),</span><br><span class="line">&#125;,</span><br><span class="line">...</span><br><span class="line">// 修改后</span><br><span class="line">...</span><br><span class="line">const lessRegex = /\.less<span class="variable">$</span>/;</span><br><span class="line">const lessModuleRegex = /\.module\.less<span class="variable">$</span>/;</span><br><span class="line">...</span><br><span class="line">&#123;</span><br><span class="line">    test: lessRegex,</span><br><span class="line">    exclude: lessModuleRegex,</span><br><span class="line">    use: getStyleLoaders(</span><br><span class="line">        &#123;</span><br><span class="line">            importLoaders: <span class="number">3</span>,</span><br><span class="line">            sourceMap: isEnvProduction</span><br><span class="line">            ? shouldUseSourceMap</span><br><span class="line">            : isEnvDevelopment,</span><br><span class="line">            modules: &#123;</span><br><span class="line">                mode: <span class="string">&#x27;icss&#x27;</span>,</span><br><span class="line">            &#125;,</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">&#x27;less-loader&#x27;</span></span><br><span class="line">    ),</span><br><span class="line">    sideEffects: true,</span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">    test: lessModuleRegex,</span><br><span class="line">    use: getStyleLoaders(</span><br><span class="line">        &#123;</span><br><span class="line">            importLoaders: <span class="number">3</span>,</span><br><span class="line">            sourceMap: isEnvProduction</span><br><span class="line">            ? shouldUseSourceMap</span><br><span class="line">            : isEnvDevelopment,</span><br><span class="line">            modules: &#123;</span><br><span class="line">                mode: <span class="string">&#x27;local&#x27;</span>,</span><br><span class="line">                getLocalIdent: getCSSModuleLocalIdent,</span><br><span class="line">            &#125;,</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">&#x27;less-loader&#x27;</span></span><br><span class="line">    ),</span><br><span class="line">&#125;,</span><br><span class="line">...</span><br></pre></td></tr></table></figure><h4 id="增加-alias"><a href="#增加-alias" class="headerlink" title="增加 alias @"></a>增加 alias @</h4><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">// path.js中有</span><br><span class="line">// 在暴露 Webpack 配置之后，项目中多了 config 文件夹，其内部有paths.js 文件，其中导出的代码中，有一行为：</span><br><span class="line">appSrc: resolveApp(<span class="string">&#x27;src&#x27;</span>),</span><br><span class="line">// 修改前</span><br><span class="line">extensions: paths.moduleFileExtensions</span><br><span class="line">    .map(ext =&gt; `.<span class="variable">$</span>&#123;ext&#125;`)</span><br><span class="line">    .filter(ext =&gt; useTypeScript || !ext.includes(<span class="string">&#x27;ts&#x27;</span>)),</span><br><span class="line">alias: &#123;</span><br><span class="line">    <span class="string">&#x27;react-native&#x27;</span>: <span class="string">&#x27;react-native-web&#x27;</span>,</span><br><span class="line">    ...</span><br><span class="line">// 修改后</span><br><span class="line">extensions: paths.moduleFileExtensions</span><br><span class="line">    .map(ext =&gt; `.<span class="variable">$</span>&#123;ext&#125;`)</span><br><span class="line">    .filter(ext =&gt; useTypeScript || !ext.includes(<span class="string">&#x27;ts&#x27;</span>)),</span><br><span class="line">alias: &#123;</span><br><span class="line">    <span class="string">&#x27;@&#x27;</span>: paths.appSrc,</span><br><span class="line">    <span class="string">&#x27;react-native&#x27;</span>: <span class="string">&#x27;react-native-web&#x27;</span>,</span><br><span class="line">    ...</span><br></pre></td></tr></table></figure><h4 id="修改域名或端口号"><a href="#修改域名或端口号" class="headerlink" title="修改域名或端口号"></a>修改域名或端口号</h4><p>默认情况下，启动项目使用的是 <code>localhost:3000</code>，可以在 scripts&#x2F;start.js 文件中修改：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="variable constant_">DEFAULT_PORT</span> = <span class="built_in">parseInt</span>(process.<span class="property">env</span>.<span class="property">PORT</span>, <span class="number">10</span>) || <span class="number">3000</span> <span class="comment">// 可修改端口号</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">HOST</span> = process.<span class="property">env</span>.<span class="property">HOST</span> || <span class="string">&#x27;0.0.0.0&#x27;</span> <span class="comment">// 可修改 IP（或域名）</span></span><br></pre></td></tr></table></figure><p>如果想基于修改环境变量的方式来改，需要先安装 cross-env，如下:</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// npm i cross-env # 或 yarn add cross-env</span></span><br><span class="line"><span class="comment">// 修改前</span></span><br><span class="line"><span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="string">&quot;node scripts/start.js&quot;</span><span class="punctuation">,</span></span><br><span class="line">    ...</span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="comment">// 修改后</span></span><br><span class="line"><span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="string">&quot;cross-env PORT=8080 node scripts/start.js&quot;</span><span class="punctuation">,</span></span><br><span class="line">    ...</span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br></pre></td></tr></table></figure><h4 id="修改浏览器兼容"><a href="#修改浏览器兼容" class="headerlink" title="修改浏览器兼容"></a>修改浏览器兼容</h4><p>如果需要修改浏览器的兼容性，则需要修改 package.json 中 <code>&quot;browserslist&quot;</code> 项的内容。</p><p>但是，修改兼容列表实现浏览器兼容时，只能解决两个问题，即：</p><ol><li>对 postcss-loader 生效，控制 CSS3 的前缀</li><li>对 babel-loader 生效，控制 ES6 的转换</li></ol><p>但还存在一个问题，就是无法处理 ES6 内置 API 的兼容。</p><p>为了解决这个问题，你可以安装 <a target="_blank" rel="noopener" href="https://github.com/babel">@babel</a>&#x2F;polyfill（其作用是对常见的内置 API 进行重写），然后在入口文件（index.jsx）中引入 <code>import &#39;@babel/polyfill&#39;</code>。</p><p>但是，在脚手架中，通常不需要安装它，因为脚手架默认已经安装了 react-app-polyfill，它是对 <a target="_blank" rel="noopener" href="https://github.com/babel">@babel</a>&#x2F;polyfill 的重写，仅需要在入口文件（index.jsx）中引入：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 对 ES6 内置 API 的兼容性处理</span></span><br><span class="line">import &#x27;react-app-polyfill/ie9&#x27;</span><br><span class="line">import &#x27;react-app-polyfill/ie11&#x27;</span><br><span class="line">import &#x27;react-app-polyfill/stable&#x27;</span><br></pre></td></tr></table></figure><h1 id="MVC-模式和-MVVM-模式"><a href="#MVC-模式和-MVVM-模式" class="headerlink" title="MVC 模式和 MVVM 模式"></a>MVC 模式和 MVVM 模式</h1><p>主流 web 前端框架</p><ul><li>React</li><li>Vue</li><li>Angular</li></ul><p>主流设计思想：不直接操作 DOM，而是改成数据驱动的思想</p><p>操作 DOM 思想：</p><ul><li>操作 DOM 比较消耗性能，不熟悉可能会导致 DOM 重排&#x2F;重绘等</li><li>操作起来也相对麻烦一些</li></ul><p>数据驱动思想：</p><ul><li>操作数据，框架会按照相关的数据，让页面重新渲染</li><li>框架底层构建从虚拟 DOM（Virtual DOM）到真实 DOM 的渲染体系，有效避免 DOM 的重排和重绘</li><li>相比真实 DOM，虚拟 DOM 更为轻量级，效率更高</li><li>开发效率高，性能高</li></ul><p>React 框架采用的是 MVC 体系；Vue 采用的是 MVVM 体系。</p><p>MVC &#x3D; Model + View + Controler 控制层</p><ul><li><strong>单向驱动</strong>（视图 -&gt; 数据需要开发者自行写代码实现）</li><li>需要按照专业的语法去构建视图（页面）：React 中是基于 jsx 语法来构建视图的</li><li>构建数据层：但凡在视图中，需要“动态”处理的（需要变化的，不论是样式还是内容），都要有对应的数据模型</li><li>控制层：当在视图中（或者根据业务需求）进行某些操作时，都是去修改相关的数据，然后 React 框架会按照最新的数据，重新渲染视图，以此让用户看到最新的效果</li></ul><p>MVVM &#x3D; Model 数据层 + View 视图层 + ViewModel 数据视图监听层</p><ul><li><strong>双向驱动</strong></li><li>数据驱动视图的渲染：监听数据的更新，让视图重新渲染</li><li>视图驱动数据的更改：监听页面中表单元素的内容改变，自动去修改相关的数据</li><li>Vue 自己实现了 Template</li></ul><h1 id="JSX-语法"><a href="#JSX-语法" class="headerlink" title="JSX 语法"></a>JSX 语法</h1><p>jsx：JavaScript amd XML (html) 把 JS 和 HTML 标签混合在一起</p><blockquote><p>jsx 实际上就是一种js的增强性语法 babel中将jsx最后编译成为js 也就是将jsx中一些功能转化成js中可以实现的部分 比如渲染的<app></app>就会转换成js对象去表示当前元素的信息 类似于vue中的dom节点</p></blockquote><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span> <span class="comment">// React 语法核心</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span> <span class="comment">// 构建 HTML(WebApp) 的核心</span></span><br><span class="line"><span class="comment">// 获取页面中的 #root 容器，作为根容器，不能将 html、body 元素作为根容器</span></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"><span class="comment">// 基于 render 方法渲染编写的视图，把渲染后的内容，全部插入到 #root 元素中</span></span><br><span class="line"><span class="comment">// 每一个构建的视图是能有一个根节点</span></span><br><span class="line">root.<span class="title function_">render</span>(</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">    &#123;/* 空文档标记标签 React.Fragment，不会增加层结构，既保证了只有一个根节点，又不增加一个 HTML 层级结构 */&#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>Explosion！！<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>可以通过 <code>&#123;&#125;</code> 嵌入 JS 表达式来渲染：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">import React from &#x27;react&#x27;;</span><br><span class="line">import ReactDOM from &#x27;react-dom/client&#x27;;</span><br><span class="line">const root = ReactDOM.createRoot(document.getElementById(&quot;root&quot;));</span><br><span class="line">let text = &quot;Explosion&quot;;</span><br><span class="line">root.render(</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        &#123;text&#125;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>常见的 JS 表达式有：</p><ul><li>变量&#x2F;值</li><li>数学运算</li><li>三目表达式</li><li>借助于数组迭代方法的循环，<code>map filter</code>等</li><li>有返回值的函数调用</li></ul><p><code>&#123;&#125;</code> 语法中嵌入不同的值，所呈现出来的特点如下：</p><ul><li><p>number &#x2F; string：值是什么，就渲染出来什么</p></li><li><p>bool &#x2F; null &#x2F; undefined &#x2F; Symbol &#x2F; Bigint：渲染内容是空</p></li><li><p>普通对象：不支持渲染</p></li><li><p>数组对象：把每一项拿出来，分别渲染（并不是变为字符串渲染，中间没有逗号，如果数组中有不支持渲染的元素，如普通对象，也会报错）</p></li><li><p>正则对象、时间对象、包装类对象：不支持渲染</p></li><li><p>函数对象：不支持在 <code>&#123;&#125;</code> 中渲染，但是可以作为函数组件，作为组件 <code>&lt;componment /&gt;</code> 渲染</p><blockquote><p>除数组对象之外，其余对象一般都不支持在 <code>&#123;&#125;</code> 中渲染，但也有特殊情况：</p><ul><li>JSX 虚拟 DOM 对象</li><li>给元素设置 style 样式，要求写成一个对象格式</li></ul></blockquote></li></ul><p>元素设置行内样式<br>行内样式，需要基于对象的格式处理，直接写成字符串会报错。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h2</span> <span class="attr">style</span>=<span class="string">&#123;&#123;color:</span> &#x27;<span class="attr">red</span>&#x27;, <span class="attr">fontSize:</span> &#x27;<span class="attr">18px</span>&#x27;&#125;&#125;&gt;</span>Learn React<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br></pre></td></tr></table></figure><p>样式属性要基于小驼峰命名法。<br>设置样式类名：要把 <code>class</code> 替换为 <code>className</code>：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h2</span> <span class="attr">className</span>=<span class="string">&quot;box&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br></pre></td></tr></table></figure><p>需求一：基于数据的值，来判断元素的显示隐藏</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    &#123;/* 控制元素是否显示，不论显示还是隐藏，元素本身已经渲染出来了 */&#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">display:</span> <span class="attr">this.flag</span> ? &quot;<span class="attr">block</span>&quot; <span class="attr">:</span> &quot;<span class="attr">none</span>&quot;</span></span><br><span class="line"><span class="tag">        &#125;&#125;&gt;</span>显示</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    &#123;/* 控制元素是否渲染 */&#125;</span><br><span class="line">    &#123;this.flag ? <span class="tag">&lt;<span class="name">button</span>&gt;</span>渲染/不渲染<span class="tag">&lt;/<span class="name">button</span>&gt;</span> : null&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>需求二：从服务器获取了一组列表数据，循环动态绑定相关的内容</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">const root = ReactDOM.createRoot(document.getElementById(&#x27;root&#x27;))</span><br><span class="line">let data = [</span><br><span class="line">    &#123;</span><br><span class="line">        id: 1,</span><br><span class="line">        title: &#x27;新闻一&#x27;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        id: 2,</span><br><span class="line">        title: &#x27;新闻二&#x27;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        id: 3,</span><br><span class="line">        title: &#x27;新闻三&#x27;</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br><span class="line">root.render(</span><br><span class="line">    <span class="tag">&lt;&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h2</span> <span class="attr">className</span>=<span class="string">&quot;title&quot;</span>&gt;</span>今日新闻<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ul</span> <span class="attr">className</span>=<span class="string">&quot;news-box&quot;</span>&gt;</span></span><br><span class="line">            &#123;</span><br><span class="line">                data.map( (item, index) =&gt; &#123;</span><br><span class="line">                    return <span class="tag">&lt;<span class="name">li</span> <span class="attr">key</span>=<span class="string">&#123;item.id&#125;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">em</span>&gt;</span>&#123;item.id&#125;<span class="tag">&lt;/<span class="name">em</span>&gt;</span></span><br><span class="line">                        <span class="symbol">&amp;nbsp;</span><span class="symbol">&amp;nbsp;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;item.title&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                &#125; )</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">        &#123;/* 扩展需求：没有数组，就是想单独循环 5 ci */&#125;</span><br><span class="line">        &#123;</span><br><span class="line">            new Array(5).fill(null).map( (_, index) =&gt; &#123;</span><br><span class="line">                return <span class="tag">&lt;<span class="name">button</span> <span class="attr">key</span>=<span class="string">&#123;index&#125;</span>&gt;</span></span><br><span class="line">                    按钮&#123;index + 1&#125;</span><br><span class="line">                <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="tag">&lt;/&gt;</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><blockquote><p>对于 <code>Array()</code> 函数，如果参数仅传入一个数值，则该参数表示长度，即：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">5</span>) <span class="comment">// 返回数组长度为 5 的稀疏数组，其每一项都是 empty</span></span><br></pre></td></tr></table></figure><p>使用数组的迭代方法（<code>forEach</code> 或 <code>map</code>），它们不会去迭代稀疏数组，例如：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">5</span>)</span><br><span class="line">arr.<span class="title function_">forEach</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;OK&#x27;</span>) <span class="comment">// 不打印任何输出</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>可以基于数组的 <code>fill</code> 方法，将稀疏数组进行填充，变为密集数组，就可以使用数组的迭代方法了。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr2 = arr.<span class="title function_">fill</span>(<span class="literal">null</span>) <span class="comment">// arr2 = [null, null, null, null, null]</span></span><br><span class="line">arr2.<span class="title function_">forEach</span>( <span class="function">() =&gt;</span> &#123;</span><br><span class="line"> <span class="variable language_">console</span>.<span class="title function_">log</span>(&amp;#<span class="number">39</span>;<span class="variable constant_">OK</span>&amp;#<span class="number">39</span>;) <span class="comment">// 输出 5 次 &amp;#39;ok&amp;#39;</span></span><br><span class="line">&#125; )J</span><br></pre></td></tr></table></figure></blockquote><h1 id="JSX-底层渲染机制"><a href="#JSX-底层渲染机制" class="headerlink" title="JSX 底层渲染机制"></a>JSX 底层渲染机制</h1><ul><li><p>编写的 JSX 语法，编译成虚拟 DOM 对象，virtual DOM 对象是一个普通的 JS 对象，用来描述真实 DOM 对象的</p></li><li><p>虚拟 DOM 对象：框架内部自构建的一套对象体系(对象的相关成员都是 React 内部规定的，基于属性构建视图，相关特征)</p></li><li><p>基于 babel-preset-react-app 插件，把 JSX 语法编译成 React.createElement(…)语法,React.createElement(ele,props,…children)</p><blockquote><p>ele:元素类型，字符串或者函数，函数就是组件<br>props:当前元素的属性对象,没有就是 null</p><p>children:当前元素的子元素，没有就是 undefined</p></blockquote></li><li><p>React.createElement 执行，返回一个对象，对象中包含了当前元素的描述信息(虚拟 DOM 对象)</p></li><li><pre><code class="javascript">let virtualDOM = &#123;
  $$typeof: Symbol(react.element),
  ref: null,
  key: null,
  type: &#39;h1&#39;, // 标签名 [组件]
  props: &#123;
    id: &#39;title&#39;,
    className: &#39;title&#39;,
    children: &#39;hello world&#39;
  &#125;
&#125;
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- 把构建的 virtual DOM 对象渲染成真实的 DOM 元素，第一次渲染是把所有的内容都渲染到页面中，第二次及以后的渲染，都是把最新的数据和上一次的虚拟 DOM 进行比对(DOM-DIFF)，把不同的地方重新渲染(PATCH)，这样可以提升渲染的性能</span><br><span class="line"></span><br><span class="line">基于 ReactDom 中的 render 方法</span><br><span class="line"></span><br><span class="line">- v16</span><br><span class="line"></span><br><span class="line">  ```javascript</span><br><span class="line">  ReactDOM.render(virtualDOM, container, callback)</span><br><span class="line">  ReactDOM.render(&lt;&gt;...&lt;/&gt;, document.getElementById(&#x27;root&#x27;))</span><br></pre></td></tr></table></figure>
</code></pre></li><li><p>v18</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cosnt root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(doucment.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line">   root.<span class="title function_">render</span>(</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;&gt;</span>...<span class="tag">&lt;/&gt;</span></span></span><br><span class="line">   )</span><br></pre></td></tr></table></figure></li></ul><blockquote><p>之所以有区别是因为 在react18 中默认的create-react-app中引入的是”react-dom&#x2F;client” 是客户端(浏览器)使用的包 而在react16中使用的是”react-dom” 其根对象中包括了ReactDom.render 方法</p></blockquote><p><strong>封装一个对象的迭代方法</strong></p><ol><li>基于传统的 for&#x2F;in 循环，会存在一些弊端<em>【性能差(公有私有都会迭代)，只能迭代”可枚举”，非 Symbol 类型的属性】</em></li><li>解决办法：获取对象的所有私有属性<br>a. <code>Object.getOwnPropertyNames(arr)</code> –&gt; 获取对象的私有属性(不包含 Symbol 类型的属性)<br>b. <code>Object.getOwnPropertySymbols(arr)</code> –&gt; 获取对象的私有 Symbol 类型的属性名<br>c. 获取所有私有属性<br><code>let keys = Object.getOwnPropertyNames(arr).concat(Object.getOwnPropertySymbols(arr))</code></li><li>可以基于 ES6 中的 reflect.ownKeys 代替上述操作 <em>[不能兼容 IE]</em><br><code>let keys = Reflect.ownKeys(arr)</code></li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">each</span> = (<span class="params">obj: any, callback: <span class="built_in">Function</span></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (obj === <span class="literal">null</span> || <span class="keyword">typeof</span> obj !== <span class="string">&#x27;object&#x27;</span>)</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">TypeError</span>(<span class="string">&#x27;obj is not a object&#x27;</span>)</span><br><span class="line">  <span class="keyword">if</span> (callback === <span class="literal">null</span> || <span class="keyword">typeof</span> callback !== <span class="string">&#x27;function&#x27;</span>)</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">TypeError</span>(<span class="string">&#x27;callback is not a function&#x27;</span>)</span><br><span class="line">  <span class="keyword">let</span> keys = <span class="title class_">Reflect</span>.<span class="title function_">ownKeys</span>(obj)</span><br><span class="line">  keys.<span class="title function_">forEach</span>(<span class="function">(<span class="params">key: any</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">callback</span>(key, obj[key])</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="函数组件的底层渲染机制"><a href="#函数组件的底层渲染机制" class="headerlink" title="函数组件的底层渲染机制"></a>函数组件的底层渲染机制</h1><h2 id="函数组件"><a href="#函数组件" class="headerlink" title="函数组件"></a>函数组件</h2><p>使用函数去返回<code>JSX</code>试图的组件的写法就是函数组件</p><p>调用: 基于 ES6Module 规范，导入创建的组件可以不用.jsx，写标签调用组件即可<br><code>&lt;Component/ &gt;单闭合 &lt;Component&gt;&lt;/Component&gt; 双闭合</code></p><p>调用组件的时候可以给调用的组件设置传递各种各样的属性<br><code>&lt;DemoOne title=&quot;我是标题&quot; x=&#123;10&#125; data=&#123;[100,200]&#125; className=&quot;box&quot; style=&#123;&#123;fontSize:'20px'&#125;&#125;&gt;&lt;/DemoOne&gt;</code><br>a. 如果设置的属性不是字符串格式，需要基于<code>&#123;&#125;</code> 进行嵌套<br>b. 调用组件的时候，可以把一些数据&#x2F;信息基于属性 props 的方式，传递给组件</p><p><strong>命名：组件的名字，采用大驼峰 PascalCase 命名</strong></p><p><strong>渲染机制</strong> :<br>1 基于<code>babel-preset-react-app</code>把调用的组件转换为 createElement 格式(babel 插件)</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">React</span>.<span class="title function_">createElement</span>(<span class="title class_">DemoOne</span>,&#123;</span><br><span class="line">	<span class="attr">title</span>: <span class="string">&quot;\u62ll\u662F\u6807\u9898&quot;</span>,</span><br><span class="line">	<span class="attr">x</span>: <span class="number">10</span>,</span><br><span class="line">	<span class="attr">data</span>: [<span class="number">100</span>,<span class="number">200</span>],</span><br><span class="line">	<span class="attr">className</span>: <span class="string">&quot;box&quot;</span>,</span><br><span class="line">	<span class="attr">style</span>: &#123;</span><br><span class="line">		<span class="attr">fontSize</span>: <span class="string">&#x27;20px&#x27;</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>2 把 createElement 方法执行，创建出一个 virtualDom 对象</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">$$typeof</span>: <span class="title class_">Symbol</span>(react.<span class="property">element</span>),</span><br><span class="line">    <span class="attr">key</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="attr">props</span>: &#123;<span class="attr">title</span>: <span class="string">&#x27;我是标题&#x27;</span>,<span class="attr">x</span>: <span class="number">10</span>, <span class="attr">data</span>: 数组,<span class="attr">className</span>: <span class="string">&#x27;box&#x27;</span>, <span class="attr">style</span>: &#123;<span class="attr">fontSize</span>: <span class="string">&#x27;20px&#x27;</span>&#125;&#125;,<span class="comment">// 子节点[双闭合调用，则也包含children储存子节点]</span></span><br><span class="line">    <span class="attr">ref</span>: <span class="literal">null</span>.</span><br><span class="line">    <span class="attr">type</span>: <span class="title class_">DemoOne</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3 基于 root.render 把 virtualDom 变成真是的 Dom<br>type 值不再是一个字符串,而是变成一个函数此时</p><ul><li>把函数执行 -&gt; DemoOne() -&gt; <code>&lt;DemoOne /&gt;</code></li><li>把 virtualDom 中的 props,作为实参传递给函数 -&gt; <code>DemoOne(props)</code></li><li>接收函数执行的返回结果(当前组件的 <code>virtualDOM</code> 对像)</li><li>最后基于 render 把组件返回的虚拟 DOM 变成真实的 DOM，插入到<code>#root</code> 容器中</li></ul><h2 id="属性-props-的处理"><a href="#属性-props-的处理" class="headerlink" title="属性 props 的处理"></a>属性 props 的处理</h2><p>调用组件，传递进去的属性是“只读”的 [原理：props 对象被冻结了]<br>获取： props.xxx<br>修改：props.xxx &#x3D; xxx &#x3D;&#x3D;&gt; 报错 error</p><blockquote><p>关于对象的规则设置</p><ul><li>冻结<br>冻结对象：Object.freeze(obj)<br>检测是否被冻结：Object.isFrozen(obj) &#x3D;&gt; true&#x2F;false<br>被冻结的对象：不能修改成员值、不能新增成员、不能删除现有成员、不能给成员做劫持[Object.defineProperty]</li><li>密封<br>密封对象：Object.seal(obj)<br>检测是否被密封：Object.isSealed(obj)<br>被密封的对象：可以修改成员的值，但也不能删、不能新增、不能劫持</li><li>扩展<br>把对象设置成不可扩展：Object.preventExtensions(obj)<br>检测是否可扩展：Object,isExtensible(obj)<br>被设置不可扩展的对象：除了不能新增成员，其余都可操作</li></ul></blockquote><p>作用：父组件(index.jsx)调用子组件(DemoOne.jsx)的时候,可以基于属性，把不同的信息传递给子组件；子组件接受相应的属性值，呈现出不同的效果，让组件的复用性更强！！<br>虽然对于传递进来的属性，我们不能直接修改，但是可以做一些规则校验<br>​ 设置默认值：<br>​ 函数组件.defaultProps &#x3D; {<br>​ x：0,<br>​ …..<br>​ }<br>​ 设置其他规则，例如：数据值格式、是否必传。。。[依赖官方的插件：prop-types]</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">`import PropTypes from &#x27;prop-types&#x27;`</span></span><br><span class="line">函数组件.<span class="property">propTypes</span> = &#123;</span><br><span class="line"></span><br><span class="line"> <span class="attr">title</span>: <span class="title class_">PropTypes</span>.<span class="property">string</span>.<span class="property">isRequired</span></span><br><span class="line">​ <span class="attr">x</span>: <span class="title class_">PropTypes</span>.<span class="property">number</span></span><br><span class="line">​ <span class="attr">y</span>: <span class="title class_">PropTypes</span>.<span class="title function_">oneOfType</span>([</span><br><span class="line"></span><br><span class="line"> <span class="title class_">PropTypes</span>.<span class="property">number</span></span><br><span class="line"></span><br><span class="line"> <span class="title class_">PropTypes</span>.<span class="property">bool</span></span><br><span class="line">​ ])</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>传递进来的属性，首先会经历规则的校验，不管校验成功还是失败，最后都会把属性给 props，只不过如果不符合设定的规则，控制台会抛出警告错误(不影响属性值的获取)<br>如果想把传递的属性值进行修改，我们可以赋值给其他内容或者修改变量&#x2F;状态值</p><h2 id="插槽-slot-处理机制"><a href="#插槽-slot-处理机制" class="headerlink" title="插槽 slot 处理机制"></a>插槽 slot 处理机制</h2><p>封装 DemoOne 组件具有更强的复用性 [传递 HTML 结构]</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;DemoOne title=&#x27;xx&#x27; x=&#123;100&#125;&gt;</span><br><span class="line">    &lt;button solt=&#x27;explosion&#x27;&gt;确定&lt;/button&gt;</span><br><span class="line">    &lt;button solt=&#x27;explosion1&#x27;&gt;取消&lt;/button&gt;</span><br><span class="line">&lt;/DemoOne&gt;</span><br></pre></td></tr></table></figure><p>封装组件的时候，预留插槽位置，内容不用写，调用组件的时候基于双闭合调用的方式把插槽信息【子节点信息】传递给组件，组件内部进行渲染即可<br><code>props.children</code> 获取子节点信息</p><blockquote><p>传递数据用属性<br>传递 HTML 结构用插槽</p></blockquote><p>在组件中对<code>children</code>进行处理</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">const DemoOne = (props) =&gt; &#123;</span><br><span class="line">    let &#123;title, x, children &#125; = props</span><br><span class="line">    // 对children的类型做处理 可以基于 React.Children 对象中提供的方法，对props.children做处理：count\forEach\map\toArray ... (对children做了较好的处理)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>比如下面的一个简单的例子</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">root.render(</span><br><span class="line">	&lt;&gt;</span><br><span class="line">    	&lt;DemoOne title=&#x27;哈哈&#x27; x=&#123;10&#125;&gt;</span><br><span class="line">        	// 取slot字段名 进行判断筛选处理</span><br><span class="line">        	&lt;span slot=&#x27;footer&#x27;&gt;我是页脚&lt;/span&gt;</span><br><span class="line">        	&lt;span&gt;哈哈&lt;/span&gt;</span><br><span class="line">        	&lt;span slot=&#x27;header&#x27;&gt;我是页眉&lt;/span&gt;</span><br><span class="line">    	&lt;/DemoOne&gt;</span><br><span class="line">    &lt;/&gt;</span><br><span class="line">)</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">const DemoOne = (props) =&gt; &#123;</span><br><span class="line">    let &#123;title, x, children &#125; = props</span><br><span class="line">    children = React.Children.toArray(children)</span><br><span class="line">    let headerSlot=[],</span><br><span class="line">        footerSlot=[],</span><br><span class="line">        defaultSlot=[];</span><br><span class="line">    children.forEach(child=&gt;&#123;</span><br><span class="line">        // 传递进来的插槽信息都是编译的virtualDOM 不是标签</span><br><span class="line">        let &#123;slot&#125; = child.props</span><br><span class="line">        if (slot === &#x27;header&#x27;) &#123;</span><br><span class="line">            headerSlot.push(child)</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            ...</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    return &lt;div&gt;</span><br><span class="line">        	&#123;headerSlot&#125;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="静态组件"><a href="#静态组件" class="headerlink" title="静态组件"></a>静态组件</h2><p>函数组件是静态组件<br>第一次渲染组件，把函数执行：</p><ul><li>产生一个私有的上下文：EC(V)</li><li>把解析出来的 props [包含 children] 传递进来 [被冻结]</li><li>对函数返回的 JSX 元素进行渲染</li></ul><p>当我们点击按钮的时候，会把函数绑定并且执行</p><ul><li>修改上级上下文 EC(V)中变量</li><li>私有变量值发生了改变</li><li>视图不会更新</li></ul><p>类组件写法</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line">创建类组件</span><br><span class="line">	创建一个构造函数(类)</span><br><span class="line">	要求必须继承React.Component/PureComponent这个类</span><br><span class="line">	习惯于使用ES6中的class创建类</span><br><span class="line">	必须给类设置render方法放在原型上面在render中返回需要渲染的视图</span><br><span class="line">*/</span><br><span class="line">import React from &#x27;react&#x27;</span><br><span class="line">class Vote extends React.Component &#123;</span><br><span class="line">    render() &#123;</span><br><span class="line">        return &lt;&gt;</span><br><span class="line">        	...</span><br><span class="line">        &lt;/&gt;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="React-中的事件"><a href="#React-中的事件" class="headerlink" title="React 中的事件"></a>React 中的事件</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">const App = () =&gt; &#123;</span><br><span class="line">	const clickHandler = (event) =&gt; &#123;</span><br><span class="line">		event.preventDefault() // 取消默认行为</span><br><span class="line">		event.stopPropagation() // 取消事件的冒泡</span><br><span class="line"></span><br><span class="line">		alert(&quot;我是App中的clickHandler！&quot;)</span><br><span class="line">		/*</span><br><span class="line">		 *     在React中，无法通过return false取消默认行为</span><br><span class="line">		 *     return false;</span><br><span class="line">		 *</span><br><span class="line">		 *     事件对象</span><br><span class="line">		 *         - React事件中同样会传递事件对象，可以在响应函数中定义参数来接收事件对象</span><br><span class="line">		 *         - React中的事件对象同样不是原生的事件对象，是经过React包装后的事件对象</span><br><span class="line">		 *         - 由于对象进行过包装，所以使用过程中我们无需再去考虑兼容性问题</span><br><span class="line">		 * */</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	return (</span><br><span class="line">		&lt;div</span><br><span class="line">			onClick=&#123;() =&gt; &#123;</span><br><span class="line">				alert(&quot;div&quot;)</span><br><span class="line">			&#125;&#125;</span><br><span class="line">			style=&#123;&#123;</span><br><span class="line">				width: 200,</span><br><span class="line">				height: 200,</span><br><span class="line">				margin: &quot;100px auto&quot;,</span><br><span class="line">				backgroundColor: &quot;#bfa&quot;,</span><br><span class="line">			&#125;&#125;</span><br><span class="line">		&gt;</span><br><span class="line">			&#123;/*</span><br><span class="line">      在React中事件需要通过元素的属性来设置，</span><br><span class="line">        和原生JS不同，在React中事件的属性需要使用驼峰命名法：</span><br><span class="line">           onclick -&gt; onClick</span><br><span class="line">           onchange -&gt; onChange</span><br><span class="line">        属性值不能直接执行代码，而是需要一个回调函数：</span><br><span class="line">          onclick=&quot;alert(123)&quot;</span><br><span class="line">          onClick=&#123;()=&gt;&#123;alert(123)&#125;&#125;</span><br><span class="line">    */&#125;</span><br><span class="line">			&lt;button</span><br><span class="line">				onClick=&#123;() =&gt; &#123;</span><br><span class="line">					alert(123)</span><br><span class="line">				&#125;&#125;</span><br><span class="line">			&gt;</span><br><span class="line">				点我一下</span><br><span class="line">			&lt;/button&gt;</span><br><span class="line">			&lt;button onClick=&#123;clickHandler&#125;&gt;哈哈&lt;/button&gt;</span><br><span class="line">			&lt;br /&gt;</span><br><span class="line">			&lt;a href=&quot;https://www.baidu.com&quot; onClick=&#123;clickHandler&#125;&gt;</span><br><span class="line">				超链接</span><br><span class="line">			&lt;/a&gt;</span><br><span class="line">		&lt;/div&gt;</span><br><span class="line">	)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"> *   &lt;button onclick=&quot;alert(123)&quot;&gt;点我一下&lt;/button&gt;</span><br><span class="line"> *</span><br><span class="line"> *   &lt;button id=&quot;btn01&quot;&gt;点我一下&lt;/button&gt;</span><br><span class="line"> *</span><br><span class="line"> *   document.getElementById(&#x27;btn01&#x27;).onclick = function()&#123;&#125;;</span><br><span class="line"> *   document.getElementById(&#x27;btn01&#x27;).addEventListener(&#x27;click&#x27;, function()&#123;&#125;, false);</span><br><span class="line"> *</span><br><span class="line"> *</span><br><span class="line"> * */</span><br><span class="line"></span><br><span class="line">// 导出App</span><br><span class="line">export default App</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="React-中的-state"><a href="#React-中的-state" class="headerlink" title="React 中的 state"></a>React 中的 state</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./App.css&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">App</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;函数执行了 ---&gt; 组件创建完毕！&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">   * 在React中，当组件渲染完毕后，再修改组件中的变量，不会使组件重新渲染</span></span><br><span class="line"><span class="comment">   *   要使得组件可以收到变量的影响，必须在变量修改后对组件进行重新渲染</span></span><br><span class="line"><span class="comment">   *   这里我们就需要一个特殊变量，当这个变量被修改使，组件会自动重新渲染</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * state相当于一个变量，</span></span><br><span class="line"><span class="comment">   *   只是这个变量在React中进行了注册，</span></span><br><span class="line"><span class="comment">   *   React会监控这个变量的变化，当state发生变化时，会自动触发组件的重新渲染</span></span><br><span class="line"><span class="comment">   *   使得我们的修改可以在页面中呈现出来</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * 在函数组件中，我们需要通过钩子函数，获取state</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * 使用钩子 useState() 来创建state</span></span><br><span class="line"><span class="comment">   *   import &#123;useState&#125; from &quot;react&quot;;</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * 它需要一个值作为参数，这个值就是state的初始值</span></span><br><span class="line"><span class="comment">   *   该函数会返回一个数组</span></span><br><span class="line"><span class="comment">   *     数组中第一个元素，是初始值</span></span><br><span class="line"><span class="comment">   *       - 初始值只用来显示数据，直接修改不会触发组件的重新渲染</span></span><br><span class="line"><span class="comment">   *     数组中的第二个元素，是一个函数，通常会命名为setXxx</span></span><br><span class="line"><span class="comment">   *       - 这个函数用来修改state，调用其修改state后会触发组件的重新渲染，</span></span><br><span class="line"><span class="comment">   *           并且使用函数中的值作为新的state值</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * */</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> [counter, setCounter] = <span class="title function_">useState</span>(<span class="number">1</span>)</span><br><span class="line">  <span class="comment">// let counter = result[0];</span></span><br><span class="line">  <span class="comment">// let setCounter = result[1];</span></span><br><span class="line">  <span class="comment">// const [counter, setCounter] = result;</span></span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">   *   当点击+时，数字增大</span></span><br><span class="line"><span class="comment">   *   点击-时，数字减少</span></span><br><span class="line"><span class="comment">   * */</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 创建一个变量存储数字</span></span><br><span class="line">  <span class="comment">// let counter = 2;</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">addHandler</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="comment">// 点击后数字+1</span></span><br><span class="line">    <span class="comment">// alert(&#x27;+1&#x27;);</span></span><br><span class="line">    <span class="comment">// counter++;</span></span><br><span class="line">    <span class="title function_">setCounter</span>(counter + <span class="number">1</span>) <span class="comment">// 将counter值修改为2</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">lessHandler</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="comment">// 点击后数字-1</span></span><br><span class="line">    <span class="comment">// alert(&#x27;-1&#x27;);</span></span><br><span class="line">    <span class="comment">// counter--;</span></span><br><span class="line"></span><br><span class="line">    <span class="title function_">setCounter</span>(counter - <span class="number">1</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&#123;</span>&#x27;<span class="attr">app</span>&#x27;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>&#123;counter&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;lessHandler&#125;</span>&gt;</span>-<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;addHandler&#125;</span>&gt;</span>+<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导出App</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span></span><br></pre></td></tr></table></figure><h1 id="state-的注意"><a href="#state-的注意" class="headerlink" title="state 的注意"></a>state 的注意</h1><p><strong>state</strong></p><ul><li><p>state 实际就是一个被 React 管理的变量，当我们通过 setState()修改变量的值时，会触发组件的自动重新渲染</p></li><li><p>只有 state 值发生变化时，组件才会重新渲染</p></li><li><p>当 state 的值是一个对象时，修改时是使用新的对象去替换已有对象</p></li><li><p>当通过 setState 去修改一个 state 时，并不表示修改当前的 state 它修改的是组件下一次渲染时 state 值</p></li><li><p>setState()会触发组件的重新渲染，它是异步的所以当调用 setState()需要用旧 state 的值时，一定要注意<strong>有可能出现计算错误的情况</strong>为了避免这种情况，可以通过为 setState()传递回调函数的形式来修改 state 值</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">import &#123;useState&#125; from &quot;react&quot;;</span><br><span class="line">const [counter, setCounter] = useState(1);</span><br><span class="line">const [user, setUser] = useState(&#123;name: &#x27;孙悟空&#x27;, age: 18&#125;);</span><br><span class="line">const addHandler = () =&gt; &#123;</span><br><span class="line">        setTimeout(() =&gt; &#123;</span><br><span class="line">            // setCounter(counter + 1); // 将counter值修改为2</span><br><span class="line">            setCounter((prevCounter)=&gt;&#123;</span><br><span class="line"></span><br><span class="line">                /*</span><br><span class="line">                *   setState()中回调函数的返回值将会成为新的state值</span><br><span class="line">                *       回调函数执行时，React会将最新的state值作为参数传递</span><br><span class="line">                * */</span><br><span class="line">                return prevCounter + 1;</span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line">            // setCounter(prevState =&gt; prevState + 1);</span><br><span class="line">        &#125;, 1000);</span><br><span class="line">        const updateUserHandler = () =&gt; &#123;</span><br><span class="line">        // setUser(&#123;name:&#x27;猪八戒&#x27;&#125;);</span><br><span class="line"></span><br><span class="line">        // 如果直接修改旧的state对象，由于对象还是那个对象，所以不会生效</span><br><span class="line">        // user.name = &#x27;猪八戒&#x27;;</span><br><span class="line">        // console.log(user);</span><br><span class="line">        // setUser(user);</span><br><span class="line"></span><br><span class="line">        // const newUser = Object.assign(&#123;&#125;, user);</span><br><span class="line">        // newUser.name = &#x27;猪八戒&#x27;;</span><br><span class="line">        // setUser(newUser);</span><br><span class="line"></span><br><span class="line">        setUser(&#123;...user, name: &#x27;猪八戒&#x27;&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;;</span><br><span class="line">  </span><br><span class="line">    return &lt;div className=&#123;&#x27;app&#x27;&#125;&gt;</span><br><span class="line">        &lt;h1&gt;&#123;counter&#125; -- &#123;user.name&#125; -- &#123;user.age&#125;&lt;/h1&gt;</span><br><span class="line">        &lt;button onClick=&#123;addHandler&#125;&gt;1&lt;/button&gt;</span><br><span class="line">        &lt;button onClick=&#123;updateUserHandler&#125;&gt;2&lt;/button&gt;</span><br><span class="line">    &lt;/div&gt;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// 导出App</span><br><span class="line">export default App;</span><br></pre></td></tr></table></figure></li></ul><h1 id="React-中的双向数据绑定"><a href="#React-中的双向数据绑定" class="headerlink" title="React 中的双向数据绑定"></a>React 中的双向数据绑定</h1><p><strong>使用<code>useState</code>去控制表单</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; useState &#125; from &quot;react&quot;</span><br><span class="line">import Card from &quot;../UI/Card/Card&quot;</span><br><span class="line">import &quot;./LogsForm.css&quot;</span><br><span class="line">const LogsForm = () =&gt; &#123;</span><br><span class="line">	/*</span><br><span class="line">	 *   当表单项发生变化时，获取用户输入的内容</span><br><span class="line">	 * */</span><br><span class="line">	// 创建三个变量，用来存储表单中的数据</span><br><span class="line">	// let inputDate = &#x27;&#x27;;</span><br><span class="line">	// let inputDesc = &#x27;&#x27;;</span><br><span class="line">	// let inputTime = 0;</span><br><span class="line"></span><br><span class="line">	// const [inputDate, setInputDate] = useState(&#x27;&#x27;);</span><br><span class="line">	// const [inputDesc, setInputDesc] = useState(&#x27;&#x27;);</span><br><span class="line">	// const [inputTime, setInputTime] = useState(&#x27;&#x27;);</span><br><span class="line"></span><br><span class="line">	// 将表单数据统一到一个state中</span><br><span class="line">	const [formData, setFormData] = useState(&#123;</span><br><span class="line">		inputDate: &quot;&quot;,</span><br><span class="line">		inputDesc: &quot;&quot;,</span><br><span class="line">		inputTime: &quot;&quot;,</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	// 创建一个响应函数，监听日期的变化</span><br><span class="line">	const dateChangeHandler = (e) =&gt; &#123;</span><br><span class="line">		// 获取到当前触发事件的对象</span><br><span class="line">		// 事件对象中保存了当前事件触发时的所有信息</span><br><span class="line">		// event.target 执行的是触发事件的对象（DOM对象）</span><br><span class="line">		//console.log(e.target.value);</span><br><span class="line">		// setInputDate(e.target.value);</span><br><span class="line">		setFormData(&#123;</span><br><span class="line">			...formData,</span><br><span class="line">			inputDate: e.target.value,</span><br><span class="line">		&#125;)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	// 监听内容的变化</span><br><span class="line">	const descChangeHandler = (e) =&gt; &#123;</span><br><span class="line">		// 获取到当前触发事件的对象</span><br><span class="line">		// 事件对象中保存了当前事件触发时的所有信息</span><br><span class="line">		// event.target 执行的是触发事件的对象（DOM对象）</span><br><span class="line">		//console.log(e.target.value);</span><br><span class="line">		// setInputDesc(e.target.value);</span><br><span class="line"></span><br><span class="line">		setFormData(&#123;</span><br><span class="line">			...formData,</span><br><span class="line">			inputDesc: e.target.value,</span><br><span class="line">		&#125;)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	//监听时长的变化</span><br><span class="line">	const timeChangeHandler = (e) =&gt; &#123;</span><br><span class="line">		// 获取到当前触发事件的对象</span><br><span class="line">		// 事件对象中保存了当前事件触发时的所有信息</span><br><span class="line">		// event.target 执行的是触发事件的对象（DOM对象）</span><br><span class="line">		//console.log(e.target.value);</span><br><span class="line">		// setInputTime(e.target.value);</span><br><span class="line">		setFormData(&#123;</span><br><span class="line">			...formData,</span><br><span class="line">			inputTime: e.target.value,</span><br><span class="line">		&#125;)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	// 当表单提交时，汇总表单中的数据</span><br><span class="line">	/*</span><br><span class="line">	 *   在React中，通常表单不需要自行提交</span><br><span class="line">	 *       而是要通过React提交</span><br><span class="line">	 * */</span><br><span class="line">	const formSubmitHandler = (e) =&gt; &#123;</span><br><span class="line">		// 取消表单的默认行为</span><br><span class="line">		e.preventDefault()</span><br><span class="line">		// 获取表单项中的数据日期、内容、时长</span><br><span class="line">		// 将数据拼装为一个对象</span><br><span class="line">		const newLog = &#123;</span><br><span class="line">			date: new Date(formData.inputDate),</span><br><span class="line">			desc: formData.inputDesc,</span><br><span class="line">			time: +formData.inputTime,</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		// 清空表单项</span><br><span class="line">		setFormData(&#123;</span><br><span class="line">			inputDate: &quot;&quot;,</span><br><span class="line">			inputDesc: &quot;&quot;,</span><br><span class="line">			inputTime: &quot;&quot;,</span><br><span class="line">		&#125;)</span><br><span class="line"></span><br><span class="line">		console.log(newLog)</span><br><span class="line"></span><br><span class="line">		/*</span><br><span class="line">		 *   提交表单后如何清空表单中的旧数据</span><br><span class="line">		 *       现在这种表单，在React我们称为非受控组件</span><br><span class="line">		 *</span><br><span class="line">		 *   我们可以将表单中的数据存储到state中，</span><br><span class="line">		 *       然后将state设置为表单项value值，</span><br><span class="line">		 *       这样当表单项发生变化，state会随之变化，</span><br><span class="line">		 *       反之，state发生变化，表单项也会跟着改变，这种操作我们就称为双向绑定</span><br><span class="line">		 *       这样一来，表单就成为了一个受控组件</span><br><span class="line">		 *</span><br><span class="line">		 *</span><br><span class="line">		 *</span><br><span class="line">		 * */</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	return (</span><br><span class="line">		&lt;Card className=&quot;logs-form&quot;&gt;</span><br><span class="line">			&lt;form onSubmit=&#123;formSubmitHandler&#125;&gt;</span><br><span class="line">				&lt;div className=&quot;form-item&quot;&gt;</span><br><span class="line">					&lt;label htmlFor=&quot;date&quot;&gt;日期&lt;/label&gt;</span><br><span class="line">					&lt;input</span><br><span class="line">						onChange=&#123;dateChangeHandler&#125;</span><br><span class="line">						value=&#123;formData.inputDate&#125;</span><br><span class="line">						id=&quot;date&quot;</span><br><span class="line">						type=&quot;date&quot;</span><br><span class="line">					/&gt;</span><br><span class="line">				&lt;/div&gt;</span><br><span class="line">				&lt;div className=&quot;form-item&quot;&gt;</span><br><span class="line">					&lt;label htmlFor=&quot;desc&quot;&gt;内容&lt;/label&gt;</span><br><span class="line">					&lt;input</span><br><span class="line">						onChange=&#123;descChangeHandler&#125;</span><br><span class="line">						value=&#123;formData.inputDesc&#125;</span><br><span class="line">						id=&quot;desc&quot;</span><br><span class="line">						type=&quot;text&quot;</span><br><span class="line">					/&gt;</span><br><span class="line">				&lt;/div&gt;</span><br><span class="line">				&lt;div className=&quot;form-item&quot;&gt;</span><br><span class="line">					&lt;label htmlFor=&quot;time&quot;&gt;时长&lt;/label&gt;</span><br><span class="line">					&lt;input</span><br><span class="line">						onChange=&#123;timeChangeHandler&#125;</span><br><span class="line">						value=&#123;formData.inputTime&#125;</span><br><span class="line">						id=&quot;time&quot;</span><br><span class="line">						type=&quot;number&quot;</span><br><span class="line">					/&gt;</span><br><span class="line">				&lt;/div&gt;</span><br><span class="line">				&lt;div className=&quot;form-btn&quot;&gt;</span><br><span class="line">					&lt;button&gt;添加&lt;/button&gt;</span><br><span class="line">				&lt;/div&gt;</span><br><span class="line">			&lt;/form&gt;</span><br><span class="line">		&lt;/Card&gt;</span><br><span class="line">	)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default LogsForm</span><br></pre></td></tr></table></figure><h1 id="React-中的-portal"><a href="#React-中的-portal" class="headerlink" title="React 中的 portal"></a>React 中的 portal</h1><ul><li><p>组件默认会作为父组件的后代渲染到页面中</p><blockquote><p>存在一些问题 比如要写对话框和模态框的时候需要渲染到根目录下</p></blockquote></li><li><p>通过 protal 可以将组件渲染到页面中的指定位置</p></li><li><p>使用方法</p><ul><li>在<code>index.html</code>添加一个新元素</li><li>修改组件的渲染方式<ul><li>通过 ReactDom.createPortal() 作为返回值创建元素</li><li>参数<ol><li>jsx (修改前 return 的代码)</li><li>目标位置 (DOM 元素)</li></ol></li></ul></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./Backdrop.css&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取backdrop的根元素</span></span><br><span class="line"><span class="keyword">const</span> backdropRoot = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;backdrop-root&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Backdrop</span> = (<span class="params">props</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">ReactDOM</span>.<span class="title function_">createPortal</span>(</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;backdrop&quot;</span>&gt;</span>&#123;props.children&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>,</span><br><span class="line">    backdropRoot</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Backdrop</span></span><br></pre></td></tr></table></figure></li></ul><h1 id="React-中的CSS-Module"><a href="#React-中的CSS-Module" class="headerlink" title="React 中的CSS-Module"></a>React 中的<code>CSS-Module</code></h1><p>CSS 模块</p><ul><li>类似于 Vue 中的 style 中的<code>scope</code>可以避免被全局污染</li><li>使用步骤<ol><li><em>创建一个 xxx.module.css</em></li><li><em>在组件中引入 css</em><br><code>import classes from &#39;./App.module.css&#39;;</code></li><li><em>通过 classes 来设置类</em><br><code>className=&#123;classes.p1&#125;</code></li><li><em>CSS 模块可以动态的设置唯一的 class 值</em></li></ol></li></ul><h1 id="React-Fragment"><a href="#React-Fragment" class="headerlink" title="React.Fragment"></a>React.Fragment</h1><ul><li>是一个专门用来作为父容器的组件</li><li><em>它只会将它里边的子元素直接返回，不会创建任何多余的元素</em></li><li>当我们希望有一个父容器<strong>但同时又不希望父容器在网页中产生多余的结构时</strong>就可以使用 Fragment</li></ul><h1 id="React-中的-Context"><a href="#React-中的-Context" class="headerlink" title="React 中的 Context"></a>React 中的 Context</h1><p><code>Context</code>相当于一个公共的存储空间,我们可以将多个组件中都需要访问的数据统一存储到一个<code>Context</code>中,这样无需通过<code>props</code>逐层传递,即可使组件访问到这些数据<br>通过<code>React.createContext()</code>创建 context</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">TestContext</span> = <span class="title class_">React</span>.<span class="title function_">createContext</span>(&#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;月晕&#x27;</span>,</span><br><span class="line">  <span class="attr">age</span>: <span class="number">18</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>使用方式</p><ul><li><p>使用方式一(不推荐)</p><ol><li><p>引入 context</p></li><li><p>使用<code>Xxx.Consumer</code>组件来创建元素</p></li><li><p>Comsumer 的标签体需要一个回调函数会将 context 设置为回调函数的参数通过参数能访问到 context 中存储的数据</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">TestContext</span> <span class="keyword">from</span> <span class="string">&#x27;../store/testContext&#x27;</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">A</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">TestContext.Consumer</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;(ctx) =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">        return (</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            &#123;ctx.name&#125; - &#123;ctx.age&#125;</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        )</span></span><br><span class="line"><span class="language-xml">      &#125;&#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">TestContext.Consumer</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> A</span><br></pre></td></tr></table></figure></li></ol></li><li><p>使用 Context 方式二</p><ol><li>导入 Context</li><li>使用钩子函数 useContext()获取到 context</li><li>useContext() 需要一个 Context 作为参数它会将 Context 中数据获取并作为返回值返回</li></ol></li><li><p>Xxx.Provider</p><ul><li><p><em>表示数据的生产者，可以使用它来指定 Context 中的数据</em></p></li><li><p>通过 value 来指定 Context 中存储的数据， 这样一来，在该组件的所有的子组件中都可以通过 Context 来访问它所指定数据</p></li><li><p>当我们通过 Context 访问数据时，他会读取离他最近的 Provider 中的数据，如果没有 Provider，则读取 Context 中的默认数据</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useContext &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">TestContext</span> <span class="keyword">from</span> <span class="string">&#x27;../store/testContext&#x27;</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">B</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="comment">// 使用钩子函数获取Context</span></span><br><span class="line">  <span class="keyword">const</span> ctx = <span class="title function_">useContext</span>(<span class="title class_">TestContext</span>)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;ctx.name&#125; -- &#123;ctx.age&#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> B</span><br></pre></td></tr></table></figure></li></ul></li></ul><h1 id="React-中的-Effect"><a href="#React-中的-Effect" class="headerlink" title="React 中的 Effect"></a>React 中的 Effect</h1><h2 id="Effect"><a href="#Effect" class="headerlink" title="Effect"></a>Effect</h2><p><strong>React</strong>组件有部分逻辑都可以直接编写到组件的函数体中，像是对数组调用<code>filter、map</code>等方法，像是判断某个组件是否显示等。但是有一部分逻辑如果直接写在函数体中，会影响到组件的渲染，这部分会产生“副作用”的代码，是一定不能直接写在函数体中。</p><h2 id="React-StrictMode"><a href="#React-StrictMode" class="headerlink" title="React.StrictMode"></a>React.StrictMode</h2><p>编写 React 组件时，我们要极力的避免组件中出现那些会产生“副作用”的代码。同时，如果你的 React 使用了严格模式，也就是在 React 中使用了<code>React.StrictMode</code>标签，那么 React 会非常“智能”的去检查你的组件中是否写有副作用的代码，当然这个智能是加了引号的，我们来看看 React 官网的文档是如何说明的：</p><p>Strict mode can’t automatically detect side effects for you, but it can help you spot them by making them a little more deterministic. This is done by intentionally double-invoking the following functions:</p><ul><li>Class component <code>constructor</code>, <code>render</code>, and <code>shouldComponentUpdate</code> methods</li><li>Class component static <code>getDerivedStateFromProps</code> method</li><li>Function component bodies</li><li>State updater functions (the first argument to <code>setState</code>)</li><li>Functions passed to <code>useState</code>, <code>useMemo</code>, or <code>useReducer</code></li></ul><p>上文的关键字叫做“double-invoking”即重复调用，这句话是什么意思呢？大概意思就是，React 并不能自动替你发现副作用，但是它会想办法让它显现出来，从而让你发现它。那么它是怎么让你发现副作用的呢？React 的严格模式，在处于开发模式下，会主动的重复调用一些函数，以使副作用显现。所以在处于开发模式且开启了 React 严格模式时，这些函数会被调用两次：</p><ul><li>类组件的的 <code>constructor</code>, <code>render</code>, 和 <code>shouldComponentUpdate</code> 方法</li><li>类组件的静态方法 <code>getDerivedStateFromProps</code></li><li>函数组件的函数体</li><li>参数为函数的<code>setState</code></li><li>参数为函数的<code>useState</code>, <code>useMemo</code>, or <code>useReducer</code></li></ul><p>重复的调用会使副作用更容易凸显出来，你可以尝试着在函数组件的函数体中调用一个<code>console.log</code>你会发现它会执行两次</p><h2 id="setState-执行流程"><a href="#setState-执行流程" class="headerlink" title="setState 执行流程"></a>setState 执行流程</h2><p><strong>Too many re-renders</strong></p><ul><li>当我们直接在函数中调用 setState 时,就会触发上述报错</li><li>setState() 的执行流程 (函数组件)<br><code>setCount()</code>—&gt; dispatchSetDate()—&gt;会先判断，组件当时处于什么阶段 ( 如果是渲染阶段 —&gt; 不会检查 state 值是否相同 | 如果不是渲染阶段—&gt; 值不同，重新渲染；值相同，不重新渲染)</li></ul><h2 id="使用-useEffect"><a href="#使用-useEffect" class="headerlink" title="使用 useEffect"></a>使用 useEffect</h2><p><code>useEffect()</code>是一个钩子函数，需要一个函数作为参数，这个作为参数的函数，将会在组件渲染完毕后执行，开发中可以将会产生副作用的代码编写到其中</p><ul><li><p>默认情况下，useEffect()中的函数,会在组件渲染完成后调用，并且是每次渲染完成后都会调用</p></li><li><p>在 useEffect() 可以传递一个第二参数，第二参数是一个数组，在数组中可以指定 Effect 的依赖项，指定后，只有当依赖项发生变化时，Effect 才会被触发</p></li><li><p>通常会将 Effect 中使用的所有的变量都设置成依赖项</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;执行了～～&#x27;</span>)</span><br><span class="line">  <span class="keyword">if</span> (ctx.<span class="property">totalAMount</span> === <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="title function_">setShowDetails</span>(<span class="literal">false</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;, [ctx])</span><br></pre></td></tr></table></figure></li><li><p>**setState()**是由钩子函数 useState()生成的 不会发现变化可以不用加到 dep 里面</p></li><li><p>如果依赖项设置的是空数组，则意味 Effect 只会在组件初始化时触发一次</p></li></ul><h2 id="Effect-函数的返回"><a href="#Effect-函数的返回" class="headerlink" title="Effect 函数的返回"></a>Effect 函数的返回</h2><p>在 Effect 的回调函数中，可以指定一个函数作为返回值，这个函数可以称为清理函数，他会在下次 Effect 执行前调用可以在此函数中，做一些工作来清除上次 Effect 执行所带来的影响</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Effetc</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> timer = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;触发了&#x27;</span>)</span><br><span class="line">    props.<span class="title function_">onFilter</span>(keyword)</span><br><span class="line">  &#125;, <span class="number">1000</span>)</span><br><span class="line">  <span class="keyword">return</span> <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">clearTImeout</span>(timer)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;, [keyword])</span><br></pre></td></tr></table></figure><h1 id="React-中的-Reducer"><a href="#React-中的-Reducer" class="headerlink" title="React 中的 Reducer"></a>React 中的 Reducer</h1><p>在 React 的函数组件中，我们可以通过 useState()来创建 state。这种创建 state 的方式会给我们返回两个东西 state 和 setState()。state 用来读取数据，而 setState()用来设置修改数据。但是这种方式也存在着一些不足，因为所有的修改 state 的方式都必须通过 setState()来进行，如果遇到一些复杂度比较高的 state 时，这种方式似乎就变得不是那么的优雅，比如现在有很多数据，但是<code>useState()</code>只给我们提供了一个<code>setCartData()</code>方法，就会很麻烦</p><p>为了解决复杂<code>State</code>带来的不便，<code>React</code>为我们提供了一个新的使用<code>State</code>的方式。<code>Reducer</code>个人认为<code>Reducer</code>可以翻译为“整合器”，它的作用就是将那些和同一个<code>state</code>相关的所有函数都整合到一起，方便在组件中进行调用。</p><p>当然工具都有其使用场景，<code>Reducer</code>也不例外，它只适用于那些比较复杂的<code>state</code>，对于简单的<code>state</code>使用<code>Reducer</code>只能是徒增烦恼。下面用一个简单的演示一下</p><p>和<code>State</code>相同<code>Reducer</code>也是一个钩子函数，语法如下：<br><code>const [state, dispatch] = useReducer(reducer, initialArg, init);</code><br>参数</p><ul><li><strong>reducer</strong>：整合函数<ul><li><em>对于我们当前 state 的所有操作都应该在该函数中定义</em></li><li><em>该函数的返回值，会成为 state 的新值</em></li><li><em>reducer 在执行时，会收到两个参数：</em><ul><li><em>state 当前最新的 state</em></li><li>action 它需要一个对象 在对象中会存储 dispatch 所发送的指令</li></ul></li></ul></li><li><strong>initialArg</strong> : state 的初始值，作用和 useState()中的值是一样</li></ul><p>返回值</p><ul><li><strong>数组</strong><ul><li><em>第一个参数，state 用来获取 state 的值</em></li><li><em>第二个参数，state 修改的派发器<strong>通过派发器可以发送操作 state 的命令</strong>具体的修改行为将会由另外一个函数(reducer)执行</em></li></ul></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useReducer, useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="comment">// 为了避免reducer会重复创建，通常reducer会定义到组件的外部</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">countReducer</span> = (<span class="params">state, action</span>) =&gt; &#123;</span><br><span class="line">  <span class="comment">// console.log(&#x27;reducer执行了！&#x27;, state);</span></span><br><span class="line">  <span class="comment">// console.log(action.type);</span></span><br><span class="line">  <span class="comment">// 可以根据action中不同type来执行不同的操作</span></span><br><span class="line">  <span class="comment">// if(action.type === &#x27;ADD&#x27;)&#123;</span></span><br><span class="line">  <span class="comment">//     return state + 1;</span></span><br><span class="line">  <span class="comment">// &#125;else if(action.type === &#x27;SUB&#x27;)&#123;</span></span><br><span class="line">  <span class="comment">//     return state - 1;</span></span><br><span class="line">  <span class="comment">// &#125;</span></span><br><span class="line">  <span class="comment">// return state;</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">switch</span> (action.<span class="property">type</span>) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;ADD&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> state + <span class="number">1</span></span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;SUB&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> state - <span class="number">1</span></span><br><span class="line">    <span class="attr">default</span>:</span><br><span class="line">      <span class="keyword">return</span> state</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">App</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="comment">// 之前的写法</span></span><br><span class="line">  <span class="comment">// const [count, setCount] = useState(1);</span></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line">  <span class="comment">// const addHandler = () =&gt; &#123;</span></span><br><span class="line">  <span class="comment">//     setCount(prevState =&gt; prevState + 1);</span></span><br><span class="line">  <span class="comment">// &#125;;</span></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line">  <span class="comment">// const subHandler = () =&gt; &#123;</span></span><br><span class="line">  <span class="comment">//     setCount(prevState =&gt; prevState - 1);</span></span><br><span class="line">  <span class="comment">// &#125;;</span></span><br><span class="line">  <span class="comment">// 现在的写法</span></span><br><span class="line">  <span class="keyword">const</span> [count, countDispatch] = <span class="title function_">useReducer</span>(countReducer, <span class="number">1</span>)</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">addHandler</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="comment">// 增加count的值</span></span><br><span class="line">    <span class="title function_">countDispatch</span>(&#123; <span class="attr">type</span>: <span class="string">&#x27;ADD&#x27;</span> &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">subHandler</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="comment">// 增加count的值</span></span><br><span class="line">    <span class="title function_">countDispatch</span>(&#123; <span class="attr">type</span>: <span class="string">&#x27;SUB&#x27;</span> &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">style</span>=<span class="string">&#123;&#123;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">fontSize:</span> <span class="attr">30</span>,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">width:</span> <span class="attr">200</span>,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">height:</span> <span class="attr">200</span>,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">margin:</span> &#x27;<span class="attr">100px</span> <span class="attr">auto</span>&#x27;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">textAlign:</span> &#x27;<span class="attr">center</span>&#x27;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &#125;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    &gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;subHandler&#125;</span>&gt;</span>减少<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;count&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;addHandler&#125;</span>&gt;</span>增加<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="React-中的-memo"><a href="#React-中的-memo" class="headerlink" title="React 中的 memo"></a>React 中的 memo</h1><p><strong>React.memo()</strong> 是一个高阶组件</p><ul><li><em>它接收另一个组件作为参数，并且会返回一个包装过的新组件</em></li><li><em>包装过的新组件就会具有缓存功能，<strong>装过后，只有组件的 props 发生变化化</strong>才会触发组件的重新的渲染，否则总是返回缓存中结果</em></li></ul><h1 id="React-中的-useCallback"><a href="#React-中的-useCallback" class="headerlink" title="React 中的 useCallback"></a>React 中的 useCallback</h1><p><strong>useCallback</strong>：是一个钩子函数，用来创建 React 中的回调函数，创建的回调函数不会总在组件重新渲染时重新创建<br><code>useCallback()</code>参数</p><ol><li>回调函数</li><li>依赖数组<ul><li><em>当依赖数组中的变量发生变化时，回调函数才会重新创建</em></li><li><em>如果不指定依赖数组，回调函数每次都会重新创建</em></li><li><em>一定要将回调函数中使用到的所有变量都设置到依赖数组中</em> 除了（setState）</li></ul></li></ol><h1 id="React-中的-Hooks"><a href="#React-中的-Hooks" class="headerlink" title="React 中的 Hooks"></a>React 中的 Hooks</h1><p>React 中的钩子函数只能在函数组件或自定义钩子中调用，我们需要将 React 中钩子函数提取到一个公共区域时，就可以使用自定义钩子<br><em>自定义钩子其实就是一个普通函数，只是它的名字需要使用 use 开头</em><br>比如下面封装了<code>fetch</code>自定义函数</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useCallback, useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">useFetch</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [data, setData] = <span class="title function_">useState</span>([])</span><br><span class="line">  <span class="comment">// 添加一个state来记录数据是否正在加载,false表示没有加载数据，true表示加载</span></span><br><span class="line">  <span class="keyword">const</span> [loading, setLoading] = <span class="title function_">useState</span>(<span class="literal">false</span>)</span><br><span class="line">  <span class="comment">// 创建一个state来记录错误信息</span></span><br><span class="line">  <span class="keyword">const</span> [error, setError] = <span class="title function_">useState</span>(<span class="literal">null</span>)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> fetchData = <span class="title function_">useCallback</span>(<span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="title function_">setLoading</span>(<span class="literal">true</span>)</span><br><span class="line">      <span class="title function_">setError</span>(<span class="literal">null</span>)</span><br><span class="line">      <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">&#x27;http://localhost:1337/api/students&#x27;</span>)</span><br><span class="line">      <span class="comment">//判断请求是否加载成功</span></span><br><span class="line">      <span class="keyword">if</span> (res.<span class="property">ok</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> data = <span class="keyword">await</span> res.<span class="title function_">json</span>()</span><br><span class="line">        <span class="title function_">setData</span>(data.<span class="property">data</span>)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;数据加载失败！&#x27;</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">      <span class="title function_">setError</span>(e)</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">      <span class="title function_">setLoading</span>(<span class="literal">false</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, [])</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 设置返回值</span></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    loading,</span><br><span class="line">    error,</span><br><span class="line">    data,</span><br><span class="line">    fetchData</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="Redux"><a href="#Redux" class="headerlink" title="Redux"></a>Redux</h1><p><strong>A Predictable State Container for JS Apps</strong></p><ul><li>A Predictable State Container for JS Apps 是 Redux 官方对于 Redux 的描述，这句话可以这样翻译“一个专为 JS 应用设计的可预期的状态容器”，简单来说 Redux 是一个可预测的状态容器。</li></ul><h2 id="状态-State"><a href="#状态-State" class="headerlink" title="状态(State)"></a><strong>状态</strong>(State)</h2><p>state 直译过来就是状态 state 不过就是一个变量，一个用来记录（组件）状态的变量。组件可以根据不同的状态值切换为不同的显示</p><h2 id="容器-Container"><a href="#容器-Container" class="headerlink" title="容器(Container)"></a><strong>容器(Container)</strong></h2><p>容器当然是用来装东西的，状态容器即用来存储状态的容器。状态多了，自然需要一个东西来存储，但是容器的功能却不是仅仅能存储状态，它实则是一个状态的管理器，除了存储状态外，它还可以用来对 state 进行查询、修改等所有操作。</p><h2 id="可预测（Predictable）"><a href="#可预测（Predictable）" class="headerlink" title="可预测（Predictable）"></a>可预测（Predictable）</h2><p>可预测指我们在对 state 进行各种操作时，其结果是一定的。即以相同的顺序对 state 执行相同的操作会得到相同的结果。简单来说，Redux 中对状态所有的操作都封装到了容器内部，外部只能通过调用容器提供的方法来操作 state，而不能直接修改 state。这就意味着外部对 state 的操作都被容器所限制，对 state 的操作都在容器的掌控之中，也就是可预测。</p><p>总的来说，<strong>Redux 是一个稳定、安全的状态管理器</strong>。</p><h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><p>使用 Redux 之前，你需要先明确一点 Redux 是 JS 应用的状态容器，它并不是只能在 React 使用，而是可以应用到任意的 JS 应用中（包括前端 JS，和服务器中 Node.js）。总之，凡是 JS 中需要管理的状态的 Redux 都可以胜任。</p><h2 id="在网页中使用"><a href="#在网页中使用" class="headerlink" title="在网页中使用"></a>在网页中使用</h2><p>我们先来在网页中使用以下 Redux，在网页中使用 Redux 就像使用 jQuery 似的，直接在网页中引入 Redux 的库文件即可：<br><code>&lt;script src=&quot;https://unpkg.com/redux@4.2.0/dist/redux.js&quot;&gt;&lt;/script&gt;的</code><br>如果不使用 redux 的时候</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">const btn01 = document.getElementById(&#x27;btn01&#x27;); const btn02 =</span><br><span class="line">document.getElementById(&#x27;btn02&#x27;); const counterSpan =</span><br><span class="line">document.getElementById(&#x27;counter&#x27;); let count = 1;</span><br><span class="line">btn01.addEventListener(&#x27;click&#x27;, ()=&gt;&#123; count--; counterSpan.innerText = count;</span><br><span class="line">&#125;); btn02.addEventListener(&#x27;click&#x27;, ()=&gt;&#123; count++; counterSpan.innerText =</span><br><span class="line">count; &#125;);</span><br></pre></td></tr></table></figure><p>上述代码中 count 就是一个状态，只是这个状态没有专门的管理器，它的所有操作都在事件的响应函数中进行处理，这种状态就是不可预测的状态，因为在任何的函数中都可以对这个状态进行修改，没有任何安全限制。Redux 的真实使用场景依然是大型应用中的复杂 state。</p><p>Redux 是一个状态容器，所以使用 Redux 必须先创建容器对象，它的所有操作都是通过容器对象来进行的，创建容器的方式有多种，我们先说一种好理解的：<br><code>Redux.createStore(reducer,[perloadedState],[enhancer])</code><br><strong>createStore</strong>用来创建一个<strong>Redux 中的容器对象</strong>，它需要三个参数：reducer、preloadedState、enhancer</p><ul><li><strong>reducer</strong>：是一个函数，state 操作的整合函数，每次修改 state 都会触发该函数，返回值会变成新的 state</li><li><strong>preloadedState</strong>：是 state 的初始值，可以在这里指定也可以在 reducer 中指定。</li><li><strong>enhancer</strong>：增强函数用来对 state 的功能进行扩展</li></ul><p>三个参数中，只有 reducer 是必须的，来看一个 Reducer 的示例：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">countReducer</span> = (<span class="params">state = &#123; count: <span class="number">0</span> &#125;, action</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">switch</span> (action.<span class="property">type</span>) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;ADD&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123; <span class="attr">count</span>: state.<span class="property">count</span> + <span class="number">1</span> &#125;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;SUB&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123; <span class="attr">count</span>: state.<span class="property">count</span> - <span class="number">1</span> &#125;</span><br><span class="line">    <span class="attr">default</span>:</span><br><span class="line">      <span class="keyword">return</span> state</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>reducer 用来整合关于 state 的所有操作，容器修改 state 时会自动调用该函数，函数调用时会接收到两个参数：state 和 action，state 表示当前的 state，可以通过该 state 来计算新的 state。<code>state = &#123;count:0&#125;</code>这是在指定 state 的默认值，如果不指定，第一次调用时 state 的值会是 undefined。也可以将该值指定为 createStore()的第二个参数。action 是一个普通对象，用来存储操作信息。</p><p>将 reducer 传递进 createStore 后，我们会得到一个 store 对象：<br><code>const store = Redux.createStore(countReducer);</code><br>store 对象创建后，对 state 的所有操作都需要通过它来进行：</p><p>读取 state：<br><code>store.getState()</code></p><p>修改 state：<br><code>store.dispatch(&#123;type:&#39;ADD&#39;&#125;)</code></p><p>dipatch 用来触发 state 的操作，可以将其理解为是想 reducer 发送任务的工具。它需要一个对象作为参数，这个对象将会成为 reducer 的第二个参数 action，需要将操作信息设置到对象中传递给 reducer。action 中最重要的属性是 type，type 用来识别对 state 的不同的操作，上例中’ADD’表示增加操作，’SUB’表示减少的操作</p><p>除了这些方法外，store 还拥有一个 subscribe 方法，这个方法用来订阅 state 变化的信息。该方法需要一个回调函数作为参数，当 store 中存储的 state 发生变化时，回调函数会自动调用，我们可以在回调函数中定义 state 发生变化时所要触发的操作：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">store.<span class="title function_">subscribe</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// store中state发生变化时触发</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>如此一来，刚刚的代码被修改成了这个样子：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> btn01 = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;btn01&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> btn02 = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;btn02&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> counterSpan = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;counter&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">countReducer</span> = (<span class="params">state = &#123; count: <span class="number">0</span> &#125;, action</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">switch</span> (action.<span class="property">type</span>) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;ADD&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123; <span class="attr">count</span>: state.<span class="property">count</span> + <span class="number">1</span> &#125;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;SUB&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123; <span class="attr">count</span>: state.<span class="property">count</span> - <span class="number">1</span> &#125;</span><br><span class="line">    <span class="attr">default</span>:</span><br><span class="line">      <span class="keyword">return</span> state</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = <span class="title class_">Redux</span>.<span class="title function_">createStore</span>(countReducer)</span><br><span class="line"></span><br><span class="line">store.<span class="title function_">subscribe</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  counterSpan.<span class="property">innerText</span> = store.<span class="title function_">getState</span>().<span class="property">count</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">btn01.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  store.<span class="title function_">dispatch</span>(&#123; <span class="attr">type</span>: <span class="string">&#x27;SUB&#x27;</span> &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">btn02.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  store.<span class="title function_">dispatch</span>(&#123; <span class="attr">type</span>: <span class="string">&#x27;ADD&#x27;</span> &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>修改后的代码相较于第一个版本要复杂一些，同时也解决了之前代码中存在的一些问题：</p><ol><li>前一个版本的代码 state 就是一个变量，可以任意被修改。state 不可预测，容易被修改为错误的值。新代码中使用了 Redux，Redux 中的对 state 的所有操作都封装到了 reducer 函数中，可以限制 state 的修改使 state 可预测，有效的避免了错误的 state 值。</li><li>前一个版本的代码，每次点击按钮修改 state，就要手动的修改 counterSpan 的 innerText，非常麻烦，这样一来我们如果再添加新的功能，依然不能忘记对其进行修改。新代码中，counterSpan 的修改是在 store.subscribe()的回调函数中进行的，state 每次发生变化其值就会随之变化，不需要再手动修改。换句话说，state 和 DOM 元素通过 Redux 绑定到了一起。</li></ol><p>通过上例也不难看出，Redux 中最最核心的东西就是这个 store，只要拿到了这个 store 对象就相当于拿到了 Redux 中存储的数据。在加上 Redux 的核心思想中有一条叫做“单一数据源”，也就是所有的 state 都会存储到一课对象树中，并且这个对象树会存储到一个 store 中。所以到了 React 中，组件只需获取到 store 即可获取到 Redux 中存储的所有 state。</p><p>下面给出一个具体的代码示例</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;zh&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;sub&quot;</span>&gt;</span>减少<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">&quot;countSpan&quot;</span>&gt;</span>1<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">&quot;nameSpan&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;add&quot;</span>&gt;</span>增加<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;addFive&quot;</span>&gt;</span>加5<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://unpkg.com/redux@4.2.0/dist/redux.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> subBtn = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;sub&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> addBtn = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;add&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> addFiveBtn = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;addFive&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> countSpan = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;countSpan&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> nameSpan = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;nameSpan&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">/*</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">       *   网页中使用redux的步骤：</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">       *       1.引入redux核心包</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">       *       2.创建reducer整合函数</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">       *       3.通过reducer对象创建store</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">       *       4.对store中的state进行订阅</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">       *       5.通过dispatch派发state的操作指令</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">       * */</span></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">function</span> <span class="title function_">reducer</span>(<span class="params">state = &#123; count: <span class="number">1</span>, name: <span class="string">&#x27;孙悟空&#x27;</span> &#125;, action</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">/*</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">         *   state 表示当前state，可以根据这个state生成新的state</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">         *   action 是一个js对象，它里边会保存操作的信息</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">         *           type表示操作的类型</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">         *           其他需要传递的参数，也可以在action中设置</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">         * */</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">switch</span> (action.<span class="property">type</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">case</span> <span class="string">&#x27;ADD&#x27;</span>:</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">return</span> &#123; ...state, <span class="attr">count</span>: state.<span class="property">count</span> + <span class="number">1</span> &#125;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">case</span> <span class="string">&#x27;SUB&#x27;</span>:</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">return</span> &#123; ...state, <span class="attr">count</span>: state.<span class="property">count</span> - <span class="number">1</span> &#125;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">case</span> <span class="string">&#x27;ADD_N&#x27;</span>:</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">return</span> &#123; ...state, <span class="attr">count</span>: state.<span class="property">count</span> + action.<span class="property">payload</span> &#125;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">default</span>:</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">return</span> state</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> store = <span class="title class_">Redux</span>.<span class="title function_">createStore</span>(reducer)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      nameSpan.<span class="property">innerText</span> = store.<span class="title function_">getState</span>().<span class="property">name</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      store.<span class="title function_">subscribe</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 打印state的值</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// console.log(store.getState());</span></span></span><br><span class="line"><span class="language-javascript">        countSpan.<span class="property">innerText</span> = store.<span class="title function_">getState</span>().<span class="property">count</span></span></span><br><span class="line"><span class="language-javascript">        nameSpan.<span class="property">innerText</span> = store.<span class="title function_">getState</span>().<span class="property">name</span></span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      subBtn.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        store.<span class="title function_">dispatch</span>(&#123; <span class="attr">type</span>: <span class="string">&#x27;SUB&#x27;</span> &#125;)</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      addBtn.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        store.<span class="title function_">dispatch</span>(&#123; <span class="attr">type</span>: <span class="string">&#x27;ADD&#x27;</span> &#125;)</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      addFiveBtn.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        store.<span class="title function_">dispatch</span>(&#123; <span class="attr">type</span>: <span class="string">&#x27;ADD_N&#x27;</span>, <span class="attr">payload</span>: <span class="number">50</span> &#125;)</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id="RTX-Redux-Toolkit-工具包"><a href="#RTX-Redux-Toolkit-工具包" class="headerlink" title="**RTX(Redux Toolkit)**工具包"></a>**RTX(Redux Toolkit)**工具包</h1><p>在 React 中使用 RTK<br><code>yarn add react-redux @reduxjs/toolkit</code></p><p>具体使用</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用RTK来构建store</span></span><br><span class="line"><span class="keyword">import</span> &#123; configureStore, createSlice &#125; <span class="keyword">from</span> <span class="string">&#x27;@reduxjs/toolkit&#x27;</span></span><br><span class="line"><span class="comment">// createSlice：创建reducer的切片</span></span><br><span class="line"><span class="comment">// 它需要一个配置对象作为参数，通过对象的不同的属性来指定它的配置</span></span><br><span class="line"><span class="keyword">const</span> stuSlice = <span class="title function_">createSlice</span>(&#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;stu&#x27;</span>, <span class="comment">// 用来自动生成action中的type</span></span><br><span class="line">  <span class="attr">initialState</span>: &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;孙悟空&#x27;</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="number">18</span>,</span><br><span class="line">    <span class="attr">gender</span>: <span class="string">&#x27;男&#x27;</span>,</span><br><span class="line">    <span class="attr">address</span>: <span class="string">&#x27;花果山&#x27;</span></span><br><span class="line">  &#125;, <span class="comment">// state的初始值</span></span><br><span class="line">  <span class="attr">reducers</span>: &#123;</span><br><span class="line">    <span class="comment">//指定state的各种操作，直接在对象中添加方法</span></span><br><span class="line">    <span class="title function_">setName</span>(<span class="params">state, action</span>) &#123;</span><br><span class="line">      <span class="comment">//可以通过不同的方法来指定对state的不同操作</span></span><br><span class="line">      <span class="comment">// 两个参数：state 这个state的是一个代理对象，可以直接修改</span></span><br><span class="line">      state.<span class="property">name</span> = <span class="string">&#x27;猪八戒&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title function_">setAge</span>(<span class="params">state, action</span>) &#123;</span><br><span class="line">      state.<span class="property">age</span> = <span class="number">28</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// 切片对象会自动的帮助我们生成action</span></span><br><span class="line"><span class="comment">// actions中存储的是slice自动生成action创建器（函数），调用函数后会自动创建action对象</span></span><br><span class="line"><span class="comment">// action对象的结构 &#123;type:name/函数名, payload:函数的参数&#125;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> &#123; setName, setAge &#125; = stuSlice.<span class="property">actions</span></span><br><span class="line"><span class="comment">// const nameAction = setName(&#x27;哈哈&#x27;);</span></span><br><span class="line"><span class="comment">// const ageAction = setAge(30);</span></span><br><span class="line"><span class="comment">// console.log(nameAction);</span></span><br><span class="line"><span class="comment">// console.log(ageAction);</span></span><br><span class="line"><span class="comment">// 创建store 用来创建store对象，需要一个配置对象作为参数</span></span><br><span class="line"><span class="keyword">const</span> store = <span class="title function_">configureStore</span>(&#123;</span><br><span class="line">  <span class="attr">reducer</span>: &#123;</span><br><span class="line">    <span class="attr">student</span>: stuSlice.<span class="property">reducer</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store</span><br></pre></td></tr></table></figure><h2 id="RTX-具体使用案例"><a href="#RTX-具体使用案例" class="headerlink" title="RTX 具体使用案例"></a>RTX 具体使用案例</h2><p><code>store/index.js</code> 中</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; configureStore, createSlice &#125; <span class="keyword">from</span> <span class="string">&#x27;@reduxjs/toolkit&#x27;</span></span><br><span class="line"><span class="keyword">const</span> stuSlice = <span class="title function_">createSlice</span>(&#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;stu&#x27;</span>,</span><br><span class="line">  <span class="attr">initialState</span>: &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;孙悟空&#x27;</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="number">18</span>,</span><br><span class="line">    <span class="attr">gender</span>: <span class="string">&#x27;男&#x27;</span>,</span><br><span class="line">    <span class="attr">address</span>: <span class="string">&#x27;花果山&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">reducers</span>: &#123;</span><br><span class="line">    <span class="title function_">setName</span>(<span class="params">state, action</span>) &#123;</span><br><span class="line">      state.<span class="property">name</span> = action.<span class="property">payload</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title function_">setAge</span>(<span class="params">state, action</span>) &#123;</span><br><span class="line">      state.<span class="property">age</span> = action.<span class="property">payload</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> &#123; setName, setAge &#125; = stuSlice.<span class="property">actions</span></span><br><span class="line"><span class="keyword">const</span> store = <span class="title function_">configureStore</span>(&#123;</span><br><span class="line">  <span class="attr">reducer</span>: &#123;</span><br><span class="line">    <span class="attr">student</span>: stuSlice.<span class="property">reducer</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store</span><br></pre></td></tr></table></figure><p><code>App.js</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; useDispatch, useSelector &#125; <span class="keyword">from</span> <span class="string">&#x27;react-redux&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; setName, setAge &#125; <span class="keyword">from</span> <span class="string">&#x27;./store&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">App</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="comment">// useSelector() 用来加载state中的数据</span></span><br><span class="line">  <span class="keyword">const</span> student = <span class="title function_">useSelector</span>(<span class="function">(<span class="params">state</span>) =&gt;</span> state.<span class="property">student</span>)</span><br><span class="line">  <span class="comment">// 通过useDispatch()来获取派发器对象</span></span><br><span class="line">  <span class="keyword">const</span> dispatch = <span class="title function_">useDispatch</span>()</span><br><span class="line">  <span class="comment">// 获取action的构建器</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">setNameHandler</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="title function_">dispatch</span>(<span class="title function_">setName</span>(<span class="string">&#x27;沙和尚&#x27;</span>))</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">setAgeHandler</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="title function_">dispatch</span>(<span class="title function_">setAge</span>(<span class="number">33</span>))</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;student.name&#125; ---</span></span><br><span class="line"><span class="language-xml">        &#123;student.age&#125; ---</span></span><br><span class="line"><span class="language-xml">        &#123;student.gender&#125; ---</span></span><br><span class="line"><span class="language-xml">        &#123;student.address&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;setNameHandler&#125;</span>&gt;</span>修改name<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;setAgeHandler&#125;</span>&gt;</span>修改age<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span></span><br></pre></td></tr></table></figure><h2 id="拆分-RTX"><a href="#拆分-RTX" class="headerlink" title="拆分 RTX"></a>拆分 RTX</h2><p>当有不同的多个数据的时候比如存在学生姓名和学校<br><code>schoolSlice.js</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//创建学校的slice</span></span><br><span class="line"><span class="keyword">import</span> &#123; createSlice &#125; <span class="keyword">from</span> <span class="string">&#x27;@reduxjs/toolkit&#x27;</span></span><br><span class="line"><span class="keyword">const</span> schoolSlice = <span class="title function_">createSlice</span>(&#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;school&#x27;</span>,</span><br><span class="line">  <span class="attr">initialState</span>: &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;花果山一小&#x27;</span>,</span><br><span class="line">    <span class="attr">address</span>: <span class="string">&#x27;花果山大街28号&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">reducers</span>: &#123;</span><br><span class="line">    <span class="title function_">setName</span>(<span class="params">state, action</span>) &#123;</span><br><span class="line">      state.<span class="property">name</span> = action.<span class="property">payload</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title function_">setAddress</span>(<span class="params">state, action</span>) &#123;</span><br><span class="line">      state.<span class="property">address</span> = action.<span class="property">payload</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> &#123; setName, setAddress &#125; = schoolSlice.<span class="property">actions</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> &#123; <span class="attr">reducer</span>: schoolReducer &#125; = schoolSlice</span><br></pre></td></tr></table></figure><p><code>stuSlice.js</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// createSlice 创建reducer的切片</span></span><br><span class="line"><span class="comment">// 它需要一个配置对象作为参数，通过对象的不同的属性来指定它的配置</span></span><br><span class="line"><span class="keyword">import</span> &#123; createSlice &#125; <span class="keyword">from</span> <span class="string">&#x27;@reduxjs/toolkit&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> stuSlice = <span class="title function_">createSlice</span>(&#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;stu&#x27;</span>, <span class="comment">// 用来自动生成action中的type</span></span><br><span class="line">  <span class="attr">initialState</span>: &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;孙悟空&#x27;</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="number">18</span>,</span><br><span class="line">    <span class="attr">gender</span>: <span class="string">&#x27;男&#x27;</span>,</span><br><span class="line">    <span class="attr">address</span>: <span class="string">&#x27;花果山&#x27;</span></span><br><span class="line">  &#125;, <span class="comment">// state的初始值</span></span><br><span class="line">  <span class="attr">reducers</span>: &#123;</span><br><span class="line">    <span class="comment">// 指定state的各种操作，直接在对象中添加方法</span></span><br><span class="line">    <span class="title function_">setName</span>(<span class="params">state, action</span>) &#123;</span><br><span class="line">      <span class="comment">// 可以通过不同的方法来指定对state的不同操作</span></span><br><span class="line">      <span class="comment">// 两个参数：state 这个state的是一个代理对象，可以直接修改</span></span><br><span class="line">      state.<span class="property">name</span> = action.<span class="property">payload</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title function_">setAge</span>(<span class="params">state, action</span>) &#123;</span><br><span class="line">      state.<span class="property">age</span> = action.<span class="property">payload</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 切片对象会自动的帮助我们生成action</span></span><br><span class="line"><span class="comment">// actions中存储的是slice自动生成action创建器（函数），调用函数后会自动创建action对象</span></span><br><span class="line"><span class="comment">// action对象的结构 &#123;type:name/函数名, payload:函数的参数&#125;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> &#123; setName, setAge &#125; = stuSlice.<span class="property">actions</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> &#123; <span class="attr">reducer</span>: stuReducer &#125; = stuSlice</span><br></pre></td></tr></table></figure><p><code>store/index.js</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//使用RTK来构建store</span></span><br><span class="line"><span class="keyword">import</span> &#123; configureStore &#125; <span class="keyword">from</span> <span class="string">&#x27;@reduxjs/toolkit&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; stuReducer &#125; <span class="keyword">from</span> <span class="string">&#x27;./stuSlice&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; schoolReducer &#125; <span class="keyword">from</span> <span class="string">&#x27;./schoolSlice&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建store 用来创建store对象，需要一个配置对象作为参数</span></span><br><span class="line"><span class="keyword">const</span> store = <span class="title function_">configureStore</span>(&#123;</span><br><span class="line">  <span class="attr">reducer</span>: &#123;</span><br><span class="line">    <span class="attr">student</span>: stuReducer,</span><br><span class="line">    <span class="attr">school</span>: schoolReducer</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store</span><br></pre></td></tr></table></figure><p><code>App.js</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; useDispatch, useSelector &#125; <span class="keyword">from</span> <span class="string">&#x27;react-redux&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; setName, setAge &#125; <span class="keyword">from</span> <span class="string">&#x27;./store/stuSlice&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  setName <span class="keyword">as</span> setSchoolName,</span><br><span class="line">  setAddress <span class="keyword">as</span> setSchoolAddress</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;./store/schoolSlice&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">App</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="comment">// useSelector() 用来加载state中的数据</span></span><br><span class="line">  <span class="comment">// const student = useSelector(state =&gt; state.student);</span></span><br><span class="line">  <span class="comment">// // 引入学校的state</span></span><br><span class="line">  <span class="comment">// const school = useSelector(state =&gt; state.school);</span></span><br><span class="line">  <span class="keyword">const</span> &#123; student, school &#125; = <span class="title function_">useSelector</span>(<span class="function">(<span class="params">state</span>) =&gt;</span> state)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 通过useDispatch()来获取派发器对象</span></span><br><span class="line">  <span class="keyword">const</span> dispatch = <span class="title function_">useDispatch</span>()</span><br><span class="line">  <span class="comment">// 获取action的构建器</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">setNameHandler</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="title function_">dispatch</span>(<span class="title function_">setName</span>(<span class="string">&#x27;沙和尚&#x27;</span>))</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">setAgeHandler</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="title function_">dispatch</span>(<span class="title function_">setAge</span>(<span class="number">33</span>))</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;student.name&#125; ---</span></span><br><span class="line"><span class="language-xml">        &#123;student.age&#125; ---</span></span><br><span class="line"><span class="language-xml">        &#123;student.gender&#125; ---</span></span><br><span class="line"><span class="language-xml">        &#123;student.address&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;setNameHandler&#125;</span>&gt;</span>修改name<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;setAgeHandler&#125;</span>&gt;</span>修改age<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;school.name&#125; ---</span></span><br><span class="line"><span class="language-xml">        &#123;school.address&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> dispatch(setSchoolName(&#x27;高老庄中小&#x27;))&#125;&gt;</span></span><br><span class="line"><span class="language-xml">        修改学校名字</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> dispatch(setSchoolAddress(&#x27;高老庄府前街19号&#x27;))&#125;&gt;</span></span><br><span class="line"><span class="language-xml">        修改学校地址</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span></span><br></pre></td></tr></table></figure><h1 id="RTXQ-使用"><a href="#RTXQ-使用" class="headerlink" title="RTXQ 使用"></a>RTXQ 使用</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createApi, fetchBaseQuery &#125; <span class="keyword">from</span> <span class="string">&#x27;@reduxjs/toolkit/dist/query/react&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建Api对象</span></span><br><span class="line"><span class="comment">//createApi() 用来创建RTKQ中的API对象</span></span><br><span class="line"><span class="comment">// RTKQ的所有功能都需要通过该对象来进行</span></span><br><span class="line"><span class="comment">// createApi() 需要一个对象作为参数</span></span><br><span class="line"><span class="keyword">const</span> studentApi = <span class="title function_">createApi</span>(&#123;</span><br><span class="line">  <span class="attr">reducerPath</span>: <span class="string">&#x27;studentApi&#x27;</span>, <span class="comment">// Api的标识，不能和其他的Api或reducer重复</span></span><br><span class="line">  <span class="attr">baseQuery</span>: <span class="title function_">fetchBaseQuery</span>(&#123;</span><br><span class="line">    <span class="attr">baseUrl</span>: <span class="string">&#x27;http://localhost:1337/api/&#x27;</span></span><br><span class="line">  &#125;), <span class="comment">// 指定查询的基础信息，发送请求使用的工具</span></span><br><span class="line">  <span class="title function_">endpoints</span>(<span class="params">build</span>) &#123;</span><br><span class="line">    <span class="comment">// build是请求的构建器，通过build来设置请求的相关信息</span></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">getStudents</span>: build.<span class="title function_">query</span>(&#123;</span><br><span class="line">        <span class="title function_">query</span>(<span class="params"></span>) &#123;</span><br><span class="line">          <span class="comment">// 用来指定请求子路径</span></span><br><span class="line">          <span class="keyword">return</span> <span class="string">&#x27;students&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="comment">// endpoints 用来指定Api中的各种功能，是一个方法，需要一个对象作为返回值</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Api对象创建后，对象中会根据各种方法自动的生成对应的钩子函数</span></span><br><span class="line"><span class="comment">// 通过这些钩子函数，可以来向服务器发送请求</span></span><br><span class="line"><span class="comment">// 钩子函数的命名规则 getStudents --&gt; useGetStudentsQuery</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> &#123; useGetStudentsQuery &#125; = studentApi</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> studentApi</span><br></pre></td></tr></table></figure><h1 id="React-中的-router"><a href="#React-中的-router" class="headerlink" title="React 中的 router"></a>React 中的 router</h1><p>使用 React 这些工具所编写的项目通常都是单页应用（SPA）。单页应用中，整个应用中只含有一个页面，React 会根据不同的状态在应用中显示出不同的组件。但是我们之前所编写应用还存在着一个问题，整个应用只存在一个页面，一个请求地址，这就使得用户只能通过一个地址访问应用，当我们点击组件中的不同链接时应用的地址是不会发生变化的。这又有什么问题呢？由于应用只有一个地址，所以我们通过该地址访问应用时，总会直接跳转到应用的首页。如此一来，我们便不敢随意的刷新页面，因为一旦刷新页面便直接跳转到首页。在对页面进行分享时，也只能分享网站的首页，而不能分享指定的页面。</p><p>怎么办呢？难道我们要将一个页面拆分为多个页面吗？很明显不能这么做，这么做以后应用的跳转便脱离了 React 的控制，增加应用的复杂度，提高了项目维护的成本。</p><p>为了解决这个问题，我们需要引入一个新的工具 React Router，React Router 为我们提供一种被称为客户端路由的东西，通过客户端路由可以将 URL 地址和 React 组件进行映射，当 URL 地址发生变化时，它会根据设置自动的切换到指定组件。并且这种切换完全不依赖于服务器。换句话说，在用户看来浏览器的地址栏确实发生了变化，但是这一变化并不由服务器处理，而是通过客户端路由进行切换。<br>… 懒的写了</p><h1 id="关于-React-中的-hook"><a href="#关于-React-中的-hook" class="headerlink" title="关于 React 中的 hook"></a>关于 React 中的 hook</h1><p>关于 React 中的钩子函数，我们已经非常熟悉了。钩子函数的功能非常的强大，而它的使用又十分简单。关于钩子函数的使用，我们只需记住两点：</p><ol><li>钩子只能在 React 组件和自定义钩子中使用</li><li>钩子不能在嵌套函数或其他语句（if、switch、white、for 等）中使用</li></ol><h2 id="React-中自带的钩子函数"><a href="#React-中自带的钩子函数" class="headerlink" title="React 中自带的钩子函数"></a>React 中自带的钩子函数</h2><ol><li><strong>useState</strong></li><li><strong>useEffect</strong></li><li><strong>useContext</strong></li><li><strong>useReducer</strong></li><li><strong>useCallback</strong></li><li><strong>useRef</strong></li><li><strong>useMemo</strong></li><li><strong>useImperativeHandle</strong></li><li><strong>useLayoutEffect</strong></li><li><strong>useDebugValue</strong></li><li><strong>useDeferredValue</strong></li><li><strong>useTransition</strong></li><li><strong>useId</strong></li><li><strong>useSyncExternalStore</strong></li><li><strong>useInsertionEffect</strong></li></ol><h3 id="useMemo"><a href="#useMemo" class="headerlink" title="useMemo"></a>useMemo</h3><p>useMemo 和 useCallback 十分相似，useCallback 用来缓存函数对象，useMemo 用来缓存函数的执行结果。在组件中，会有一些函数具有十分的复杂的逻辑，执行速度比较慢。闭了避免这些执行速度慢的函数返回执行，可以通过 useMemo 来缓存它们的执行结果，像是这样：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> result = <span class="title function_">useMemo</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> 复杂逻辑函数()</span><br><span class="line">&#125;, [依赖项])</span><br></pre></td></tr></table></figure><p>useMemo 中的函数会在依赖项发生变化时执行，注意！是执行，这点和 useCallback 不同，useCallback 是创建。执行后返回执行结果，如果依赖项不发生变化，则一直会返回上次的结果，不会再执行函数。这样一来就避免复杂逻辑的重复执行。</p><h2 id="UseImperativeHandle"><a href="#UseImperativeHandle" class="headerlink" title="UseImperativeHandle"></a>UseImperativeHandle</h2><p>在 React 中可以通过 forwardRef 来指定要暴露给外部组件的 ref：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">MyButton</span> = <span class="title function_">forwardRef</span>(<span class="function">(<span class="params">props, ref</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">ref</span>=<span class="string">&#123;ref&#125;</span>&gt;</span>自定义按钮<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>上例中，MyButton 组件将 button 的 ref 作为组件的 ref 向外部暴露，其他组件在使用 MyButton 时，就可以通过 ref 属性访问：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="title class_">MyButton</span> ref=&#123;btnRef&#125; /&gt;</span><br></pre></td></tr></table></figure><p>通过 useImperativeHandle 可以手动的指定 ref 要暴露的对象，比如可以修改 MyButton 组件如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">MyButton</span> = <span class="title function_">forwardRef</span>(<span class="function">(<span class="params">props, ref</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">useImperativeHandle</span>(ref, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&#x27;孙悟空&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">button</span>&gt;</span>自定义按钮<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>useImperativeHandle 的第二个参数是一个函数，函数的返回值会自动赋值给 ref（current 属性）。上例中，我们将返回值为<code>&#123;name:&#39;孙悟空&#39;&#125;</code>，当然返回孙悟空没有什么意义。实际开发中，我们可以将一些操作方法定义到对象中，这样可以有效的减少组件对 DOM 对象的直接操作。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">MyButton</span> = <span class="title function_">forwardRef</span>(<span class="function">(<span class="params">props, ref</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> btnRef = <span class="title function_">useRef</span>()</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useImperativeHandle</span>(ref, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="title function_">setDisabled</span>(<span class="params"></span>) &#123;</span><br><span class="line">        btnRef.<span class="property">current</span>.<span class="property">disabled</span> = <span class="literal">true</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">ref</span>=<span class="string">&#123;btnRef&#125;</span>&gt;</span>自定义按钮<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">App</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> btnRef = <span class="title function_">useRef</span>()</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">clickHandler</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    btnRef.<span class="property">current</span>.<span class="title function_">setDisabled</span>()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">MyButton</span> <span class="attr">ref</span>=<span class="string">&#123;btnRef&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;clickHandler&#125;</span>&gt;</span>点击<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="UseLayoutEffect"><a href="#UseLayoutEffect" class="headerlink" title="UseLayoutEffect"></a>UseLayoutEffect</h2><p>useLayoutEffect 的方法签名和 useEffect 一样，功能也类似。不同点在于，useLayoutEffect 的执行时机要早于 useEffect，它会在 DOM 改变后调用。在老版本的 React 中它和 useEffect 的区别比较好演示，React18 中，useEffect 的运行方式有所变化，所以二者区别不好演示。</p><p>useLayoutEffect 使用场景不多，实际开发中，在 effect 中需要修改元素样式，且使用 useEffect 会出现闪烁现象时可以使用 useLayoutEffect 进行替换。<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://my-wp.oss-cn-beijing.aliyuncs.com/wp-content/uploads/2022/06/20220622111732278.png" alt="img"></p><h2 id="UseDebugValue"><a href="#UseDebugValue" class="headerlink" title="UseDebugValue"></a>UseDebugValue</h2><p>用来给自定义钩子设置标签，标签会在 React 开发工具中显示，用来调试自定义钩子，不常用。</p><h2 id="UseDeferredValue"><a href="#UseDeferredValue" class="headerlink" title="UseDeferredValue"></a>UseDeferredValue</h2><p>useDeferredValue 用来设置一个延迟的 state，比如我们创建一个 state，并使用 useDeferredValue 获取延迟值：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">const [queryStr, setQueryStr] = useState(&#x27;&#x27;);</span><br><span class="line">const deferredQueryStr = useDeferredValue(queryStr);</span><br></pre></td></tr></table></figure><p>上边的代码中 queryStr 就是一个常规的 state，deferredQueryStr 就是 queryStr 的延迟值。设置延迟值后每次调用 setState 后都会触发两次组件的重新渲染。第一次时，deferredQueryStr 的值是 queryStr 修改前的值，第二次才是修改后的值。换句话，延迟值相较于 state 来说总会慢一步更新。</p><p>延迟值可以用在这样一个场景，一个 state 需要在多个组件中使用。一个组件的渲染比较快，而另一个组件的渲染比较慢。这样我们可以为该 state 创建一个延迟值，渲染快的组件使用正常的 state 优先显示。渲染慢的组件使用延迟值，慢一步渲染。当然必须结合 React.memo 或 useMemo 才能真正的发挥出它的作用。</p><h2 id="UseTransition"><a href="#UseTransition" class="headerlink" title="UseTransition"></a>UseTransition</h2><p>当我们在组件中修改 state 时，会遇到复杂一些的 state，当修改这些 state 时，甚至会阻塞到整个应用的运行，为了降低这种 state 的影响，React 为我们提供了 useTransition，通过 useTransition 可以降低 setState 的优先级。</p><p>useTransition 会返回一个数组，数组中有两个元素，第一个元素是 isPending，它是一个变量用来记录 transition 是否在执行中。第二个元素是 startTransition，它是一个函数，可以将 setState 在其回调函数中调用，这样 setState 方法会被标记为 transition 并不会立即执行，而是在其他优先级更高的方法执行完毕，才会执行。</p><p>除了 useTransition 外，React 还直接为为我们提供了一个 startTransition 函数，在不需要使用 isPending 时，可以直接使用 startTransition 也可以达到相同的效果。</p><h2 id="UseId"><a href="#UseId" class="headerlink" title="UseId"></a>UseId</h2><p>生成唯一 id，使用于需要唯一 id 的场景，但不适用于列表的 key。</p></article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/yueyun.jpg" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/yueyun.jpg" title="头像" alt="头像"></a><div class="post-copyright__author_name">月晕</div><div class="post-copyright__author_desc">生命是有光的</div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="https://blog.yueyun.site/posts/9ac48510.html">原创</a><a class="post-copyright-title"><span onclick='rm.copyPageUrl("https://blog.yueyun.site/posts/9ac48510.html")'>React学习</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="https://blog.yueyun.site/posts/9ac48510.html"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><script>function copyCurrentPageUrl(){var e=window.location.href,t=document.createElement("input");t.setAttribute("value",e),document.body.appendChild(t),t.select(),t.setSelectionRange(0,99999),document.execCommand("copy"),document.body.removeChild(t)}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://blog.yueyun.site" target="_blank">月晕</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__category-list"><a class="post-meta__box__categoryes" href="/categories/%E5%89%8D%E7%AB%AF/"><span class="categoryes-punctuation"><i class="anzhiyufont anzhiyu-icon-inbox"></i></span>前端<span class="categoryesPageCount">8</span></a></div><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/JavaScript/"><span class="tags-punctuation"><i class="anzhiyufont anzhiyu-icon-tag"></i></span>JavaScript<span class="tagsPageCount">10</span></a><a class="post-meta__box__tags" href="/tags/React/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>React<span class="tagsPageCount">4</span></a><a class="post-meta__box__tags" href="/tags/%E5%89%8D%E7%AB%AF/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>前端<span class="tagsPageCount">13</span></a><a class="post-meta__box__tags" href="/tags/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>前端框架<span class="tagsPageCount">2</span></a></div></div></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/7251401c.html"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://blog-1301952160.cos.ap-shanghai.myqcloud.com/Apprehensive/postCover/qiuqiunile.jpg" onerror='onerror=null,src="/img/404.jpg"' alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">NestJS学习</div></div></a></div><div class="next-post pull-right"><a href="/posts/317b894e.html"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://blog-1301952160.cos.ap-shanghai.myqcloud.com/Apprehensive/postCover/1702396713207.jpg" onerror='onerror=null,src="/img/404.jpg"' alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Vue学习</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="anzhiyufont anzhiyu-icon-thumbs-up fa-fw" style="font-size:1.5rem;margin-right:4px"></i><span>喜欢这篇文章的人也看了</span></div><div class="relatedPosts-list"><div><a href="/posts/938f2f9c.html" title="React Native开坑"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://blog-1301952160.cos.ap-shanghai.myqcloud.com/Apprehensive/postCover/1702557508740.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2023-12-15</div><div class="title">React Native开坑</div></div></a></div><div><a href="/posts/49ae955a.html" title="React 源码分析"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://blog-1301952160.cos.ap-shanghai.myqcloud.com/Apprehensive/wallpaper/2.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2023-12-15</div><div class="title">React 源码分析</div></div></a></div><div><a href="/posts/317b894e.html" title="Vue学习"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://blog-1301952160.cos.ap-shanghai.myqcloud.com/Apprehensive/postCover/1702396713207.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2023-12-12</div><div class="title">Vue学习</div></div></a></div><div><a href="/posts/8f49bd54.html" title="前端技术探索"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://blog-1301952160.cos.ap-shanghai.myqcloud.com/Apprehensive/postCover/1719120534005.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-06-23</div><div class="title">前端技术探索</div></div></a></div><div><a href="/posts/d681bdaf.html" title="TypeScript语言学习"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://blog-1301952160.cos.ap-shanghai.myqcloud.com/Apprehensive/postCover/liang.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2023-12-22</div><div class="title">TypeScript语言学习</div></div></a></div><div><a href="/posts/ea5e4ee3.html" title="Vue部分源码分析"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://blog-1301952160.cos.ap-shanghai.myqcloud.com/Apprehensive/postCover/1700908595951.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2023-11-25</div><div class="title">Vue部分源码分析</div></div></a></div></div></div><hr><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="anzhiyufont anzhiyu-icon-comments"></i><span> 评论</span></div><div class="comment-randomInfo"><a onclick="anzhiyu.addRandomCommentInfo()" href="javascript:void(0)" style="display:none">匿名评论</a><a href="/privacy" style="margin-left:4px">隐私政策</a></div><div class="comment-tips" id="comment-tips"><span>✅ 你无需删除空行，直接评论以获取最佳展示效果</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div><div class="comment-barrage"></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info__sayhi" id="author-info__sayhi" onclick="anzhiyu.changeSayHelloText()"></div><div class="author-info-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/yueyun.jpg" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="avatar"><div class="author-info__decoration"><img class="avatar-decoration-1" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://blog-1301952160.cos.ap-shanghai.myqcloud.com/Apprehensive/avatar_desc/avatar_d1.png" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="decoration"><img class="avatar-decoration-2" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://blog-1301952160.cos.ap-shanghai.myqcloud.com/Apprehensive/avatar_desc/avatar_d2.png" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="decoration"><img class="avatar-decoration-3" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://blog-1301952160.cos.ap-shanghai.myqcloud.com/Apprehensive/avatar_desc/avatar_d3.png" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="decoration"><img class="avatar-decoration-4" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://blog-1301952160.cos.ap-shanghai.myqcloud.com/Apprehensive/avatar_desc/avatar_d4.png" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="decoration"></div></div><div class="author-info__bottom-group"><a class="author-info__bottom-group-left" href="/about"><h1 class="author-info__name">月晕</h1><div class="author-info__desc">生命是有光的</div></a><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="tencent://AddContact/?fromId=45&amp;fromSubId=1&amp;subcmd=all&amp;uin=3514392356&amp;website=www.oicqzone.com" target="_blank" title="QQ"><i class="anzhiyufont anzhiyu-icon-qq"></i></a><a class="social-icon faa-parent animated-hover" href="https://github.com/apprehen" target="_blank" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a><a class="social-icon faa-parent animated-hover" href="https://space.bilibili.com/554370301" target="_blank" title="BiliBili"><i class="anzhiyufont anzhiyu-icon-bilibili"></i></a></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#React-%E8%84%9A%E6%89%8B%E6%9E%B6%E6%90%AD%E5%BB%BA"><span class="toc-number">1.</span> <span class="toc-text">React 脚手架搭建</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Create-react-app-%E5%9F%BA%E7%A1%80%E6%93%8D%E4%BD%9C"><span class="toc-number">1.1.</span> <span class="toc-text">Create-react-app 基础操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%92%E5%88%86%E7%BB%84%E4%BB%B6%EF%BC%9A"><span class="toc-number">1.1.1.</span> <span class="toc-text">划分组件：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85-create-react-app"><span class="toc-number">1.1.2.</span> <span class="toc-text">安装 create-react-app</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%B7%A5%E7%A8%8B%E5%8C%96%E9%A1%B9%E7%9B%AE"><span class="toc-number">1.1.3.</span> <span class="toc-text">创建工程化项目</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%84%9A%E6%89%8B%E6%9E%B6%E7%9A%84%E8%BF%9B%E9%98%B6%E5%BA%94%E7%94%A8"><span class="toc-number">1.1.4.</span> <span class="toc-text">脚手架的进阶应用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E9%85%8D%E7%BD%AE%E4%BF%AE%E6%94%B9"><span class="toc-number">1.1.5.</span> <span class="toc-text">常见配置修改</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-less"><span class="toc-number">1.1.5.1.</span> <span class="toc-text">使用 less</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A2%9E%E5%8A%A0-alias"><span class="toc-number">1.1.5.2.</span> <span class="toc-text">增加 alias @</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E5%9F%9F%E5%90%8D%E6%88%96%E7%AB%AF%E5%8F%A3%E5%8F%B7"><span class="toc-number">1.1.5.3.</span> <span class="toc-text">修改域名或端口号</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E6%B5%8F%E8%A7%88%E5%99%A8%E5%85%BC%E5%AE%B9"><span class="toc-number">1.1.5.4.</span> <span class="toc-text">修改浏览器兼容</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MVC-%E6%A8%A1%E5%BC%8F%E5%92%8C-MVVM-%E6%A8%A1%E5%BC%8F"><span class="toc-number">2.</span> <span class="toc-text">MVC 模式和 MVVM 模式</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#JSX-%E8%AF%AD%E6%B3%95"><span class="toc-number">3.</span> <span class="toc-text">JSX 语法</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#JSX-%E5%BA%95%E5%B1%82%E6%B8%B2%E6%9F%93%E6%9C%BA%E5%88%B6"><span class="toc-number">4.</span> <span class="toc-text">JSX 底层渲染机制</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E7%BB%84%E4%BB%B6%E7%9A%84%E5%BA%95%E5%B1%82%E6%B8%B2%E6%9F%93%E6%9C%BA%E5%88%B6"><span class="toc-number">5.</span> <span class="toc-text">函数组件的底层渲染机制</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E7%BB%84%E4%BB%B6"><span class="toc-number">5.1.</span> <span class="toc-text">函数组件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B1%9E%E6%80%A7-props-%E7%9A%84%E5%A4%84%E7%90%86"><span class="toc-number">5.2.</span> <span class="toc-text">属性 props 的处理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8F%92%E6%A7%BD-slot-%E5%A4%84%E7%90%86%E6%9C%BA%E5%88%B6"><span class="toc-number">5.3.</span> <span class="toc-text">插槽 slot 处理机制</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9D%99%E6%80%81%E7%BB%84%E4%BB%B6"><span class="toc-number">5.4.</span> <span class="toc-text">静态组件</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#React-%E4%B8%AD%E7%9A%84%E4%BA%8B%E4%BB%B6"><span class="toc-number">6.</span> <span class="toc-text">React 中的事件</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#React-%E4%B8%AD%E7%9A%84-state"><span class="toc-number">7.</span> <span class="toc-text">React 中的 state</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#state-%E7%9A%84%E6%B3%A8%E6%84%8F"><span class="toc-number">8.</span> <span class="toc-text">state 的注意</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#React-%E4%B8%AD%E7%9A%84%E5%8F%8C%E5%90%91%E6%95%B0%E6%8D%AE%E7%BB%91%E5%AE%9A"><span class="toc-number">9.</span> <span class="toc-text">React 中的双向数据绑定</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#React-%E4%B8%AD%E7%9A%84-portal"><span class="toc-number">10.</span> <span class="toc-text">React 中的 portal</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#React-%E4%B8%AD%E7%9A%84CSS-Module"><span class="toc-number">11.</span> <span class="toc-text">React 中的CSS-Module</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#React-Fragment"><span class="toc-number">12.</span> <span class="toc-text">React.Fragment</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#React-%E4%B8%AD%E7%9A%84-Context"><span class="toc-number">13.</span> <span class="toc-text">React 中的 Context</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#React-%E4%B8%AD%E7%9A%84-Effect"><span class="toc-number">14.</span> <span class="toc-text">React 中的 Effect</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Effect"><span class="toc-number">14.1.</span> <span class="toc-text">Effect</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#React-StrictMode"><span class="toc-number">14.2.</span> <span class="toc-text">React.StrictMode</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#setState-%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B"><span class="toc-number">14.3.</span> <span class="toc-text">setState 执行流程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-useEffect"><span class="toc-number">14.4.</span> <span class="toc-text">使用 useEffect</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Effect-%E5%87%BD%E6%95%B0%E7%9A%84%E8%BF%94%E5%9B%9E"><span class="toc-number">14.5.</span> <span class="toc-text">Effect 函数的返回</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#React-%E4%B8%AD%E7%9A%84-Reducer"><span class="toc-number">15.</span> <span class="toc-text">React 中的 Reducer</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#React-%E4%B8%AD%E7%9A%84-memo"><span class="toc-number">16.</span> <span class="toc-text">React 中的 memo</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#React-%E4%B8%AD%E7%9A%84-useCallback"><span class="toc-number">17.</span> <span class="toc-text">React 中的 useCallback</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#React-%E4%B8%AD%E7%9A%84-Hooks"><span class="toc-number">18.</span> <span class="toc-text">React 中的 Hooks</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Redux"><span class="toc-number">19.</span> <span class="toc-text">Redux</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%8A%B6%E6%80%81-State"><span class="toc-number">19.1.</span> <span class="toc-text">状态(State)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%B9%E5%99%A8-Container"><span class="toc-number">19.2.</span> <span class="toc-text">容器(Container)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%AF%E9%A2%84%E6%B5%8B%EF%BC%88Predictable%EF%BC%89"><span class="toc-number">19.3.</span> <span class="toc-text">可预测（Predictable）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8"><span class="toc-number">19.4.</span> <span class="toc-text">使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9C%A8%E7%BD%91%E9%A1%B5%E4%B8%AD%E4%BD%BF%E7%94%A8"><span class="toc-number">19.5.</span> <span class="toc-text">在网页中使用</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#RTX-Redux-Toolkit-%E5%B7%A5%E5%85%B7%E5%8C%85"><span class="toc-number">20.</span> <span class="toc-text">**RTX(Redux Toolkit)**工具包</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#RTX-%E5%85%B7%E4%BD%93%E4%BD%BF%E7%94%A8%E6%A1%88%E4%BE%8B"><span class="toc-number">20.1.</span> <span class="toc-text">RTX 具体使用案例</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8B%86%E5%88%86-RTX"><span class="toc-number">20.2.</span> <span class="toc-text">拆分 RTX</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#RTXQ-%E4%BD%BF%E7%94%A8"><span class="toc-number">21.</span> <span class="toc-text">RTXQ 使用</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#React-%E4%B8%AD%E7%9A%84-router"><span class="toc-number">22.</span> <span class="toc-text">React 中的 router</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%B3%E4%BA%8E-React-%E4%B8%AD%E7%9A%84-hook"><span class="toc-number">23.</span> <span class="toc-text">关于 React 中的 hook</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#React-%E4%B8%AD%E8%87%AA%E5%B8%A6%E7%9A%84%E9%92%A9%E5%AD%90%E5%87%BD%E6%95%B0"><span class="toc-number">23.1.</span> <span class="toc-text">React 中自带的钩子函数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#useMemo"><span class="toc-number">23.1.1.</span> <span class="toc-text">useMemo</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#UseImperativeHandle"><span class="toc-number">23.2.</span> <span class="toc-text">UseImperativeHandle</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#UseLayoutEffect"><span class="toc-number">23.3.</span> <span class="toc-text">UseLayoutEffect</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#UseDebugValue"><span class="toc-number">23.4.</span> <span class="toc-text">UseDebugValue</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#UseDeferredValue"><span class="toc-number">23.5.</span> <span class="toc-text">UseDeferredValue</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#UseTransition"><span class="toc-number">23.6.</span> <span class="toc-text">UseTransition</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#UseId"><span class="toc-number">23.7.</span> <span class="toc-text">UseId</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/262c4a52.html" title="前端工程化配置，工程能力学习"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://blog-1301952160.cos.ap-shanghai.myqcloud.com/Apprehensive/postCover/1722687861605.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="前端工程化配置，工程能力学习"></a><div class="content"><a class="title" href="/posts/262c4a52.html" title="前端工程化配置，工程能力学习">前端工程化配置，工程能力学习</a><time datetime="2024-08-09T01:07:53.000Z" title="发表于 2024-08-09 01:07:53">2024-08-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/f576a3fe.html" title="记录第一次字节实习offer"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://blog-1301952160.cos.ap-shanghai.myqcloud.com/Apprehensive/postCover/8c52b9660688cedcc40580545cef9ba4.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="记录第一次字节实习offer"></a><div class="content"><a class="title" href="/posts/f576a3fe.html" title="记录第一次字节实习offer">记录第一次字节实习offer</a><time datetime="2024-07-26T22:56:41.000Z" title="发表于 2024-07-26 22:56:41">2024-07-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/8f49bd54.html" title="前端技术探索"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://blog-1301952160.cos.ap-shanghai.myqcloud.com/Apprehensive/postCover/1719120534005.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="前端技术探索"></a><div class="content"><a class="title" href="/posts/8f49bd54.html" title="前端技术探索">前端技术探索</a><time datetime="2024-06-23T13:26:24.000Z" title="发表于 2024-06-23 13:26:24">2024-06-23</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/ac8590ca.html" title="go 语言速成"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://blog-1301952160.cos.ap-shanghai.myqcloud.com/Apprehensive/postCover/5370198c46b7e6193aad423d755464fd5aa83820_raw.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="go 语言速成"></a><div class="content"><a class="title" href="/posts/ac8590ca.html" title="go 语言速成">go 语言速成</a><time datetime="2024-01-16T13:38:42.000Z" title="发表于 2024-01-16 13:38:42">2024-01-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/9c0aba3e.html" title="leetcode 刷题(每日一题) 记录"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://blog-1301952160.cos.ap-shanghai.myqcloud.com/Apprehensive/wallpaper/1703262863447.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="leetcode 刷题(每日一题) 记录"></a><div class="content"><a class="title" href="/posts/9c0aba3e.html" title="leetcode 刷题(每日一题) 记录">leetcode 刷题(每日一题) 记录</a><time datetime="2023-12-27T10:47:16.000Z" title="发表于 2023-12-27 10:47:16">2023-12-27</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div id="footer_deal"><a class="deal_link" target="_blank" rel="noopener" href="https://github.com/apprehen" title="email"><i class="anzhiyufont anzhiyu-icon-envelope"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://github.com/apprehen" title="微博"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://github.com/apprehen" title="facebook"><i class="anzhiyufont anzhiyu-icon-facebook1"></i></a><a class="deal_link" href="/atom.xml" title="RSS"><i class="anzhiyufont anzhiyu-icon-rss"></i></a><img class="footer_mini_logo" title="返回顶部" alt="返回顶部" onclick="anzhiyu.scrollToDest(0,500)" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/yueyun.jpg" size="50px"><a class="deal_link" target="_blank" rel="noopener" href="https://github.com/apprehen" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://github.com/apprehen" title="Bilibili"><i class="anzhiyufont anzhiyu-icon-bilibili"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://github.com/apprehen" title="抖音"><i class="anzhiyufont anzhiyu-icon-tiktok"></i></a><a class="deal_link" href="/copyright" title="CC"><i class="anzhiyufont anzhiyu-icon-copyright-line"></i></a></div><div class="copyright">&copy;2023 - 2024 By 月晕</div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">24</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">33</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">14</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://blog.anheyu.com/" title="博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="博客"><span class="back-menu-item-text">博客</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://image.anheyu.com/" title="安知鱼图床"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.anheyu.com/favicon.ico" alt="安知鱼图床"><span class="back-menu-item-text">安知鱼图床</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size:.9em"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size:.9em"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size:.9em"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>留言</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size:.9em"></i><span> 友人帐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size:.9em"></i><span> 留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size:.9em"></i><span> 音乐馆</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size:.9em"></i><span> 相册集</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size:.9em"></i><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/resume/"><i class="anzhiyufont anzhiyu-icon-book faa-tada" style="font-size:.9em"></i><span> 简历</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size:.9em"></i><span> 随便逛逛</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/Clash/" style="font-size:.88rem">Clash<sup>1</sup></a><a href="/tags/Git/" style="font-size:.88rem">Git<sup>1</sup></a><a href="/tags/JavaScript/" style="font-size:.88rem">JavaScript<sup>10</sup></a><a href="/tags/Linux/" style="font-size:.88rem">Linux<sup>2</sup></a><a href="/tags/NestJS/" style="font-size:.88rem">NestJS<sup>1</sup></a><a href="/tags/Nginx/" style="font-size:.88rem">Nginx<sup>1</sup></a><a href="/tags/PM2/" style="font-size:.88rem">PM2<sup>1</sup></a><a href="/tags/Python/" style="font-size:.88rem">Python<sup>1</sup></a><a href="/tags/React/" style="font-size:.88rem">React<sup>4</sup></a><a href="/tags/React-Native/" style="font-size:.88rem">React Native<sup>1</sup></a><a href="/tags/TypeScript/" style="font-size:.88rem">TypeScript<sup>2</sup></a><a href="/tags/Vite/" style="font-size:.88rem">Vite<sup>1</sup></a><a href="/tags/Vue/" style="font-size:.88rem">Vue<sup>2</sup></a><a href="/tags/go/" style="font-size:.88rem">go<sup>1</sup></a><a href="/tags/leetcode/" style="font-size:.88rem">leetcode<sup>1</sup></a><a href="/tags/%E4%BB%A3%E7%90%86/" style="font-size:.88rem">代理<sup>1</sup></a><a href="/tags/%E5%89%8D%E7%AB%AF/" style="font-size:.88rem;font-weight:500;color:var(--anzhiyu-lighttext)">前端<sup>13</sup></a><a href="/tags/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6/" style="font-size:.88rem">前端框架<sup>2</sup></a><a href="/tags/%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86/" style="font-size:.88rem">反向代理<sup>1</sup></a><a href="/tags/%E5%90%8E%E7%AB%AF/" style="font-size:.88rem">后端<sup>2</sup></a><a href="/tags/%E5%B7%A5%E7%A8%8B%E5%8C%96/" style="font-size:.88rem">工程化<sup>1</sup></a><a href="/tags/%E6%89%93%E5%8C%85%E5%B7%A5%E5%85%B7/" style="font-size:.88rem">打包工具<sup>1</sup></a><a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" style="font-size:.88rem">数据结构<sup>2</sup></a><a href="/tags/%E6%B5%8F%E8%A7%88%E5%99%A8%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86/" style="font-size:.88rem">浏览器工作原理<sup>1</sup></a><a href="/tags/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/" style="font-size:.88rem">源码分析<sup>2</sup></a><a href="/tags/%E7%88%AC%E8%99%AB/" style="font-size:.88rem">爬虫<sup>1</sup></a><a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size:.88rem">算法<sup>2</sup></a><a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA/" style="font-size:.88rem">计算机<sup>1</sup></a><a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/" style="font-size:.88rem;font-weight:500;color:var(--anzhiyu-lighttext)">计算机基础<sup>3</sup></a><a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" style="font-size:.88rem">计算机操作系统<sup>1</sup></a><a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" style="font-size:.88rem">计算机网络<sup>1</sup></a><a href="/tags/%E9%9D%A2%E8%AF%95/" style="font-size:.88rem">面试<sup>1</sup></a><a href="/tags/%E9%9D%A2%E8%AF%95%E9%A2%98/" style="font-size:.88rem">面试题<sup>1</sup></a></div></div><hr></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="anzhiyufont anzhiyu-icon-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="8152976493" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random"></meting-js></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="anzhiyufont anzhiyu-icon-xmark"></i></button></nav><div class="is-center" id="loading-database"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-pulse-icon"></i><span> 数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"></div></div><hr><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size:1rem"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/8802438608&quot;, &quot;_blank&quot;);" style="display:none"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.20/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.4/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script async src="/anzhiyu/random.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>(() => {
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'https://chat.yueyun.site',
      region: 'ap-hangzhou',
      onCommentLoaded: () => {
        anzhiyu.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') setTimeout(runFn,0)
    else getScript('https://cdn.cbd.int/twikoo@1.6.21/dist/twikoo.all.min.js').then(runFn)
  }

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://chat.yueyun.site',
      region: 'ap-hangzhou',
      urls: [window.location.pathname],
      includeReply: false
    }).then(res => {
      countELement.textContent = res[0].count
    }).catch(err => {
      console.error(err)
    })
  }

  const runFn = () => {
    init();
    GLOBAL_CONFIG_SITE.isPost && getCount()
  }

  if ('Twikoo' === 'Twikoo' || !false) {
    if (false) anzhiyu.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else {
      loadTwikoo()
    }
  } else {
    window.loadOtherComment = loadTwikoo
  }
})()</script><input type="hidden" name="page-type" id="page-type" value="post"></div><script async data-pjax src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.1/bubble/bubble.js"></script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload='this.media="all"'><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["meta[property=\"og:image\"]","meta[property=\"og:title\"]","meta[property=\"og:url\"]","meta[property=\"og:type\"]","meta[property=\"og:site_name\"]","meta[property=\"og:description\"]","head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: true,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', 'G-W3DLGJMJDY', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({pluginModelPath:"assets/",model:{jsonPath:"/live2dw/assets/unitychan.model.json"},display:{position:"left",width:150,height:300},mobile:{show:!1},log:!1,pluginJsPath:"lib/",pluginRootPath:"live2dw/",tagMode:!1})</script></body></html>