<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><title>前端工程化配置，工程能力学习 | 月晕</title><meta name="keywords" content="工程化,vite,webpack,rollup,CI/CD,前端,计算机"><meta name="author" content="月晕"><meta name="copyright" content="月晕"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="前端工程化配置，工程能力学习"><meta name="application-name" content="前端工程化配置，工程能力学习"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="前端工程化配置，工程能力学习"><meta property="og:url" content="https://blog.yueyun.site/posts/262c4a52.html"><meta property="og:site_name" content="月晕"><meta property="og:description" content="算法经典题的一些题解"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://blog-1301952160.cos.ap-shanghai.myqcloud.com/Apprehensive/postCover/1722687861605.jpg"><meta property="article:author" content="月晕"><meta property="article:tag" content="JS,前端,前端开发,TS,TypeScript,Node,Node.js,Nodejs,Node,后端"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://blog-1301952160.cos.ap-shanghai.myqcloud.com/Apprehensive/postCover/1722687861605.jpg"><meta name="description" content="算法经典题的一些题解"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="https://blog.yueyun.site/posts/262c4a52"><link rel="preconnect" href="//cdn.cbd.int"><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""><meta name="google-site-verification" content="QmqYgcPLCjEZmEbdJVKduTaxnvd3OFJRyp3BLB2f0VQ"><meta name="baidu-site-verification" content="codeva-XPqAkKFOID"><meta name="msvalidate.01" content="xxx"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.20/dist/fancybox/fancybox.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/swiper/swiper.min.css" media="print" onload='this.media="all"'><script async src="https://www.googletagmanager.com/gtag/js?id=G-W3DLGJMJDY"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-W3DLGJMJDY")</script><script>const GLOBAL_CONFIG = {
  linkPageTop: undefined,
  peoplecanvas: undefined,
  postHeadAiDescription: undefined,
  diytitle: {"enable":true,"leaveTitle":"T^T","backTitle":"Ciallo~"},
  LA51: {"enable":true,"ck":"3GbfdCFGvNdWoQg1","LingQueMonitorID":"3GbfdCFGvNdWoQg1"},
  greetingBox: {"enable":true,"default":"晚上好👋","list":[{"greeting":"晚安😴","startTime":0,"endTime":5},{"greeting":"早上好鸭👋, 祝你一天好心情！","startTime":6,"endTime":9},{"greeting":"上午好👋, 状态很好，鼓励一下～","startTime":10,"endTime":10},{"greeting":"11点多啦, 在坚持一下就吃饭啦～","startTime":11,"endTime":11},{"greeting":"午安👋, 宝贝","startTime":12,"endTime":14},{"greeting":"🌈充实的一天辛苦啦！","startTime":14,"endTime":18},{"greeting":"19点喽, 奖励一顿丰盛的大餐吧🍔。","startTime":19,"endTime":19},{"greeting":"晚上好👋, 在属于自己的时间好好放松😌~","startTime":20,"endTime":24}]},
  twikooEnvId: 'https://chat.yueyun.site',
  commentBarrageConfig:undefined,
  root: '/',
  preloader: {"source":3},
  friends_vue_info: undefined,
  navMusic: true,
  mainTone: undefined,
  authorStatus: {"skills":["🖥️ JavaScript爱好者","🔍 前沿技术追随者","🩵 吃饭睡觉看动漫","🔨 前端后端一把梭","🤓 玉玉郁郁第一名","🧟 间歇性发奋图强","😵 持续性混吃等死","🥰 欢迎找我来聊天"]},
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    simplehomepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"copy":true,"copyrightEbable":false,"limitCount":50,"languages":{"author":"作者: 月晕","link":"链接: ","source":"来源: 月晕","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。","copySuccess":"复制成功，复制和转载请标注本文地址"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#425AEF","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={configTitle:"月晕",title:"前端工程化配置，工程能力学习",postAI:"",pageFillDescription:"工程治理, 工程管理, GIT, ssh key config, GIT 版本管理中的指令操作, 依赖管理, npm, yarn, pnpm, monorepo, 代码规范, TypeScript 代码规范, 命名, 语言特性, 字符串, 枚举, 函数, 接口和类, 类型断言和非空断言, 注释指令, 类型系统, 文件结构, React 代码规范, 命名, 代码格式化, 特性, 组件, Eslint, Prettier, Husky, 编译构建, 编译构建工具, Webpack, 基本概念, 基本术语介绍, 编译过程, 编译的开始, compiler 的创建过程, WebpackOptionsApply(), Compiler.run, 调用 compiler.compile(), 添加 Entry, 添加到 Module Tree, Rollup, Vite, babel, 其它工具, 编译规范, JS 模块化, CSS 模块化, CIx2FCD 流水工程治理工程管理是一种加密网络传输协议用于在不安全的网络环境中提供安全的方式来访问网络服务协议主要是用来远程登录管理系统安全传输文件等在数据传输的过程中采用加密保证数据的安全性和完整性协议通信的基本流程版本协商阶段服务器监听端口信息客户端发送连接建立请求服务端返回一个信息给客户端判断密钥和算法协商阶段客户端认证会话请求交互会话客户端实现的替代方案传输文件服务端的视线产生或密钥用来认证帮助用户不需要每次输入密钥或密码的工具收集大量主机的主机公钥参数提供一个注释提供生成的密钥类型指定要生成的密钥长度生成密钥文件名中配置的步骤生成密钥对在目录下面在或者上面去增加去配置公钥即可完成配对测试连接版本管理中的指令操作详细的查看我的另一篇博客使用操作依赖管理嵌套的结构早期是采用嵌套的结构会将依赖直接平铺在文件夹下子依赖会直接嵌套在下面如下如果此时模块也依赖与则会在添加一次在真实的开发下会导致臃肿不堪依赖地狱扁平化结构为了将嵌套的依赖尽量打平避免过深的依赖树和包冗余将子依赖提升采用扁平化的结构子依赖会尽量平铺安装在主依赖所在的目录中将依赖提升至相同的层级不同版本则单独安装这样既不会导致大量包的安装也可以解决依赖地狱的问题但是其中也存在很多问题幽灵依赖幽灵依赖是指在中未定义的依赖但是依然可以正常的被引入使用就比如我们只依赖但是中依赖了被提升到了相同的层级依然可以使用如果某天中改版不依赖了那么使用到的地方可能导致报错被依赖不确定性不确定性指的是同样的文件依赖后可能会得到不同样的目录结构比如依赖但是依赖那么后提升目录的是还是取决于用户安装的顺序很可能导致生产环境和开发环境不一样依赖分身假设此时的情况是和依赖和依赖下面是提升的情况这样会安装两次无论提升那个都会导致被安装两此且引入的不是相同的这样可能对做一些缓存和副作用的时候会导致出错提升安装速度中安装依赖时安装任务是串行的会按顺序包逐个下载为了解决安装速度问题采用了并行安装且存在缓存机制存在磁盘中引入引入文件记录依赖子依赖获取地址等一些关键的元信息即使不同的安装顺序相同的依赖关系在任何容器和环境中都能得到稳定的目录结构保证安装依赖的确定性依然没能解决幽灵依赖和依赖分身的问题定义为快速的节省磁盘空间的包管理工具建立了一套新的依赖管理机制内容寻址存储与依赖提升和扁平化的不同引入了另一套依赖管理策略内容寻址存储该策略会将包安装在全局的中依赖的每个版本只会在系统中安装一次在引用项目的依赖时会通过硬链接与符号链接在全局的中找到这个文件为了实现此过程下会多出目录而且是非扁平化结构硬链接硬链接可以理解为源文件的副本项目里安装的其实是副本它使得用户可以通过路径引用查找到源文件而且这个副本根本不占任何空间同时会在全局里存储硬链接不同的项目可以从全局寻找到同一个依赖大大地节省了磁盘空间符号链接也叫软连接可以理解为快捷方式可以通过它找到对应磁盘目录下的依赖地址这样的机制十分巧妙可以解决大部分问题了缺点在不支持软链的环境中无法使用比如因为依赖源是在中调试依赖修整依赖会有比较大的影响代码规范代码规范命名标识符必须只能使用字母数字下划线组成类枚举类型命名使用大写驼峰变量和函数命令使用小写驼峰全局常量使用枚举值命令使用大驼峰或名称中不要出现对应的类型标识和之类的比如等使用描述性名称名称应该是描述性和清晰的不要使用缩写或者删除单词中某些字母等的方式语言特性字符串使用和和和等现代方法数组禁止使用构造函数直接使用字面量或者方法建议使用方法来遍历数组更快更好的可读性和可以提前退出枚举所有的枚举成员必须是字面量不能是表达式之类的禁止枚举成员的值重复函数函数重载签名必须是连续的通过联合类型或可选剩余参数解决的函数不能使用函数重载禁止使用别名可以通过箭头函数去解决问题接口和类类成员禁止使用声明私有字段使用字段建议使用限制属性方法整个类型的可见性方便更清晰的代码结构可维护的设计默认情况是不用添加对私有的添加和接口和类声明使用来分隔单个成员声明内联对象等都使用来声明接口和对象中的方法必须使用属性签名而不是方法签名禁止在类中定义方法接口中声明方法类型断言和非空断言类型断言和非空断言是不安全的使用之后会让编译器静默不会插入任何运行时检查来匹配这些断言可能导致程序运行时崩溃因此没有必要不要使用使用判断和去完成替代上面的逻辑类型断言使用语法必须使用类型注释而不是类型断言来指定对象字面量的类型不要使用非空断言可以在中去启用选项禁止使用多余的非空断言禁止在可选链之后写非空断言禁止在空值运算合并的左侧操作数中使用非空断言注释指令禁止使用可以使用代替特殊情况下可以使用用注释指令抑制编译错误会掩盖背后更大的问题最佳实践是使用正确的代码类型但有些情况下也有无法解决的类型问题比如第三方依赖没有完备的类型声明或者错误的类型禁止类型始终为真或者始终为假的变量作为条件使用可选链式表达不要使用或者去替代类型系统禁止使用大写的内置对象作为类型某些内置对象用作类型时被认为是危险的或有害的通常的做法是禁止这些类型的使用以确保一致性和安全性能简单推断类型的代码禁止声明类型其余必须声明类型能推断出的类型是声明的代码初始化的字面量使用返回类型在导出函数和类的公共方法上必须定义返回和参数类型禁止使用字面量做为用户的类型为对象声明类型的时候必须使用而不是禁止使用可以采用更具体的类型抑制警告并记录原因禁止在泛型上使用无效的类型约束禁用声明冗余的类型禁止在泛型和返回类型之外使用类型文件结构禁止使用命名空间在文件中禁止在导入模块的时使用语句代码规范命名单文件的组件名应该使用或使用语法的文件扩展名应该是或者组件命名的方式应该采用组件名由多个单词组成代码格式化非函数式组件的创建采用禁止不必要的表达式禁止给没有子组件的组件添加额外的结束标签组件中的函数不应超过行遵循单一职责分离业务状态和显示特性禁止将注释作为文本节点插入禁止在中直接使用未转义的实体禁止出现定义了但未使用的状态禁止在组件内创建不稳定的组件单独开成一个组件引入不然每次渲染都会导致引用发生变化不必要的性能消耗在使用或等函数时应该提供正确的依赖项数组组件迭代使用组件的时候必须执行属性不要使用数组索引作为组件的禁止将子节点通过组件属性传递组件的属性值必须是一个对象编译构建编译构建工具基本概念是一个现代的应用程序的静态模块打包器通过分析目标结构找到模块以及其项目中一些高级的扩展语言将其转换和打包为合适的格式提供给浏览器使用即整个过程完成了内容转换资源合并两种功能基本术语介绍构建的起点指定从那个路径开始构建其内部依赖关系图可以存在多个入口指定命名和输入路径用于只能理解和文件帮组处理其他类型的文件并转换用于的拓展在流程中存在很多的能够执行更广泛的任务例如优化资源管理环境变量注入等环境用于不同的优化策略构建应用单元在中一切文件皆被视为一个模块从出发去递归构建一个包含所有依赖文件的模块网络代码的集合体由模块合并而成被用来优化输出文件的结构使得能够灵活的组织和分割代码是入口点的主要包含为入口指定的所有及其依赖是一个可能被延迟加载的使用动态导入或时可能出现编译过程初始化阶段初始化参数从配置文件配置对象参数中读取与默认配置结合得出最终的参数创建编译器对象用上一步得到的参数创建对象初始化编译环境包括注入内置插件注册各种模块工厂初始化集合加载配置的插件等开始编译执行对象的方法创建对象确定入口根据配置中的找出所有的入口文件调用将入口文件转换为对象构建阶段编译模块从文件开始调用将模块转译为标准内容调用解析器将内容转换为对象从中找出该模块依赖的模块在递归本步骤直到所有入口依赖的文件都经过本步骤的处理完成模块编译上一步递归处理所有能触达到的模块后得到了每个模块被翻译后的内容以及它们之间的依赖关系图生成阶段输出资源根据入口和模块之间的依赖关系组装成一个个包含多个模块的在把每个转换成一个单独的文件加入到输出列表写入文件系统在确定好输出内容后根据配置确定输出的路径和文件名把文件内容写入到文件系统编译的开始的执行入口在中定义编译器实例是否开启观察模式的标志观察模式的配置处理多重编译的逻辑核心创建和运行逻辑如果开启观察模式调用如果有回调函数但没有开启观察模式调用返回创建的编译器实例核心逻辑校验的参数调用方法创建对象返回其中的执行即开启了的编译过程的创建过程函数实现如下标准化配置参数归一化应用基本的配置默认创建实例把环境变量绑定到实例注册自定义插件并不会立马执行而是订阅相关的触发应用剩余的配置默认值触发环境设置相关的钩子核心方法把配置使用内置插件进行初始化处理核心流程调用对对进行规范化和默认值的操作初始化实例调用内置插件把环境变量绑到实例上遍历注册所有自定义的调用生命周期回调进行各种解析调用生命周期回调方法说明初始化已经执行完成返回实例现在了解一下方法其主要作用是解析配置数十个插件在该方法中完成注册在合适的时机运行插件注册运行解析配置注册插件进行处理注册插件进行初始化处理调用插件响应核心流程的写法注册内置插件用以解析配置同时传入实例对入口运行时等进行处理例如在执行之前做了充足的准备接下来才会进入编译阶段失败回调编译完成的回调检查是否应该输出结果处理完成后的逻辑处理资源输出其他处理逻辑真正开始编译的逻辑调用和钩子读取记录后开始编译整个函数实现触发了很多的比如等其中比较重要的就是函数调用对核心方法方法继续查看启动编译流程在编译之前调用的钩子触发编译开始的钩子创建一个新的编译实例完成模块构建完成编译过程的准备工作封闭编译记录准备输出文件编译完成后的钩子返回编译成功的回调钩子的执行顺序整个编译是编译前编译后其中比较最核心的就是和阶段其中在函数中首次实现了实例的创建和的区别的核心贯穿于整个构建周期封装了环境的全局配置包括但不限于配置信息输出路径等表示单次的构建过程及其产出与不同的是对象在每次构建中都是新创建的描述了构建的具体过程包括模块资源编译后的产出资源文件变化依赖关系状态每当文件变化触发重写构建时都会生成新的实例是一个长期存在的环境描述贯穿整个运行周期而是对单次构建的具体描述每一次构建过程都可能有所不同重点关注阶段但是我们并没有在中看到关键的函数执行即相关的逻辑应该是通过去触发的在全局中搜索去查看编译的逻辑通过查找我们发现它在中被实例化再搜索发现在中被引入很显然这个插件在之前就被注册好了添加看看中的完成了什么尝试获取或初始化入口数据添加入口依赖检查和合并选项这里简化为直接使用传入选项触发添加入口的钩子处理入口依赖的模块树这里简化异步处理逻辑入口添加成功可以了解到这里的工作就是在处理的添加过程中会调用根据代码依赖递归构建模块树添加到其它工具编译规范模块化模块化流水",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2024-08-27 15:25:57",postMainColor:""}</script><noscript><style type="text/css">#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-W3DLGJMJDY"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-W3DLGJMJDY")</script><meta name="generator" content="Hexo 7.0.0"></head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="/img/yueyun.jpg"><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"><script async src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><a id="site-name" href="/" accesskey="h"><div class="title">月晕</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size:.9em"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size:.9em"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size:.9em"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>留言</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size:.9em"></i><span> 友人帐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size:.9em"></i><span> 留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size:.9em"></i><span> 音乐馆</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size:.9em"></i><span> 相册集</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size:.9em"></i><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/resume/"><i class="anzhiyufont anzhiyu-icon-book faa-tada" style="font-size:.9em"></i><span> 简历</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size:.9em"></i><span> 随便逛逛</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><div class="nav-button" id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" title="搜索🔍" accesskey="s"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span> 搜索</span></a></div><div class="nav-change" id="nav-darkmode"><a class="darkmode_switchbutton" title="显示模式切换" onclick="darkmo" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><input id="center-console" type="checkbox"><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%89%8D%E7%AB%AF/" itemprop="url">前端</a></span><span class="article-meta tags"><a class="article-meta__tags" href="/tags/%E5%89%8D%E7%AB%AF/" tabindex="-1" itemprop="url"> <span><i class="anzhiyufont anzhiyu-icon-hashtag"></i>前端</span></a><a class="article-meta__tags" href="/tags/%E5%B7%A5%E7%A8%8B%E5%8C%96/" tabindex="-1" itemprop="url"> <span><i class="anzhiyufont anzhiyu-icon-hashtag"></i>工程化</span></a></span></div></div><h1 class="post-title" itemprop="name headline">前端工程化配置，工程能力学习</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="post-meta-icon anzhiyufont anzhiyu-icon-calendar-days"></i><span class="post-meta-label">发表于</span><time itemprop="dateCreated datePublished" datetime="2024-08-09T01:07:53.000Z" title="发表于 2024-08-09 01:07:53">2024-08-09</time></span></div><div class="meta-secondline"><span class="post-meta-separator"></span><span class="post-meta-wordcount"><i class="anzhiyufont anzhiyu-icon-file-word post-meta-icon" title="文章字数"></i><span class="post-meta-label" title="文章字数">字数总计:</span><span class="word-count" title="文章字数">5.4k</span><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-clock post-meta-icon" title="阅读时长"></i><span class="post-meta-label" title="阅读时长">阅读时长:</span><span>19分钟</span></span><span class="post-meta-separator"> </span><span class="post-meta-position" title="作者IP属地为杭州"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>杭州</span><span class="post-meta-separator"></span><span class="post-meta-commentcount"><i class="anzhiyufont anzhiyu-icon-comments post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/posts/262c4a52.html#post-comment" tabindex="-1"><span id="twikoo-count"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></a></span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src="https://blog-1301952160.cos.ap-shanghai.myqcloud.com/Apprehensive/postCover/1722687861605.jpg"></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container" itemscope itemtype="https://blog.yueyun.site/posts/262c4a52.html"><header><a class="post-meta-categories" href="/categories/%E5%89%8D%E7%AB%AF/" itemprop="url">前端</a><a href="/tags/%E5%89%8D%E7%AB%AF/" tabindex="-1" itemprop="url">前端</a><a href="/tags/%E5%B7%A5%E7%A8%8B%E5%8C%96/" tabindex="-1" itemprop="url">工程化</a><h1 id="CrawlerTitle" itemprop="name headline">前端工程化配置，工程能力学习</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">月晕</span><time itemprop="dateCreated datePublished" datetime="2024-08-09T01:07:53.000Z" title="undefined 2024-08-09 01:07:53">2024-08-09</time></header><h1 id="工程治理"><a href="#工程治理" class="headerlink" title="工程治理"></a>工程治理</h1><h2 id="工程管理"><a href="#工程管理" class="headerlink" title="工程管理"></a>工程管理</h2><h3 id="GIT"><a href="#GIT" class="headerlink" title="GIT"></a>GIT</h3><h4 id="ssh-key-config"><a href="#ssh-key-config" class="headerlink" title="ssh key config"></a><strong>ssh key config</strong></h4><p>ssh(secure shell)是一种加密网络传输协议，用于在不安全的网络环境中提供安全的方式来访问网络服务，SSH 协议主要是用来远程登录、管理系统、安全传输文件等，在数据传输的过程中采用加密保证数据的安全性和完整性</p><p>ssh 协议通信的基本流程：</p><ul><li>SSH 版本协商阶段：服务器监听 22 端口信息，客户端发送 TCP 连接，建立请求，服务端返回一个 SSH 信息给客户端判断</li><li>密钥和算法协商阶段</li><li>客户端认证</li><li>会话请求</li><li>交互会话</li></ul><blockquote><p>ssh：SSH 客户端实现 &amp; scp, sftp：rcp 的替代方案，传输文件 &amp; sshd：SSH 服务端的视线 &amp; ssh-keygen：产生 RSA 或 ECDSA 密钥，用来认证 &amp; ssh-agent, ssh-add：帮助用户不需要每次输入密钥或密码的工具 &amp; ssh-keysacn：收集大量主机的 ssh 主机公钥</p><p>Ssh-keygen 参数：-C (comment) - 提供一个注释 -t (type) - 提供生成的密钥类型 -b (bits) - 指定要生成的密钥长度 -f (filename) - 生成密钥文件名</p></blockquote><p>git 中配置 ssh 的步骤</p><p><code>ssh-keygen -t rsa -b 4096 -C &quot;your_email@example.com&quot;</code> 生成密钥对在<code>~/ssh</code>目录下面，在 github 或者 gitlab 上面去增加 ssh key 去配置公钥即可完成配对</p><p>测试 SSH 连接：<code>ssh -T git@github.com</code></p><h4 id="GIT-版本管理中的指令操作"><a href="#GIT-版本管理中的指令操作" class="headerlink" title="GIT 版本管理中的指令操作"></a>GIT 版本管理中的指令操作</h4><p>详细的查看我的另一篇博客</p><p><a href="https://blog.yueyun.site/posts/86f0144.html">git 使用操作</a></p><h3 id="依赖管理"><a href="#依赖管理" class="headerlink" title="依赖管理"></a>依赖管理</h3><h4 id="npm"><a href="#npm" class="headerlink" title="npm"></a>npm</h4><p><strong>嵌套的 node_modules 结构</strong>：</p><p>npm 早期是采用嵌套的 node_modules 结构，会将依赖直接平铺在 node_modules 文件夹下，子依赖会直接嵌套在 node_modules 下面如下</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">node<span class="built_in">_</span>modules</span><br><span class="line">├── A@1.0.0</span><br><span class="line">│   └── node<span class="built_in">_</span>modules</span><br><span class="line">│       └── B@1.0.0</span><br><span class="line">└── C@1.0.0</span><br><span class="line">    └── node<span class="built_in">_</span>modules</span><br><span class="line">        └── B@2.0.0</span><br></pre></td></tr></table></figure><p>如果此时 D 模块也依赖与 B 则会在添加一次，在真实的开发下会导致 node_modules 臃肿不堪，依赖地狱</p><p><strong>扁平化 node_modules 结构：</strong></p><p>为了将嵌套的依赖尽量打平，避免过深的依赖树和包冗余，npm v3 将子依赖提升(hoist)，采用扁平化的 node_modules 结构，子依赖会尽量平铺安装在主依赖所在的目录中</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">node<span class="built_in">_</span>modules</span><br><span class="line">├── A@1.0.0</span><br><span class="line">├── B@1.0.0</span><br><span class="line">└── C@1.0.0</span><br><span class="line">     └── node<span class="built_in">_</span>modules</span><br><span class="line">          └── B@2.0.0</span><br></pre></td></tr></table></figure><p>将 B 依赖提升至相同的层级，不同版本则单独安装，这样既不会导致大量包的安装，也可以解决依赖地狱的问题，但是其中也存在很多问题</p><p><strong>幽灵依赖 Phantom dependencies</strong></p><p>幽灵依赖是指在 package.json 中未定义的依赖，但是依然可以正常的被引入使用</p><p>就比如我们只依赖 A、C 但是 C 中依赖了 B，B 被提升到了相同的层级，依然可以使用，如果某天 C 中改版不依赖 B 了，那么使用到 B 的地方可能导致报错</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;dependencies&quot;: &#123;</span><br><span class="line">    &quot;A&quot;: &quot;^1.0.0&quot;,</span><br><span class="line">    “B”: &quot;被C依赖&quot;,</span><br><span class="line">    &quot;C&quot;: &quot;^1.0.0&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>不确定性 Non-Determinism</strong></p><p>不确定性指的是：同样的 pkg.json 文件，install 依赖后可能会得到不同样的 node_modules 目录结构</p><p>比如 A 依赖<a href="mailto:&#x42;&#64;&#x31;&#x2e;&#x30;&#x2e;&#x30;">&#x42;&#64;&#x31;&#x2e;&#x30;&#x2e;&#x30;</a>，但是 C 依赖<a href="mailto:&#66;&#x40;&#x32;&#x2e;&#48;&#46;&#x30;">&#66;&#x40;&#x32;&#x2e;&#48;&#46;&#x30;</a> ，那么 install 后提升目录的是<a href="mailto:&#x42;&#x40;&#x31;&#46;&#x30;&#x2e;&#48;">&#x42;&#x40;&#x31;&#46;&#x30;&#x2e;&#48;</a>还是@B2.0.0？ 取决于用户安装的顺序，很可能导致生产环境和开发环境不一样</p><p><strong>依赖分身 doppelgangers</strong></p><p>假设此时的情况是：A 和 D 依赖<a href="mailto:&#66;&#64;&#49;&#46;&#48;">&#66;&#64;&#49;&#46;&#48;</a> ，C 和 E 依赖<a href="mailto:&#66;&#x40;&#50;&#46;&#x30;">&#66;&#x40;&#50;&#46;&#x30;</a></p><p>下面是提升<a href="mailto:&#66;&#x40;&#x31;&#46;&#48;">&#66;&#x40;&#x31;&#46;&#48;</a>的情况</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">node<span class="built_in">_</span>modules</span><br><span class="line">├── A@1.0.0</span><br><span class="line">├── B@1.0.0</span><br><span class="line">├── D@1.0.0</span><br><span class="line">├── C@1.0.0</span><br><span class="line">│    └── node<span class="built_in">_</span>modules</span><br><span class="line">│         └── B@2.0.0</span><br><span class="line">└── E@1.0.0</span><br><span class="line">      └── node<span class="built_in">_</span>modules</span><br><span class="line">           └── B@2.0.0</span><br></pre></td></tr></table></figure><p>这样 B 会安装两次，无论提升那个都会导致被安装两此，且引入的 B 不是相同的 B，这样可能对 B 做一些缓存和副作用的时候，会导致出错</p><h4 id="yarn"><a href="#yarn" class="headerlink" title="yarn"></a>yarn</h4><p><strong>提升安装速度</strong></p><p>npm 中安装依赖时，安装任务是串行的，会按顺序包逐个下载，为了解决安装速度问题，yarn 采用了并行安装，且存在缓存机制，存在磁盘中</p><p><strong>lockfile 引入</strong></p><p>引入 yarn.lock 文件，记录依赖，子依赖，获取地址等一些关键的元信息，即使不同的安装顺序，相同的依赖关系在任何容器和环境中，都能得到稳定的 node_modules 目录结构，保证安装依赖的确定性</p><p>依然没能解决<strong>幽灵依赖</strong>和<strong>依赖分身</strong>的问题</p><h4 id="pnpm"><a href="#pnpm" class="headerlink" title="pnpm"></a>pnpm</h4><p>定义为快速的、节省磁盘空间的包管理工具，建立了一套新的依赖管理机制</p><p><strong>内容寻址存储 CAS</strong></p><p>与依赖提升和扁平化的 node_modules 不同，pnpm 引入了另一套依赖管理策略：内容寻址存储</p><p>该策略会将包安装在全局的 store 中，依赖的每个版本只会在系统中安装一次</p><p>在引用项目 node_modules 的依赖时，会通过硬链接与符号链接在全局的 store 中找到这个文件，为了实现此过程，node_modules 下会多出 <code>.pnpm</code> 目录，而且是非扁平化结构。</p><ul><li><strong>硬链接 Hard Link：</strong> 硬链接可以理解为<strong>源文件的副本，</strong>项目里安装的其实是副本，它使得用户可以通过路径引用查找到源文件<strong>，</strong>而且这个副本根本不占任何空间。同时，pnpm 会在全局 store 里存储硬链接，不同的项目可以从全局 store 寻找到同一个依赖，大大地节省了磁盘空间</li><li><strong>符号链接</strong> <strong>Symbolic link</strong> ：也叫软连接，可以理解为快捷方式，pnpm 可以通过它找到对应磁盘目录下的依赖地址。</li></ul><p>这样的机制十分巧妙可以解决大部分问题了</p><p>缺点：在不支持软链的环境中无法使用，比如 Electron，因为依赖源是在 store 中，调试依赖，修整依赖会有比较大的影响</p><h3 id="monorepo"><a href="#monorepo" class="headerlink" title="monorepo"></a>monorepo</h3><h2 id="代码规范"><a href="#代码规范" class="headerlink" title="代码规范"></a>代码规范</h2><h3 id="TypeScript-代码规范"><a href="#TypeScript-代码规范" class="headerlink" title="TypeScript 代码规范"></a>TypeScript 代码规范</h3><h4 id="命名"><a href="#命名" class="headerlink" title="命名"></a>命名</h4><ul><li>标识符必须只能使用 ASCII 字母、数字、下划线组成</li><li>类、枚举、类型命名使用大写驼峰(UpperCamelCase)</li><li>变量和函数命令使用小写驼峰(lowerCamelCase)</li><li>全局常量使用<code>CONSTANT_CASE</code></li><li>枚举值命令使用大驼峰或<code>CONSTANT_CASE</code></li><li>名称中不要出现对应的类型标识和 my 之类的(比如 nameString myType … 等)</li><li>使用描述性名称，名称应该是描述性和清晰的，不要使用缩写或者删除单词中某些字母等的方式</li></ul><h4 id="语言特性"><a href="#语言特性" class="headerlink" title="语言特性"></a>语言特性</h4><h5 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h5><ul><li>使用<code>String#startWith</code>和<code>String#endWith</code>和<code>includes</code>和<code>slice</code>等现代方法</li></ul><p><strong>数组</strong></p><ul><li>禁止使用 Array()构造函数，直接使用字面量或者<code>Array.from</code>方法</li><li>建议使用<code>for....of</code>方法来遍历数组，更快，更好的可读性，<code>break</code>和<code>return</code>可以提前退出</li></ul><h5 id="枚举"><a href="#枚举" class="headerlink" title="枚举"></a><strong>枚举</strong></h5><ul><li>所有的枚举成员必须是字面量，不能是表达式之类的</li><li>禁止枚举成员的值重复</li></ul><h5 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h5><ul><li>函数重载签名必须是连续的</li><li>通过联合类型或可选&#x2F;剩余参数解决的函数不能使用函数重载</li><li>禁止使用 this 别名，可以通过箭头函数去解决问题</li></ul><h5 id="接口和类"><a href="#接口和类" class="headerlink" title="接口和类"></a>接口和类</h5><ul><li><strong>类成员：</strong>禁止使用<code>#</code>声明私有字段，使用<code>private</code>字段, 建议使用<code>readonly</code>，限制属性，方法，整个类型的可见性，方便更清晰的代码结构，可维护的设计，默认情况是<code>public</code>不用添加，对私有的添加<code>private</code>和<code>protected</code></li><li>接口和类声明使用 <strong>;</strong> 来分隔，单个成员声明，内联对象等都使用 **;**来声明</li><li>接口和对象中的方法必须使用属性签名而不是方法签名</li><li>禁止在类中定义 new 方法，接口中声明 constructor 方法</li></ul><h5 id="类型断言和非空断言"><a href="#类型断言和非空断言" class="headerlink" title="类型断言和非空断言"></a><strong>类型断言和非空断言</strong></h5><p>类型断言和非空断言是不安全的，使用之后会让 TypeScript 编译器静默，不会插入任何运行时检查来匹配这些断言，可能导致程序运行时崩溃，因此没有必要不要使用，使用判断和 instanceof 去完成替代上面的逻辑</p><ul><li><p>类型断言使用<code>as</code>语法</p></li><li><p>必须使用类型注释而不是类型断言来指定对象字面量的类型</p></li><li><p>不要使用非空断言</p><blockquote><p>可以在<code>tsconfig</code>中去启用<code>strictNullChecks</code>选项</p></blockquote></li><li><p>禁止使用多余的非空断言</p></li><li><p>禁止在可选链之后写非空断言</p></li><li><p>禁止在空值运算合并的左侧操作数中使用非空断言</p></li></ul><h5 id="注释指令"><a href="#注释指令" class="headerlink" title="注释指令"></a><strong>注释指令</strong></h5><ul><li><p>禁止使用 _<code>@ts-ignore</code><strong>、</strong><code>@ts-nocheck</code><strong>、</strong><code>@ts-check</code>_，可以使用 <code>@ts-expect-error</code> 代替</p></li><li><p>特殊情况下可以使用 <code>@ts-expect-error</code>，用注释指令抑制编译错误，会掩盖背后更大的问题。最佳实践是使用正确的代码类型。</p><p>但有些情况下，也有无法解决的类型问题，比如第三方依赖没有完备的类型声明或者错误的类型。</p></li></ul><p>禁止类型始终为真或者始终为假的变量作为条件</p><p>使用可选链式表达，不要使用&amp;&amp; 或者 || 去替代</p><h4 id="类型系统"><a href="#类型系统" class="headerlink" title="类型系统"></a>类型系统</h4><ul><li>禁止使用大写的内置对象作为类型：某些内置对象用作类型时被认为是危险的或有害的，通常的做法是禁止这些类型的使用以确保一致性和安全性</li><li>能简单推断类型的代码，禁止声明类型，其余必须声明类型：能推断出的类型是声明的代码初始化的<code>string</code>、<code>number</code>、<code>boolean</code>、<code>RegExp</code>字面量</li><li>使用返回类型</li><li>在导出函数和类的公共方法上必须定义返回和参数类型</li><li>禁止使用字面量做为用户的类型</li><li>为对象声明类型的时候必须使用<code>interface</code>而不是<code>type</code></li><li>禁止使用 any，可以采用更具体的类型，unknown，抑制 linter 警告并记录原因</li><li>禁止在泛型上使用无效的类型约束</li><li>禁用声明冗余的类型</li><li>禁止在泛型和返回类型之外使用 void 类型</li></ul><h4 id="文件结构"><a href="#文件结构" class="headerlink" title="文件结构"></a>文件结构</h4><ul><li>禁止使用命名空间<code>namespaces</code>在 ts 文件中</li><li>禁止在导入模块的时使用<strong>require</strong>语句</li></ul><h3 id="React-代码规范"><a href="#React-代码规范" class="headerlink" title="React 代码规范"></a>React 代码规范</h3><h4 id="命名-1"><a href="#命名-1" class="headerlink" title="命名"></a>命名</h4><ul><li>单文件的组件名应该使用<code>UpperCamelCase</code>或<code>kebab-case</code></li><li>使用 JSX 语法的文件扩展名应该是<code>.jsx</code>或者<code>.tsx</code></li><li>JSX 组件命名的方式应该采用<code>UpperCamelCase</code></li><li>JSX 组件名由多个单词组成</li></ul><h4 id="代码格式化"><a href="#代码格式化" class="headerlink" title="代码格式化"></a>代码格式化</h4><ul><li>非函数式组件的创建采用 ES6 class</li><li>禁止不必要的 JSX 表达式</li><li>禁止给没有子组件的组件添加额外的结束标签</li><li>JSX 组件中的函数不应超过 300 行：遵循单一职责，分离业务状态和 UI 显示</li></ul><h4 id="特性"><a href="#特性" class="headerlink" title="特性"></a>特性</h4><ul><li>禁止将注释作为文本节点插入</li><li>禁止在 JSX 中直接使用未转义的 HTML 实体</li><li>禁止出现定义了但未使用的状态</li><li>禁止在组件内创建不稳定的组件，单独开成一个组件引入，不然每次渲染都会导致引用发生变化，不必要的性能消耗</li><li>在使用 <code>useEffect</code>、<code>useMemo</code> 或 <code>useCallback</code> 等 Hook 函数时应该提供正确的依赖项数组</li></ul><h4 id="组件"><a href="#组件" class="headerlink" title="组件"></a>组件</h4><ul><li>迭代使用组件的时候必须执行 key 属性</li><li>不要使用数组索引作为组件的 <code>key</code></li><li>禁止将子节点通过组件 <code>children</code> 属性传递</li><li>组件的 <code>style</code> 属性值必须是一个对象</li></ul><h3 id="Eslint"><a href="#Eslint" class="headerlink" title="Eslint"></a>Eslint</h3><h3 id="Prettier"><a href="#Prettier" class="headerlink" title="Prettier"></a>Prettier</h3><h3 id="Husky"><a href="#Husky" class="headerlink" title="Husky"></a>Husky</h3><h1 id="编译构建"><a href="#编译构建" class="headerlink" title="编译构建"></a>编译构建</h1><h2 id="编译构建工具"><a href="#编译构建工具" class="headerlink" title="编译构建工具"></a>编译构建工具</h2><h3 id="Webpack"><a href="#Webpack" class="headerlink" title="Webpack"></a>Webpack</h3><h4 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h4><p>Webpack 是一个现代的 JavaScript 应用程序的静态模块打包器(module bundler)，通过分析目标结构，找到 JavaScript 模块以及其项目中一些高级的扩展语言(SCSS，TypeScript)，将其转换和打包为合适的格式提供给浏览器使用</p><p>即整个过程完成了<strong>内容转换</strong> + <strong>资源合并</strong> 两种功能</p><h4 id="基本术语介绍"><a href="#基本术语介绍" class="headerlink" title="基本术语介绍"></a>基本术语介绍</h4><ul><li><strong>Entry：</strong> 构建的起点指定从那个路径开始构建其内部依赖关系图，可以存在多个入口</li><li><strong>Output：</strong>指定 bundles 命名和输入路径</li><li><strong>Loaders：</strong>用于 Webpack 只能理解 JavaScript 和 JSON 文件，帮组 webpack 处理其他类型的文件并转换</li><li><strong>Plugin</strong>：用于 webpack 的拓展，在 webpack 流程中存在很多的 hooks，能够执行更广泛的任务，例如 bundle 优化，资源管理，环境变量注入等</li><li><strong>Mode：</strong>环境，用于不同的优化策略</li><li><strong>Module：</strong>构建应用单元，在 webpack 中，一切文件皆被视为一个模块，webpack 从 Entry 出发，去递归构建一个包含所有依赖文件的模块网络</li><li><strong>Chunk：</strong>代码的集合体，Chunk 由模块合并而成，被用来优化输出文件的结构，Chunk 使得 Webpack 能够灵活的组织和分割代码<ul><li>initial 是入口点的主要 chunk，包含为入口指定的所有 module 及其依赖</li><li>non-intial 是一个可能被延迟加载的 chunk，使用动态导入或 SplitChunksPlugin 时可能出现</li></ul></li></ul><h4 id="编译过程"><a href="#编译过程" class="headerlink" title="编译过程"></a>编译过程</h4><ul><li>初始化阶段<ul><li>初始化参数：从配置文件、配置对象、Shell 参数中读取，与默认配置结合得出最终的参数</li><li>创建编译器对象：用上一步得到的参数创建 Compiler 对象</li><li>初始化编译环境：包括注入内置插件、注册各种模块工厂、初始化 RuleSet 集合、加载配置的插件等</li><li>开始编译：执行 compiler 对象的 run 方法，创建 Complition 对象</li><li>确定入口：根据配置中的 entry 找出所有的入口文件，调用<code>compilition.addEntry</code>将入口文件转换为<code>dependence</code>对象</li></ul></li><li>构建阶段<ul><li>编译模块(make)：从<code>Entry</code>文件开始，调用<code>loader</code>将模块转译为标准 JS 内容，调用 JS 解析器将内容转换为 AST 对象，从中找出该模块依赖的模块，在递归本步骤直到所有入口依赖的文件都经过本步骤的处理</li><li>完成模块编译：上一步递归处理所有能触达到的模块后，得到了每个模块被翻译后的内容以及它们之间的依赖关系图</li></ul></li><li>生成阶段<ul><li>输出资源(seal)：根据入口和模块之间的依赖关系，组装成一个个包含多个模块的<code>Chunk</code>，在把每个<code>Chunk</code>转换成一个单独的文件加入到输出列表</li><li>写入文件系统(emitAssets)：在确定好输出内容后，根据配置确定输出的路径和文件名，把文件内容写入到文件系统</li></ul></li></ul><h4 id="编译的开始"><a href="#编译的开始" class="headerlink" title="编译的开始"></a>编译的开始</h4><p>Webpack 的执行入口在&#x2F;lib&#x2F;webpack.js 中</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">webpack</span> = (<span class="params">options, callback</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">create</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> compiler <span class="comment">// 定义编译器实例</span></span><br><span class="line">    <span class="keyword">let</span> watch = <span class="literal">false</span> <span class="comment">// 是否开启观察模式的标志</span></span><br><span class="line">    <span class="keyword">let</span> watchOptions <span class="comment">// 观察模式的配置</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="title class_">Array</span>.<span class="title function_">isArray</span>(options)) &#123;</span><br><span class="line">      <span class="comment">// 处理多重编译的逻辑</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> &#123; compiler, watch, watchOptions &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 核心创建和运行逻辑</span></span><br><span class="line">  <span class="keyword">const</span> &#123; compiler, watch, watchOptions &#125; = <span class="title function_">create</span>()</span><br><span class="line">  <span class="keyword">if</span> (watch) &#123;</span><br><span class="line">    <span class="comment">// 如果开启观察模式，调用 compiler.watch</span></span><br><span class="line">    compiler.<span class="title function_">watch</span>(watchOptions, callback)</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (callback) &#123;</span><br><span class="line">    <span class="comment">// 如果有回调函数，但没有开启观察模式，调用 compiler.run</span></span><br><span class="line">    compiler.<span class="title function_">run</span>(callback)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> compiler <span class="comment">// 返回创建的编译器实例</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>webpack.create() 核心逻辑：</p><ul><li>validateSchema 校验 webpack.config.js 的参数</li><li>调用 createCompiler(options)方法创建 compiler 对象</li><li>返回 compiler、watch、watchOptions</li></ul><p>其中，<code>compiler.run(callback)</code> 的执行即开启了 webpack 的编译过程</p><h4 id="compiler-的创建过程"><a href="#compiler-的创建过程" class="headerlink" title="compiler 的创建过程"></a>compiler 的创建过程</h4><p><code>createCompiler</code>函数实现如下</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">createCompiler</span> = (<span class="params">rawOptions, compilerIndex</span>) =&gt; &#123;</span><br><span class="line">  <span class="comment">// 标准化Webpack配置，参数归一化</span></span><br><span class="line">  <span class="keyword">const</span> options = <span class="title function_">getNormalizedWebpackOptions</span>(rawOptions)</span><br><span class="line">  <span class="comment">// 应用基本的webpack配置默认</span></span><br><span class="line">  <span class="title function_">applyWebpackOptionsBaseDefaults</span>(options)</span><br><span class="line">  <span class="comment">// 创建compiler实例</span></span><br><span class="line">  <span class="keyword">const</span> compiler = <span class="keyword">new</span> <span class="title class_">Compiler</span>(</span><br><span class="line">    <span class="comment">/** <span class="doctag">@type</span> &#123;<span class="type">string</span>&#125; */</span> (options.<span class="property">context</span>),</span><br><span class="line">    options</span><br><span class="line">  )</span><br><span class="line">  <span class="comment">// 把node环境变量绑定到compiler实例</span></span><br><span class="line">  <span class="keyword">new</span> <span class="title class_">NodeEnvironmentPlugin</span>(&#123;</span><br><span class="line">    <span class="attr">infrastructureLogging</span>: options.<span class="property">infrastructureLogging</span></span><br><span class="line">  &#125;).<span class="title function_">apply</span>(compiler)</span><br><span class="line">  <span class="comment">// 注册自定义插件（并不会立马执行，而是订阅相关 hooks 的触发）</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="title class_">Array</span>.<span class="title function_">isArray</span>(options.<span class="property">plugins</span>)) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> plugin <span class="keyword">of</span> options.<span class="property">plugins</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">typeof</span> plugin === <span class="string">&#x27;function&#x27;</span>) &#123;</span><br><span class="line">        <span class="comment">/** <span class="doctag">@type</span> &#123;<span class="type">WebpackPluginFunction</span>&#125; */</span></span><br><span class="line">        ;(plugin).<span class="title function_">call</span>(compiler, compiler)</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (plugin) &#123;</span><br><span class="line">        plugin.<span class="title function_">apply</span>(compiler)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 应用剩余的 webpack 配置默认值</span></span><br><span class="line">  <span class="keyword">const</span> resolvedDefaultOptions = <span class="title function_">applyWebpackOptionsDefaults</span>(</span><br><span class="line">    options,</span><br><span class="line">    compilerIndex</span><br><span class="line">  )</span><br><span class="line">  <span class="keyword">if</span> (resolvedDefaultOptions.<span class="property">platform</span>) &#123;</span><br><span class="line">    compiler.<span class="property">platform</span> = resolvedDefaultOptions.<span class="property">platform</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 触发环境设置相关的钩子</span></span><br><span class="line">  compiler.<span class="property">hooks</span>.<span class="property">environment</span>.<span class="title function_">call</span>()</span><br><span class="line">  compiler.<span class="property">hooks</span>.<span class="property">afterEnvironment</span>.<span class="title function_">call</span>()</span><br><span class="line">  <span class="comment">// 核心方法，把webpack配置使用内置插件plugin进行初始化处理</span></span><br><span class="line">  <span class="keyword">new</span> <span class="title class_">WebpackOptionsApply</span>().<span class="title function_">process</span>(options, compiler)</span><br><span class="line">  compiler.<span class="property">hooks</span>.<span class="property">initialize</span>.<span class="title function_">call</span>()</span><br><span class="line">  <span class="keyword">return</span> compiler</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>crateCompiler 核心流程：</p><ul><li>调用 getNormalizedWepackOptions + applyWebpackOptionsBaseDefaults 对 webpack.config.js 对 options 进行规范化和默认值的操作</li><li>new compiler() 初始化 compiler 实例</li><li>new NodeEnviromentPlugin 调用内置插件，把 node 环境变量绑到 compiler 实例上</li><li>遍历 options.plugins，注册所有自定义的 plugin</li><li>调用 enviroment，afterEnvironment 生命周期回调</li><li>new WebpackOptionsApply().process(options, compiler)，进行各种 options 解析</li><li>调用 initialize 生命周期回调方法，说明初始化已经执行完成</li><li>返回 compiler 实例</li></ul><h4 id="WebpackOptionsApply"><a href="#WebpackOptionsApply" class="headerlink" title="WebpackOptionsApply()"></a>WebpackOptionsApply()</h4><p>现在了解一下<code>WebpackOptionsApply().process(options, compiler)</code>方法，其主要作用是解析 Webpack.config.js 配置，数十个插件在该方法中完成注册，在合适的时机运行 plugin 插件，注册，运行</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">WebpackOptionsApply</span> <span class="keyword">extends</span> <span class="title class_ inherited__">OptionsApply</span> &#123;</span><br><span class="line">    ......</span><br><span class="line">    <span class="title function_">process</span>(<span class="params">options, compiler</span>) &#123;</span><br><span class="line">        ......</span><br><span class="line">        <span class="keyword">if</span> (options.<span class="property">externals</span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> <span class="title class_">ExternalsPlugin</span> = <span class="built_in">require</span>(<span class="string">&quot;./ExternalsPlugin&quot;</span>);</span><br><span class="line">            <span class="comment">// 解析options.xxx配置，注册插件进行处理</span></span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">ExternalsPlugin</span>(options.<span class="property">externalsType</span>, options.<span class="property">externals</span>).<span class="title function_">apply</span>(</span><br><span class="line">                compiler</span><br><span class="line">            );</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 注册插件进行初始化处理</span></span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">EntryOptionPlugin</span>().<span class="title function_">apply</span>(compiler);</span><br><span class="line">        <span class="comment">// hooks.&lt;hook name&gt;.call调用，plugin插件响应</span></span><br><span class="line">        compiler.<span class="property">hooks</span>.<span class="property">entryOption</span>.<span class="title function_">call</span>(options.<span class="property">context</span>, options.<span class="property">entry</span>);</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">RuntimePlugin</span>().<span class="title function_">apply</span>(compiler);</span><br><span class="line">        ......</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>WebpackOptionsApply() 核心流程：</p><ul><li><code>new xxxPlugin().apply(compiler)</code>的写法注册内置插件，用以解析 webpack.config.js 配置，同时传入 compiler 实例</li><li>对入口、运行时等进行处理，例如<code>new EntryOptionPlugin().apply(compiler)</code></li></ul><p>在执行<code>compiler.run()</code>之前，做了充足的准备，接下来才会进入编译阶段</p><h4 id="Compiler-run"><a href="#Compiler-run" class="headerlink" title="Compiler.run"></a>Compiler.run</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">run</span>(<span class="params">callback</span>) &#123;</span><br><span class="line"> 	  ......</span><br><span class="line">    <span class="comment">// 失败回调</span></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">finalCallback</span> = (<span class="params">err, stats</span>) =&gt; &#123;&#125;;</span><br><span class="line">    <span class="comment">// 编译完成的回调</span></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">onCompiled</span> = (<span class="params">err, _compilation</span>) =&gt; &#123;</span><br><span class="line">      <span class="keyword">const</span> compilation = _compilation;</span><br><span class="line">      <span class="comment">// 检查是否应该输出结果</span></span><br><span class="line">      <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">hooks</span>.<span class="property">shouldEmit</span>.<span class="title function_">call</span>(compilation) === <span class="literal">false</span>) &#123;</span><br><span class="line">        <span class="comment">// 处理完成后的逻辑...</span></span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      process.<span class="title function_">nextTick</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// 处理资源输出</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">emitAssets</span>(compilation, <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">          <span class="comment">// 其他处理逻辑...</span></span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 真正开始编译的逻辑</span></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">run</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">      <span class="comment">// 调用 beforeRun 和 run 钩子</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">hooks</span>.<span class="property">beforeRun</span>.<span class="title function_">callAsync</span>(<span class="variable language_">this</span>, <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">hooks</span>.<span class="property">run</span>.<span class="title function_">callAsync</span>(<span class="variable language_">this</span>, <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">          <span class="comment">// 读取记录后开始编译</span></span><br><span class="line">          <span class="variable language_">this</span>.<span class="title function_">readRecords</span>(<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">compile</span>(onCompiled);</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">idle</span>) &#123;</span><br><span class="line">        ......</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_">run</span>();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>整个函数实现，触发了很多的 hooks 比如 beforeRun、run、afterDone 等，其中比较重要的就是 this.compile(onCompiled)函数</p><h4 id="调用-compiler-compile"><a href="#调用-compiler-compile" class="headerlink" title="调用 compiler.compile()"></a>调用 compiler.compile()</h4><p>对核心方法<code>Compiler.compile(onCompiled)</code>方法继续查看</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 启动编译流程</span></span><br><span class="line"><span class="title function_">compile</span>(<span class="params">callback</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> params = <span class="variable language_">this</span>.<span class="title function_">newCompilationParams</span>();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 在编译之前调用的钩子</span></span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">hooks</span>.<span class="property">beforeCompile</span>.<span class="title function_">callAsync</span>(params, <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 触发编译开始的钩子</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">hooks</span>.<span class="property">compile</span>.<span class="title function_">call</span>(params);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 创建一个新的编译实例</span></span><br><span class="line">    <span class="keyword">const</span> compilation = <span class="variable language_">this</span>.<span class="title function_">newCompilation</span>(params);</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">hooks</span>.<span class="property">make</span>.<span class="title function_">callAsync</span>(compilation, <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// 完成模块构建</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">hooks</span>.<span class="property">finishMake</span>.<span class="title function_">callAsync</span>(compilation, <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">        process.<span class="title function_">nextTick</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">          <span class="comment">// 完成编译过程的准备工作</span></span><br><span class="line">          compilation.<span class="title function_">finish</span>(<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="comment">// 封闭编译记录，准备输出文件</span></span><br><span class="line">            compilation.<span class="title function_">seal</span>(<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">              <span class="comment">// 编译完成后的钩子</span></span><br><span class="line">              <span class="variable language_">this</span>.<span class="property">hooks</span>.<span class="property">afterCompile</span>.<span class="title function_">callAsync</span>(compilation, <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">                <span class="comment">// 返回编译成功的回调</span></span><br><span class="line">                <span class="keyword">return</span> <span class="title function_">callback</span>(<span class="literal">null</span>, compilation);</span><br><span class="line">              &#125;);</span><br><span class="line">            &#125;);</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>钩子的执行顺序<code>beforeCompile - compile - make - finishMake - afterCompile</code>,整个编译是编译前 - 编译后</p><p>其中比较最核心的就是 compile 和 make 阶段，其中<code>compile</code>在函数中首次实现了<code>compilation</code>实例的创建</p><blockquote><p>compile 和 compilation 的区别：</p><ul><li><p>Compiler: webpack 的核心，贯穿于整个构建周期，Compiler 封装了 Webpack 环境的全局配置，包括但不限于配置信息、输出路径等</p></li><li><p>Compilation: 表示单次的构建过程及其产出，与 compiler 不同的是，compilation 对象在每次构建中都是新创建的，描述了构建的具体过程，包括模块资源，编译后的产出资源，文件变化，依赖关系状态，每当文件变化触发重写构建时，都会生成新的<code>Complation</code>实例</p></li></ul><p><code>Compiler</code> 是一个长期存在的环境描述，贯穿整个 Webpack 运行周期；而 <code>Compilation</code> 是对单次构建的具体描述，每一次构建过程都可能有所不同</p></blockquote><p>重点关注 make 阶段，但是我们并没有在 make 中看到关键的函数执行，即相关的逻辑应该是通过 hooks 去触发的，在全局中搜索<code>compiler.hooks.make.tapAsync</code>去查看 make 编译的逻辑</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">compiler.<span class="property">hooks</span>.<span class="property">make</span>.<span class="title function_">tapAsync</span>(<span class="string">&#x27;EntryPlugin&#x27;</span>, <span class="function">(<span class="params">compilation, callback</span>) =&gt;</span> &#123;</span><br><span class="line">  compilation.<span class="title function_">addEntry</span>(context, dep, options, <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">callback</span>(err)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>通过查找我们发现它在 EntryOptionPlugin 中被实例化，再搜索 EntryOptionPlugin，发现在 WebpackOptionsApply 中被引入，很显然，这个插件在 <code>compiler.run()</code> 之前就被注册好了</p><h4 id="添加-Entry"><a href="#添加-Entry" class="headerlink" title="添加 Entry"></a>添加 Entry</h4><p>看看 EntryPlugin 中的<code>compilation.addEntry</code>完成了什么</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">addEntry</span>(<span class="params">context, entry, optionsOrName, callback</span>) &#123;</span><br><span class="line">  <span class="comment">// TODO webpack 6 remove</span></span><br><span class="line">  <span class="keyword">const</span> options =</span><br><span class="line">    <span class="keyword">typeof</span> optionsOrName === <span class="string">&#x27;object&#x27;</span> ? optionsOrName : &#123; <span class="attr">name</span>: optionsOrName &#125;</span><br><span class="line"></span><br><span class="line">  <span class="variable language_">this</span>.<span class="title function_">_addEntryItem</span>(context, entry, <span class="string">&#x27;dependencies&#x27;</span>, options, callback)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">_addEntryItem</span>(<span class="params">context, entry, target, options, callback</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; name &#125; = options</span><br><span class="line">  <span class="comment">// 尝试获取或初始化入口数据</span></span><br><span class="line">  <span class="keyword">let</span> entryData = <span class="variable language_">this</span>.<span class="property">entries</span>.<span class="title function_">get</span>(name) || <span class="variable language_">this</span>.<span class="property">globalEntry</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 添加入口依赖</span></span><br><span class="line">  entryData[target].<span class="title function_">push</span>(entry)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 检查和合并选项，这里简化为直接使用传入选项</span></span><br><span class="line">  entryData.<span class="property">options</span> = &#123; ...entryData.<span class="property">options</span>, ...options &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 触发添加入口的钩子</span></span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">hooks</span>.<span class="property">addEntry</span>.<span class="title function_">call</span>(entry, options)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 处理入口依赖的模块树，这里简化异步处理逻辑</span></span><br><span class="line">  <span class="variable language_">this</span>.<span class="title function_">addModuleTree</span>(&#123; context, <span class="attr">dependency</span>: entry &#125;, <span class="function">(<span class="params">err, <span class="variable language_">module</span></span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 入口添加成功</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">hooks</span>.<span class="property">succeedEntry</span>.<span class="title function_">call</span>(entry, options, <span class="variable language_">module</span>)</span><br><span class="line">    <span class="title function_">callback</span>(<span class="literal">null</span>, <span class="variable language_">module</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>可以了解到这里的工作就是在处理 Entry，Entry 的添加过程中会调用<code>addModuleTree()</code>，根据代码依赖递归构建模块树(Module Tree)</p><h4 id="添加到-Module-Tree"><a href="#添加到-Module-Tree" class="headerlink" title="添加到 Module Tree"></a>添加到 Module Tree</h4><h3 id="Rollup"><a href="#Rollup" class="headerlink" title="Rollup"></a>Rollup</h3><h3 id="Vite"><a href="#Vite" class="headerlink" title="Vite"></a>Vite</h3><h3 id="babel"><a href="#babel" class="headerlink" title="babel"></a>babel</h3><h3 id="其它工具"><a href="#其它工具" class="headerlink" title="其它工具"></a>其它工具</h3><p>esbuild swc bun</p><h2 id="编译规范"><a href="#编译规范" class="headerlink" title="编译规范"></a>编译规范</h2><h3 id="JS-模块化"><a href="#JS-模块化" class="headerlink" title="JS 模块化"></a>JS 模块化</h3><h3 id="CSS-模块化"><a href="#CSS-模块化" class="headerlink" title="CSS 模块化"></a>CSS 模块化</h3><h1 id="CI-CD-流水"><a href="#CI-CD-流水" class="headerlink" title="CI&#x2F;CD 流水"></a>CI&#x2F;CD 流水</h1></article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/yueyun.jpg" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/yueyun.jpg" title="头像" alt="头像"></a><div class="post-copyright__author_name">月晕</div><div class="post-copyright__author_desc">生命是有光的</div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="https://blog.yueyun.site/posts/262c4a52.html">原创</a><a class="post-copyright-title"><span onclick='rm.copyPageUrl("https://blog.yueyun.site/posts/262c4a52.html")'>前端工程化配置，工程能力学习</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="https://blog.yueyun.site/posts/262c4a52.html"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><script>function copyCurrentPageUrl(){var e=window.location.href,t=document.createElement("input");t.setAttribute("value",e),document.body.appendChild(t),t.select(),t.setSelectionRange(0,99999),document.execCommand("copy"),document.body.removeChild(t)}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://blog.yueyun.site" target="_blank">月晕</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__category-list"><a class="post-meta__box__categoryes" href="/categories/%E5%89%8D%E7%AB%AF/"><span class="categoryes-punctuation"><i class="anzhiyufont anzhiyu-icon-inbox"></i></span>前端<span class="categoryesPageCount">9</span></a></div><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/%E5%89%8D%E7%AB%AF/"><span class="tags-punctuation"><i class="anzhiyufont anzhiyu-icon-tag"></i></span>前端<span class="tagsPageCount">14</span></a><a class="post-meta__box__tags" href="/tags/%E5%B7%A5%E7%A8%8B%E5%8C%96/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>工程化<span class="tagsPageCount">1</span></a></div></div></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/f576a3fe.html"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://blog-1301952160.cos.ap-shanghai.myqcloud.com/Apprehensive/postCover/8c52b9660688cedcc40580545cef9ba4.jpg" onerror='onerror=null,src="/img/404.jpg"' alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">记录第一次字节实习offer</div></div></a></div><div class="next-post pull-right"><a href="/posts/12f20b61.html"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://blog-1301952160.cos.ap-shanghai.myqcloud.com/Apprehensive/postCover/1700908475489.jpg" onerror='onerror=null,src="/img/404.jpg"' alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">前端性能优化以及前端渲染</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="anzhiyufont anzhiyu-icon-thumbs-up fa-fw" style="font-size:1.5rem;margin-right:4px"></i><span>喜欢这篇文章的人也看了</span></div><div class="relatedPosts-list"><div><a href="/posts/938f2f9c.html" title="React Native开坑"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://blog-1301952160.cos.ap-shanghai.myqcloud.com/Apprehensive/postCover/1702557508740.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2023-12-15</div><div class="title">React Native开坑</div></div></a></div><div><a href="/posts/9ac48510.html" title="React学习"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://blog-1301952160.cos.ap-shanghai.myqcloud.com/Apprehensive/postCover/1701613946910.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2023-12-12</div><div class="title">React学习</div></div></a></div><div><a href="/posts/49ae955a.html" title="React 源码分析"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://blog-1301952160.cos.ap-shanghai.myqcloud.com/Apprehensive/wallpaper/2.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2023-12-15</div><div class="title">React 源码分析</div></div></a></div><div><a href="/posts/d681bdaf.html" title="TypeScript语言学习"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://blog-1301952160.cos.ap-shanghai.myqcloud.com/Apprehensive/postCover/liang.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2023-12-22</div><div class="title">TypeScript语言学习</div></div></a></div><div><a href="/posts/317b894e.html" title="Vue学习"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://blog-1301952160.cos.ap-shanghai.myqcloud.com/Apprehensive/postCover/1702396713207.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2023-12-12</div><div class="title">Vue学习</div></div></a></div><div><a href="/posts/ea5e4ee3.html" title="Vue部分源码分析"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://blog-1301952160.cos.ap-shanghai.myqcloud.com/Apprehensive/postCover/1700908595951.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2023-11-25</div><div class="title">Vue部分源码分析</div></div></a></div></div></div><hr><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="anzhiyufont anzhiyu-icon-comments"></i><span> 评论</span></div><div class="comment-randomInfo"><a onclick="anzhiyu.addRandomCommentInfo()" href="javascript:void(0)" style="display:none">匿名评论</a><a href="/privacy" style="margin-left:4px">隐私政策</a></div><div class="comment-tips" id="comment-tips"><span>✅ 你无需删除空行，直接评论以获取最佳展示效果</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div><div class="comment-barrage"></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info__sayhi" id="author-info__sayhi" onclick="anzhiyu.changeSayHelloText()"></div><div class="author-info-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/yueyun.jpg" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="avatar"><div class="author-info__decoration"><img class="avatar-decoration-1" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://blog-1301952160.cos.ap-shanghai.myqcloud.com/Apprehensive/avatar_desc/avatar_d1.png" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="decoration"><img class="avatar-decoration-2" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://blog-1301952160.cos.ap-shanghai.myqcloud.com/Apprehensive/avatar_desc/avatar_d2.png" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="decoration"><img class="avatar-decoration-3" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://blog-1301952160.cos.ap-shanghai.myqcloud.com/Apprehensive/avatar_desc/avatar_d3.png" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="decoration"><img class="avatar-decoration-4" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://blog-1301952160.cos.ap-shanghai.myqcloud.com/Apprehensive/avatar_desc/avatar_d4.png" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="decoration"></div></div><div class="author-info__bottom-group"><a class="author-info__bottom-group-left" href="/about"><h1 class="author-info__name">月晕</h1><div class="author-info__desc">生命是有光的</div></a><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="tencent://AddContact/?fromId=45&amp;fromSubId=1&amp;subcmd=all&amp;uin=3514392356&amp;website=www.oicqzone.com" target="_blank" title="QQ"><i class="anzhiyufont anzhiyu-icon-qq"></i></a><a class="social-icon faa-parent animated-hover" href="https://github.com/apprehen" target="_blank" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a><a class="social-icon faa-parent animated-hover" href="https://space.bilibili.com/554370301" target="_blank" title="BiliBili"><i class="anzhiyufont anzhiyu-icon-bilibili"></i></a></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%B7%A5%E7%A8%8B%E6%B2%BB%E7%90%86"><span class="toc-number">1.</span> <span class="toc-text">工程治理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B7%A5%E7%A8%8B%E7%AE%A1%E7%90%86"><span class="toc-number">1.1.</span> <span class="toc-text">工程管理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#GIT"><span class="toc-number">1.1.1.</span> <span class="toc-text">GIT</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ssh-key-config"><span class="toc-number">1.1.1.1.</span> <span class="toc-text">ssh key config</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#GIT-%E7%89%88%E6%9C%AC%E7%AE%A1%E7%90%86%E4%B8%AD%E7%9A%84%E6%8C%87%E4%BB%A4%E6%93%8D%E4%BD%9C"><span class="toc-number">1.1.1.2.</span> <span class="toc-text">GIT 版本管理中的指令操作</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86"><span class="toc-number">1.1.2.</span> <span class="toc-text">依赖管理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#npm"><span class="toc-number">1.1.2.1.</span> <span class="toc-text">npm</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#yarn"><span class="toc-number">1.1.2.2.</span> <span class="toc-text">yarn</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#pnpm"><span class="toc-number">1.1.2.3.</span> <span class="toc-text">pnpm</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#monorepo"><span class="toc-number">1.1.3.</span> <span class="toc-text">monorepo</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E8%A7%84%E8%8C%83"><span class="toc-number">1.2.</span> <span class="toc-text">代码规范</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#TypeScript-%E4%BB%A3%E7%A0%81%E8%A7%84%E8%8C%83"><span class="toc-number">1.2.1.</span> <span class="toc-text">TypeScript 代码规范</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%91%BD%E5%90%8D"><span class="toc-number">1.2.1.1.</span> <span class="toc-text">命名</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%AD%E8%A8%80%E7%89%B9%E6%80%A7"><span class="toc-number">1.2.1.2.</span> <span class="toc-text">语言特性</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="toc-number">1.2.1.2.1.</span> <span class="toc-text">字符串</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9E%9A%E4%B8%BE"><span class="toc-number">1.2.1.2.2.</span> <span class="toc-text">枚举</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%87%BD%E6%95%B0"><span class="toc-number">1.2.1.2.3.</span> <span class="toc-text">函数</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%8E%A5%E5%8F%A3%E5%92%8C%E7%B1%BB"><span class="toc-number">1.2.1.2.4.</span> <span class="toc-text">接口和类</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%B1%BB%E5%9E%8B%E6%96%AD%E8%A8%80%E5%92%8C%E9%9D%9E%E7%A9%BA%E6%96%AD%E8%A8%80"><span class="toc-number">1.2.1.2.5.</span> <span class="toc-text">类型断言和非空断言</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%B3%A8%E9%87%8A%E6%8C%87%E4%BB%A4"><span class="toc-number">1.2.1.2.6.</span> <span class="toc-text">注释指令</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%B1%BB%E5%9E%8B%E7%B3%BB%E7%BB%9F"><span class="toc-number">1.2.1.3.</span> <span class="toc-text">类型系统</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84"><span class="toc-number">1.2.1.4.</span> <span class="toc-text">文件结构</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#React-%E4%BB%A3%E7%A0%81%E8%A7%84%E8%8C%83"><span class="toc-number">1.2.2.</span> <span class="toc-text">React 代码规范</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%91%BD%E5%90%8D-1"><span class="toc-number">1.2.2.1.</span> <span class="toc-text">命名</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E6%A0%BC%E5%BC%8F%E5%8C%96"><span class="toc-number">1.2.2.2.</span> <span class="toc-text">代码格式化</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%89%B9%E6%80%A7"><span class="toc-number">1.2.2.3.</span> <span class="toc-text">特性</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6"><span class="toc-number">1.2.2.4.</span> <span class="toc-text">组件</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Eslint"><span class="toc-number">1.2.3.</span> <span class="toc-text">Eslint</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Prettier"><span class="toc-number">1.2.4.</span> <span class="toc-text">Prettier</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Husky"><span class="toc-number">1.2.5.</span> <span class="toc-text">Husky</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BC%96%E8%AF%91%E6%9E%84%E5%BB%BA"><span class="toc-number">2.</span> <span class="toc-text">编译构建</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BC%96%E8%AF%91%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7"><span class="toc-number">2.1.</span> <span class="toc-text">编译构建工具</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Webpack"><span class="toc-number">2.1.1.</span> <span class="toc-text">Webpack</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="toc-number">2.1.1.1.</span> <span class="toc-text">基本概念</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E6%9C%AF%E8%AF%AD%E4%BB%8B%E7%BB%8D"><span class="toc-number">2.1.1.2.</span> <span class="toc-text">基本术语介绍</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BC%96%E8%AF%91%E8%BF%87%E7%A8%8B"><span class="toc-number">2.1.1.3.</span> <span class="toc-text">编译过程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BC%96%E8%AF%91%E7%9A%84%E5%BC%80%E5%A7%8B"><span class="toc-number">2.1.1.4.</span> <span class="toc-text">编译的开始</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#compiler-%E7%9A%84%E5%88%9B%E5%BB%BA%E8%BF%87%E7%A8%8B"><span class="toc-number">2.1.1.5.</span> <span class="toc-text">compiler 的创建过程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WebpackOptionsApply"><span class="toc-number">2.1.1.6.</span> <span class="toc-text">WebpackOptionsApply()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Compiler-run"><span class="toc-number">2.1.1.7.</span> <span class="toc-text">Compiler.run</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B0%83%E7%94%A8-compiler-compile"><span class="toc-number">2.1.1.8.</span> <span class="toc-text">调用 compiler.compile()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0-Entry"><span class="toc-number">2.1.1.9.</span> <span class="toc-text">添加 Entry</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0%E5%88%B0-Module-Tree"><span class="toc-number">2.1.1.10.</span> <span class="toc-text">添加到 Module Tree</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Rollup"><span class="toc-number">2.1.2.</span> <span class="toc-text">Rollup</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Vite"><span class="toc-number">2.1.3.</span> <span class="toc-text">Vite</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#babel"><span class="toc-number">2.1.4.</span> <span class="toc-text">babel</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B6%E5%AE%83%E5%B7%A5%E5%85%B7"><span class="toc-number">2.1.5.</span> <span class="toc-text">其它工具</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BC%96%E8%AF%91%E8%A7%84%E8%8C%83"><span class="toc-number">2.2.</span> <span class="toc-text">编译规范</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#JS-%E6%A8%A1%E5%9D%97%E5%8C%96"><span class="toc-number">2.2.1.</span> <span class="toc-text">JS 模块化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CSS-%E6%A8%A1%E5%9D%97%E5%8C%96"><span class="toc-number">2.2.2.</span> <span class="toc-text">CSS 模块化</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#CI-CD-%E6%B5%81%E6%B0%B4"><span class="toc-number">3.</span> <span class="toc-text">CI&#x2F;CD 流水</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/12f20b61.html" title="前端性能优化以及前端渲染"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://blog-1301952160.cos.ap-shanghai.myqcloud.com/Apprehensive/postCover/1700908475489.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="前端性能优化以及前端渲染"></a><div class="content"><a class="title" href="/posts/12f20b61.html" title="前端性能优化以及前端渲染">前端性能优化以及前端渲染</a><time datetime="2024-08-27T23:20:29.000Z" title="发表于 2024-08-27 23:20:29">2024-08-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/262c4a52.html" title="前端工程化配置，工程能力学习"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://blog-1301952160.cos.ap-shanghai.myqcloud.com/Apprehensive/postCover/1722687861605.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="前端工程化配置，工程能力学习"></a><div class="content"><a class="title" href="/posts/262c4a52.html" title="前端工程化配置，工程能力学习">前端工程化配置，工程能力学习</a><time datetime="2024-08-09T01:07:53.000Z" title="发表于 2024-08-09 01:07:53">2024-08-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/f576a3fe.html" title="记录第一次字节实习offer"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://blog-1301952160.cos.ap-shanghai.myqcloud.com/Apprehensive/postCover/8c52b9660688cedcc40580545cef9ba4.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="记录第一次字节实习offer"></a><div class="content"><a class="title" href="/posts/f576a3fe.html" title="记录第一次字节实习offer">记录第一次字节实习offer</a><time datetime="2024-07-26T22:56:41.000Z" title="发表于 2024-07-26 22:56:41">2024-07-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/8f49bd54.html" title="前端技术探索"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://blog-1301952160.cos.ap-shanghai.myqcloud.com/Apprehensive/postCover/1719120534005.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="前端技术探索"></a><div class="content"><a class="title" href="/posts/8f49bd54.html" title="前端技术探索">前端技术探索</a><time datetime="2024-06-23T13:26:24.000Z" title="发表于 2024-06-23 13:26:24">2024-06-23</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/ac8590ca.html" title="go 语言速成"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://blog-1301952160.cos.ap-shanghai.myqcloud.com/Apprehensive/postCover/5370198c46b7e6193aad423d755464fd5aa83820_raw.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="go 语言速成"></a><div class="content"><a class="title" href="/posts/ac8590ca.html" title="go 语言速成">go 语言速成</a><time datetime="2024-01-16T13:38:42.000Z" title="发表于 2024-01-16 13:38:42">2024-01-16</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div id="footer_deal"><a class="deal_link" target="_blank" rel="noopener" href="https://github.com/apprehen" title="email"><i class="anzhiyufont anzhiyu-icon-envelope"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://github.com/apprehen" title="微博"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://github.com/apprehen" title="facebook"><i class="anzhiyufont anzhiyu-icon-facebook1"></i></a><a class="deal_link" href="/atom.xml" title="RSS"><i class="anzhiyufont anzhiyu-icon-rss"></i></a><img class="footer_mini_logo" title="返回顶部" alt="返回顶部" onclick="anzhiyu.scrollToDest(0,500)" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/yueyun.jpg" size="50px"><a class="deal_link" target="_blank" rel="noopener" href="https://github.com/apprehen" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://github.com/apprehen" title="Bilibili"><i class="anzhiyufont anzhiyu-icon-bilibili"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://github.com/apprehen" title="抖音"><i class="anzhiyufont anzhiyu-icon-tiktok"></i></a><a class="deal_link" href="/copyright" title="CC"><i class="anzhiyufont anzhiyu-icon-copyright-line"></i></a></div><div class="copyright">&copy;2023 - 2024 By 月晕</div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">25</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">34</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">14</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://blog.anheyu.com/" title="博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="博客"><span class="back-menu-item-text">博客</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://image.anheyu.com/" title="安知鱼图床"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.anheyu.com/favicon.ico" alt="安知鱼图床"><span class="back-menu-item-text">安知鱼图床</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size:.9em"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size:.9em"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size:.9em"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>留言</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size:.9em"></i><span> 友人帐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size:.9em"></i><span> 留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size:.9em"></i><span> 音乐馆</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size:.9em"></i><span> 相册集</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size:.9em"></i><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/resume/"><i class="anzhiyufont anzhiyu-icon-book faa-tada" style="font-size:.9em"></i><span> 简历</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size:.9em"></i><span> 随便逛逛</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/Clash/" style="font-size:.88rem">Clash<sup>1</sup></a><a href="/tags/Git/" style="font-size:.88rem">Git<sup>1</sup></a><a href="/tags/JavaScript/" style="font-size:.88rem">JavaScript<sup>10</sup></a><a href="/tags/Linux/" style="font-size:.88rem">Linux<sup>2</sup></a><a href="/tags/NestJS/" style="font-size:.88rem">NestJS<sup>1</sup></a><a href="/tags/Nginx/" style="font-size:.88rem">Nginx<sup>1</sup></a><a href="/tags/PM2/" style="font-size:.88rem">PM2<sup>1</sup></a><a href="/tags/Python/" style="font-size:.88rem">Python<sup>1</sup></a><a href="/tags/React/" style="font-size:.88rem">React<sup>4</sup></a><a href="/tags/React-Native/" style="font-size:.88rem">React Native<sup>1</sup></a><a href="/tags/TypeScript/" style="font-size:.88rem">TypeScript<sup>2</sup></a><a href="/tags/Vite/" style="font-size:.88rem">Vite<sup>1</sup></a><a href="/tags/Vue/" style="font-size:.88rem">Vue<sup>2</sup></a><a href="/tags/go/" style="font-size:.88rem">go<sup>1</sup></a><a href="/tags/leetcode/" style="font-size:.88rem">leetcode<sup>1</sup></a><a href="/tags/%E4%BB%A3%E7%90%86/" style="font-size:.88rem">代理<sup>1</sup></a><a href="/tags/%E5%89%8D%E7%AB%AF/" style="font-size:.88rem;font-weight:500;color:var(--anzhiyu-lighttext)">前端<sup>14</sup></a><a href="/tags/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6/" style="font-size:.88rem">前端框架<sup>2</sup></a><a href="/tags/%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86/" style="font-size:.88rem">反向代理<sup>1</sup></a><a href="/tags/%E5%90%8E%E7%AB%AF/" style="font-size:.88rem">后端<sup>2</sup></a><a href="/tags/%E5%B7%A5%E7%A8%8B%E5%8C%96/" style="font-size:.88rem">工程化<sup>1</sup></a><a href="/tags/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/" style="font-size:.88rem">性能优化<sup>1</sup></a><a href="/tags/%E6%89%93%E5%8C%85%E5%B7%A5%E5%85%B7/" style="font-size:.88rem">打包工具<sup>1</sup></a><a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" style="font-size:.88rem">数据结构<sup>2</sup></a><a href="/tags/%E6%B5%8F%E8%A7%88%E5%99%A8%E5%8E%9F%E7%90%86/" style="font-size:.88rem">浏览器原理<sup>1</sup></a><a href="/tags/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/" style="font-size:.88rem">源码分析<sup>2</sup></a><a href="/tags/%E7%88%AC%E8%99%AB/" style="font-size:.88rem">爬虫<sup>1</sup></a><a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size:.88rem">算法<sup>2</sup></a><a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA/" style="font-size:.88rem">计算机<sup>1</sup></a><a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/" style="font-size:.88rem;font-weight:500;color:var(--anzhiyu-lighttext)">计算机基础<sup>3</sup></a><a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" style="font-size:.88rem">计算机操作系统<sup>1</sup></a><a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" style="font-size:.88rem">计算机网络<sup>1</sup></a><a href="/tags/%E9%9D%A2%E8%AF%95/" style="font-size:.88rem">面试<sup>1</sup></a><a href="/tags/%E9%9D%A2%E8%AF%95%E9%A2%98/" style="font-size:.88rem">面试题<sup>1</sup></a></div></div><hr></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="anzhiyufont anzhiyu-icon-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="8152976493" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random"></meting-js></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="anzhiyufont anzhiyu-icon-xmark"></i></button></nav><div class="is-center" id="loading-database"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-pulse-icon"></i><span> 数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"></div></div><hr><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size:1rem"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/8802438608&quot;, &quot;_blank&quot;);" style="display:none"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.20/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.4/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script async src="/anzhiyu/random.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>(() => {
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'https://chat.yueyun.site',
      region: 'ap-hangzhou',
      onCommentLoaded: () => {
        anzhiyu.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') setTimeout(runFn,0)
    else getScript('https://cdn.cbd.int/twikoo@1.6.21/dist/twikoo.all.min.js').then(runFn)
  }

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://chat.yueyun.site',
      region: 'ap-hangzhou',
      urls: [window.location.pathname],
      includeReply: false
    }).then(res => {
      countELement.textContent = res[0].count
    }).catch(err => {
      console.error(err)
    })
  }

  const runFn = () => {
    init();
    GLOBAL_CONFIG_SITE.isPost && getCount()
  }

  if ('Twikoo' === 'Twikoo' || !false) {
    if (false) anzhiyu.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else {
      loadTwikoo()
    }
  } else {
    window.loadOtherComment = loadTwikoo
  }
})()</script><input type="hidden" name="page-type" id="page-type" value="post"></div><script async data-pjax src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.1/bubble/bubble.js"></script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload='this.media="all"'><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["meta[property=\"og:image\"]","meta[property=\"og:title\"]","meta[property=\"og:url\"]","meta[property=\"og:type\"]","meta[property=\"og:site_name\"]","meta[property=\"og:description\"]","head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: true,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', 'G-W3DLGJMJDY', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({pluginModelPath:"assets/",model:{jsonPath:"/live2dw/assets/unitychan.model.json"},display:{position:"left",width:150,height:300},mobile:{show:!1},log:!1,pluginJsPath:"lib/",pluginRootPath:"live2dw/",tagMode:!1})</script></body></html>